(function(l,ye){typeof exports=="object"&&typeof module<"u"?ye(exports):typeof define=="function"&&define.amd?define(["exports"],ye):(l=typeof globalThis<"u"?globalThis:l||self,ye(l.deepslate={}))})(this,function(l){"use strict";var Ih=Object.defineProperty;var Oh=(l,ye,It)=>ye in l?Ih(l,ye,{enumerable:!0,configurable:!0,writable:!0,value:It}):l[ye]=It;var p=(l,ye,It)=>(Oh(l,typeof ye!="symbol"?ye+"":ye,It),It);function ye(e){var t=e.slice(0,2);return t.length===2&&t[0]===31&&t[1]===139}function It(e){const t=e.slice(0,2);return t.length===2&&t[0]===120&&(t[1]===1||t[1]===94||t[1]===156||t[2]===218)}function Ea(e){const t=e.slice(0,8),n=new DataView(t.buffer,t.byteOffset),i=n.getUint32(0,!0),r=n.getUint32(4,!0);if(t.length===8&&i>0&&i<100&&r===e.byteLength-8)return i}function wa(e){var t=[],n,i;for(n=0;n<e.length;n++)i=e.charCodeAt(n),i<128?t.push(i):i<2048?(t.push(192|i>>6),t.push(128|i&63)):i<65536?(t.push(224|i>>12),t.push(128|i>>6&63),t.push(128|i&63)):(t.push(240|i>>18&7),t.push(128|i>>12&63),t.push(128|i>>6&63),t.push(128|i&63));return t}function pa(e){var t=[],n;for(n=0;n<e.length;n++)(e[n]&128)===0?t.push(e[n]&127):n+1<e.length&&(e[n]&224)===192&&(e[n+1]&192)===128?t.push((e[n]&31)<<6|e[n+1]&63):n+2<e.length&&(e[n]&240)===224&&(e[n+1]&192)===128&&(e[n+2]&192)===128?t.push((e[n]&15)<<12|(e[n+1]&63)<<6|e[n+2]&63):n+3<e.length&&(e[n]&248)===240&&(e[n+1]&192)===128&&(e[n+2]&192)===128&&(e[n+3]&192)===128&&t.push((e[n]&7)<<18|(e[n+1]&63)<<12|(e[n+2]&63)<<6|e[n+3]&63);return String.fromCharCode.apply(null,t)}class wr{constructor(t,n){p(this,"littleEndian");p(this,"offset");p(this,"array");p(this,"view");p(this,"readByte",this.readNumber.bind(this,"getInt8",1));p(this,"readShort",this.readNumber.bind(this,"getInt16",2));p(this,"readInt",this.readNumber.bind(this,"getInt32",4));p(this,"readFloat",this.readNumber.bind(this,"getFloat32",4));p(this,"readDouble",this.readNumber.bind(this,"getFloat64",8));var i,r;this.littleEndian=(i=n==null?void 0:n.littleEndian)!=null?i:!1,this.offset=(r=n==null?void 0:n.offset)!=null?r:0,this.array=t instanceof Uint8Array?t:new Uint8Array(t),this.view=new DataView(this.array.buffer,this.array.byteOffset)}readNumber(t,n){const i=this.view[t](this.offset,this.littleEndian);return this.offset+=n,i}readBytes(t){const n=this.array.slice(this.offset,this.offset+t);return this.offset+=t,n}readString(){const t=this.readShort(),n=this.readBytes(t);return pa(n)}}class pr{constructor(t){p(this,"littleEndian");p(this,"offset");p(this,"buffer");p(this,"array");p(this,"view");p(this,"writeByte",this.writeNumber.bind(this,"setInt8",1));p(this,"writeShort",this.writeNumber.bind(this,"setInt16",2));p(this,"writeInt",this.writeNumber.bind(this,"setInt32",4));p(this,"writeFloat",this.writeNumber.bind(this,"setFloat32",4));p(this,"writeDouble",this.writeNumber.bind(this,"setFloat64",8));var n,i,r;this.littleEndian=(n=t==null?void 0:t.littleEndian)!=null?n:!1,this.offset=(i=t==null?void 0:t.offset)!=null?i:0,this.buffer=new ArrayBuffer((r=t==null?void 0:t.initialSize)!=null?r:1024),this.array=new Uint8Array(this.buffer),this.view=new DataView(this.buffer)}accommodate(t){const n=this.offset+t;if(this.buffer.byteLength>=n)return;let i=this.buffer.byteLength;for(;i<n;)i*=2;const r=new ArrayBuffer(i),s=new Uint8Array(r);s.set(this.array),this.offset>this.buffer.byteLength&&s.fill(0,this.buffer.byteLength,this.offset),this.buffer=r,this.view=new DataView(r),this.array=s}writeNumber(t,n,i){this.accommodate(n),this.view[t](this.offset,i,this.littleEndian),this.offset+=n}writeBytes(t){this.accommodate(t.length),this.array.set(t,this.offset),this.offset+=t.length}writeString(t){const n=wa(t);this.writeShort(n.length),this.writeBytes(n)}getData(){return this.accommodate(0),this.array.slice(0,this.offset)}}l.Json=void 0,(e=>{function t(f){return typeof f=="number"?f:void 0}e.readNumber=t;function n(f){return typeof f=="number"?Math.floor(f):void 0}e.readInt=n;function i(f){return typeof f=="string"?f:void 0}e.readString=i;function r(f){return typeof f=="boolean"?f:void 0}e.readBoolean=r;function s(f){return typeof f=="object"&&f!==null&&!Array.isArray(f)?f:void 0}e.readObject=s;function a(f,g){if(!!Array.isArray(f))return g?f.map(d=>g(d)):f}e.readArray=a;function o(f,g){if(!!Array.isArray(f))return[0,1].map(d=>g(f[d]))}e.readPair=o;function u(f,g){var E;const d=(E=s(f))!=null?E:{};return Object.fromEntries(Object.entries(d).map(([b,_])=>[b,g(_)]))}e.readMap=u;function c(f,g,d){const E=g(f);return E?d(E):void 0}e.compose=c;function h(f,g){return typeof f!="string"?g[0]:g.includes(f)?f:g[0]}e.readEnum=h})(l.Json||(l.Json={}));class Ie{constructor(t){p(this,"source");p(this,"cursor");this.source=t,this.cursor=0}get remainingLength(){return this.source.length-this.cursor}get totalLength(){return this.source.length}getRead(t=0){return this.source.substring(t,this.cursor)}getRemaining(){return this.source.substring(this.cursor)}canRead(t=1){return this.cursor+t<=this.source.length}peek(t=0){return this.source.charAt(this.cursor+t)}read(){return this.source.charAt(this.cursor++)}skip(){this.cursor+=1}skipWhitespace(){for(;this.canRead()&&Ie.isWhitespace(this.peek());)this.skip()}expect(t,n=!1){if(n&&this.skipWhitespace(),!this.canRead()||this.peek()!==t)throw this.createError(`Expected '${t}'`);this.skip()}readInt(){const t=this.cursor;for(;this.canRead()&&Ie.isAllowedInNumber(this.peek());)this.skip();const n=this.getRead(t);if(n.length===0)throw this.createError("Expected integer");try{const i=Number(n);if(isNaN(i)||!Number.isInteger(i))throw new Error;return i}catch{throw this.cursor=t,this.createError(`Invalid integer '${n}'`)}}readFloat(){const t=this.cursor;for(;this.canRead()&&Ie.isAllowedInNumber(this.peek());)this.skip();const n=this.getRead(t);if(n.length===0)throw this.createError("Expected float");try{const i=Number(n);if(isNaN(i))throw new Error;return i}catch{throw this.cursor=t,this.createError(`Invalid float '${n}'`)}}readUnquotedString(){const t=this.cursor;for(;this.canRead()&&Ie.isAllowedInUnquotedString(this.peek());)this.skip();return this.getRead(t)}readQuotedString(){if(!this.canRead())return"";const t=this.peek();if(!Ie.isQuotedStringStart(t))throw this.createError("Expected quote to start a string");return this.skip(),this.readStringUntil(t)}readString(){if(!this.canRead())return"";const t=this.peek();return Ie.isQuotedStringStart(t)?(this.skip(),this.readStringUntil(t)):this.readUnquotedString()}readStringUntil(t){const n=[];let i=!1;for(;this.canRead();){const r=this.read();if(i)if(r===t||r==="\\")n.push(r),i=!1;else throw this.cursor-=1,this.createError(`Invalid escape sequence '${r}' in quoted string`);else if(r==="\\")i=!0;else{if(r===t)return n.join("");n.push(r)}}throw this.createError("Unclosed quoted string")}readBoolean(){const t=this.cursor,n=this.readUnquotedString();if(n.length===0)throw this.createError("Expected bool");if(n==="true")return!0;if(n==="false")return!1;throw this.cursor=t,this.createError(`Invalid bool, expected true or false but found '${n}'`)}static isAllowedInNumber(t){return t>="0"&&t<="9"||t==="."||t==="-"}static isAllowedInUnquotedString(t){return t>="0"&&t<="9"||t>="A"&&t<="Z"||t>="a"&&t<="z"||t==="_"||t==="-"||t==="."||t==="+"}static isQuotedStringStart(t){return t==="'"||t==='"'}static isWhitespace(t){return t===" "||t==="	"||t===`
`||t==="\r"}createError(t){const n=Math.min(this.source.length,this.cursor),i=(n>10?"...":"")+this.source.substring(Math.max(0,n-10),n);return new Error(`${t} at position ${this.cursor}: ${i}<--[HERE]`)}}function fn(e){let t=null;return()=>(t==null&&(t=e()),t)}function Ot(e,t,n){const i=e.get(t);if(i!==void 0)return i;const r=n(t);return e.set(t,r),r}function Ii(e,t,n,i){const r=e.get(t),s=r!=null?r:n;return i(s,t),e.set(t,s),s}function Ee(e){const t=e>>16&255,n=e>>8&255,i=e&255;return[t/255,n/255,i/255]}/*! pako 2.0.4 https://github.com/nodeca/pako @license (MIT AND Zlib) */const Sa=4,Sr=0,br=1,ba=2;function qt(e){let t=e.length;for(;--t>=0;)e[t]=0}const va=0,vr=1,Aa=2,Na=3,ya=258,Oi=29,dn=256,gn=dn+1+Oi,Xt=30,Ci=19,Ar=2*gn+1,Ct=15,Mi=16,ka=7,Li=256,Nr=16,yr=17,kr=18,Bi=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),Zn=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),Ra=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),Rr=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),Ta=512,et=new Array((gn+2)*2);qt(et);const _n=new Array(Xt*2);qt(_n);const mn=new Array(Ta);qt(mn);const En=new Array(ya-Na+1);qt(En);const Pi=new Array(Oi);qt(Pi);const Yn=new Array(Xt);qt(Yn);function Gi(e,t,n,i,r){this.static_tree=e,this.extra_bits=t,this.extra_base=n,this.elems=i,this.max_length=r,this.has_stree=e&&e.length}let Tr,Ir,Or;function Di(e,t){this.dyn_tree=e,this.max_code=0,this.stat_desc=t}const Cr=e=>e<256?mn[e]:mn[256+(e>>>7)],wn=(e,t)=>{e.pending_buf[e.pending++]=t&255,e.pending_buf[e.pending++]=t>>>8&255},Ae=(e,t,n)=>{e.bi_valid>Mi-n?(e.bi_buf|=t<<e.bi_valid&65535,wn(e,e.bi_buf),e.bi_buf=t>>Mi-e.bi_valid,e.bi_valid+=n-Mi):(e.bi_buf|=t<<e.bi_valid&65535,e.bi_valid+=n)},Ze=(e,t,n)=>{Ae(e,n[t*2],n[t*2+1])},Mr=(e,t)=>{let n=0;do n|=e&1,e>>>=1,n<<=1;while(--t>0);return n>>>1},Ia=e=>{e.bi_valid===16?(wn(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):e.bi_valid>=8&&(e.pending_buf[e.pending++]=e.bi_buf&255,e.bi_buf>>=8,e.bi_valid-=8)},Oa=(e,t)=>{const n=t.dyn_tree,i=t.max_code,r=t.stat_desc.static_tree,s=t.stat_desc.has_stree,a=t.stat_desc.extra_bits,o=t.stat_desc.extra_base,u=t.stat_desc.max_length;let c,h,f,g,d,E,b=0;for(g=0;g<=Ct;g++)e.bl_count[g]=0;for(n[e.heap[e.heap_max]*2+1]=0,c=e.heap_max+1;c<Ar;c++)h=e.heap[c],g=n[n[h*2+1]*2+1]+1,g>u&&(g=u,b++),n[h*2+1]=g,!(h>i)&&(e.bl_count[g]++,d=0,h>=o&&(d=a[h-o]),E=n[h*2],e.opt_len+=E*(g+d),s&&(e.static_len+=E*(r[h*2+1]+d)));if(b!==0){do{for(g=u-1;e.bl_count[g]===0;)g--;e.bl_count[g]--,e.bl_count[g+1]+=2,e.bl_count[u]--,b-=2}while(b>0);for(g=u;g!==0;g--)for(h=e.bl_count[g];h!==0;)f=e.heap[--c],!(f>i)&&(n[f*2+1]!==g&&(e.opt_len+=(g-n[f*2+1])*n[f*2],n[f*2+1]=g),h--)}},Lr=(e,t,n)=>{const i=new Array(Ct+1);let r=0,s,a;for(s=1;s<=Ct;s++)i[s]=r=r+n[s-1]<<1;for(a=0;a<=t;a++){let o=e[a*2+1];o!==0&&(e[a*2]=Mr(i[o]++,o))}},Ca=()=>{let e,t,n,i,r;const s=new Array(Ct+1);for(n=0,i=0;i<Oi-1;i++)for(Pi[i]=n,e=0;e<1<<Bi[i];e++)En[n++]=i;for(En[n-1]=i,r=0,i=0;i<16;i++)for(Yn[i]=r,e=0;e<1<<Zn[i];e++)mn[r++]=i;for(r>>=7;i<Xt;i++)for(Yn[i]=r<<7,e=0;e<1<<Zn[i]-7;e++)mn[256+r++]=i;for(t=0;t<=Ct;t++)s[t]=0;for(e=0;e<=143;)et[e*2+1]=8,e++,s[8]++;for(;e<=255;)et[e*2+1]=9,e++,s[9]++;for(;e<=279;)et[e*2+1]=7,e++,s[7]++;for(;e<=287;)et[e*2+1]=8,e++,s[8]++;for(Lr(et,gn+1,s),e=0;e<Xt;e++)_n[e*2+1]=5,_n[e*2]=Mr(e,5);Tr=new Gi(et,Bi,dn+1,gn,Ct),Ir=new Gi(_n,Zn,0,Xt,Ct),Or=new Gi(new Array(0),Ra,0,Ci,ka)},Br=e=>{let t;for(t=0;t<gn;t++)e.dyn_ltree[t*2]=0;for(t=0;t<Xt;t++)e.dyn_dtree[t*2]=0;for(t=0;t<Ci;t++)e.bl_tree[t*2]=0;e.dyn_ltree[Li*2]=1,e.opt_len=e.static_len=0,e.last_lit=e.matches=0},Pr=e=>{e.bi_valid>8?wn(e,e.bi_buf):e.bi_valid>0&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0},Ma=(e,t,n,i)=>{Pr(e),i&&(wn(e,n),wn(e,~n)),e.pending_buf.set(e.window.subarray(t,t+n),e.pending),e.pending+=n},Gr=(e,t,n,i)=>{const r=t*2,s=n*2;return e[r]<e[s]||e[r]===e[s]&&i[t]<=i[n]},xi=(e,t,n)=>{const i=e.heap[n];let r=n<<1;for(;r<=e.heap_len&&(r<e.heap_len&&Gr(t,e.heap[r+1],e.heap[r],e.depth)&&r++,!Gr(t,i,e.heap[r],e.depth));)e.heap[n]=e.heap[r],n=r,r<<=1;e.heap[n]=i},Dr=(e,t,n)=>{let i,r,s=0,a,o;if(e.last_lit!==0)do i=e.pending_buf[e.d_buf+s*2]<<8|e.pending_buf[e.d_buf+s*2+1],r=e.pending_buf[e.l_buf+s],s++,i===0?Ze(e,r,t):(a=En[r],Ze(e,a+dn+1,t),o=Bi[a],o!==0&&(r-=Pi[a],Ae(e,r,o)),i--,a=Cr(i),Ze(e,a,n),o=Zn[a],o!==0&&(i-=Yn[a],Ae(e,i,o)));while(s<e.last_lit);Ze(e,Li,t)},zi=(e,t)=>{const n=t.dyn_tree,i=t.stat_desc.static_tree,r=t.stat_desc.has_stree,s=t.stat_desc.elems;let a,o,u=-1,c;for(e.heap_len=0,e.heap_max=Ar,a=0;a<s;a++)n[a*2]!==0?(e.heap[++e.heap_len]=u=a,e.depth[a]=0):n[a*2+1]=0;for(;e.heap_len<2;)c=e.heap[++e.heap_len]=u<2?++u:0,n[c*2]=1,e.depth[c]=0,e.opt_len--,r&&(e.static_len-=i[c*2+1]);for(t.max_code=u,a=e.heap_len>>1;a>=1;a--)xi(e,n,a);c=s;do a=e.heap[1],e.heap[1]=e.heap[e.heap_len--],xi(e,n,1),o=e.heap[1],e.heap[--e.heap_max]=a,e.heap[--e.heap_max]=o,n[c*2]=n[a*2]+n[o*2],e.depth[c]=(e.depth[a]>=e.depth[o]?e.depth[a]:e.depth[o])+1,n[a*2+1]=n[o*2+1]=c,e.heap[1]=c++,xi(e,n,1);while(e.heap_len>=2);e.heap[--e.heap_max]=e.heap[1],Oa(e,t),Lr(n,u,e.bl_count)},xr=(e,t,n)=>{let i,r=-1,s,a=t[0*2+1],o=0,u=7,c=4;for(a===0&&(u=138,c=3),t[(n+1)*2+1]=65535,i=0;i<=n;i++)s=a,a=t[(i+1)*2+1],!(++o<u&&s===a)&&(o<c?e.bl_tree[s*2]+=o:s!==0?(s!==r&&e.bl_tree[s*2]++,e.bl_tree[Nr*2]++):o<=10?e.bl_tree[yr*2]++:e.bl_tree[kr*2]++,o=0,r=s,a===0?(u=138,c=3):s===a?(u=6,c=3):(u=7,c=4))},zr=(e,t,n)=>{let i,r=-1,s,a=t[0*2+1],o=0,u=7,c=4;for(a===0&&(u=138,c=3),i=0;i<=n;i++)if(s=a,a=t[(i+1)*2+1],!(++o<u&&s===a)){if(o<c)do Ze(e,s,e.bl_tree);while(--o!==0);else s!==0?(s!==r&&(Ze(e,s,e.bl_tree),o--),Ze(e,Nr,e.bl_tree),Ae(e,o-3,2)):o<=10?(Ze(e,yr,e.bl_tree),Ae(e,o-3,3)):(Ze(e,kr,e.bl_tree),Ae(e,o-11,7));o=0,r=s,a===0?(u=138,c=3):s===a?(u=6,c=3):(u=7,c=4)}},La=e=>{let t;for(xr(e,e.dyn_ltree,e.l_desc.max_code),xr(e,e.dyn_dtree,e.d_desc.max_code),zi(e,e.bl_desc),t=Ci-1;t>=3&&e.bl_tree[Rr[t]*2+1]===0;t--);return e.opt_len+=3*(t+1)+5+5+4,t},Ba=(e,t,n,i)=>{let r;for(Ae(e,t-257,5),Ae(e,n-1,5),Ae(e,i-4,4),r=0;r<i;r++)Ae(e,e.bl_tree[Rr[r]*2+1],3);zr(e,e.dyn_ltree,t-1),zr(e,e.dyn_dtree,n-1)},Pa=e=>{let t=4093624447,n;for(n=0;n<=31;n++,t>>>=1)if(t&1&&e.dyn_ltree[n*2]!==0)return Sr;if(e.dyn_ltree[9*2]!==0||e.dyn_ltree[10*2]!==0||e.dyn_ltree[13*2]!==0)return br;for(n=32;n<dn;n++)if(e.dyn_ltree[n*2]!==0)return br;return Sr};let Hr=!1;const Ga=e=>{Hr||(Ca(),Hr=!0),e.l_desc=new Di(e.dyn_ltree,Tr),e.d_desc=new Di(e.dyn_dtree,Ir),e.bl_desc=new Di(e.bl_tree,Or),e.bi_buf=0,e.bi_valid=0,Br(e)},Fr=(e,t,n,i)=>{Ae(e,(va<<1)+(i?1:0),3),Ma(e,t,n,!0)},Da=e=>{Ae(e,vr<<1,3),Ze(e,Li,et),Ia(e)},xa=(e,t,n,i)=>{let r,s,a=0;e.level>0?(e.strm.data_type===ba&&(e.strm.data_type=Pa(e)),zi(e,e.l_desc),zi(e,e.d_desc),a=La(e),r=e.opt_len+3+7>>>3,s=e.static_len+3+7>>>3,s<=r&&(r=s)):r=s=n+5,n+4<=r&&t!==-1?Fr(e,t,n,i):e.strategy===Sa||s===r?(Ae(e,(vr<<1)+(i?1:0),3),Dr(e,et,_n)):(Ae(e,(Aa<<1)+(i?1:0),3),Ba(e,e.l_desc.max_code+1,e.d_desc.max_code+1,a+1),Dr(e,e.dyn_ltree,e.dyn_dtree)),Br(e),i&&Pr(e)},za=(e,t,n)=>(e.pending_buf[e.d_buf+e.last_lit*2]=t>>>8&255,e.pending_buf[e.d_buf+e.last_lit*2+1]=t&255,e.pending_buf[e.l_buf+e.last_lit]=n&255,e.last_lit++,t===0?e.dyn_ltree[n*2]++:(e.matches++,t--,e.dyn_ltree[(En[n]+dn+1)*2]++,e.dyn_dtree[Cr(t)*2]++),e.last_lit===e.lit_bufsize-1);var Ha=Ga,Fa=Fr,Ja=xa,Ua=za,Wa=Da,Va={_tr_init:Ha,_tr_stored_block:Fa,_tr_flush_block:Ja,_tr_tally:Ua,_tr_align:Wa},pn=(e,t,n,i)=>{let r=e&65535|0,s=e>>>16&65535|0,a=0;for(;n!==0;){a=n>2e3?2e3:n,n-=a;do r=r+t[i++]|0,s=s+r|0;while(--a);r%=65521,s%=65521}return r|s<<16|0};const Za=()=>{let e,t=[];for(var n=0;n<256;n++){e=n;for(var i=0;i<8;i++)e=e&1?3988292384^e>>>1:e>>>1;t[n]=e}return t},Ya=new Uint32Array(Za());var me=(e,t,n,i)=>{const r=Ya,s=i+n;e^=-1;for(let a=i;a<s;a++)e=e>>>8^r[(e^t[a])&255];return e^-1},Mt={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},Lt={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8};const{_tr_init:$a,_tr_stored_block:Ka,_tr_flush_block:qa,_tr_tally:ut,_tr_align:Xa}=Va,{Z_NO_FLUSH:Bt,Z_PARTIAL_FLUSH:ja,Z_FULL_FLUSH:Qa,Z_FINISH:ft,Z_BLOCK:Jr,Z_OK:Ye,Z_STREAM_END:Ur,Z_STREAM_ERROR:Oe,Z_DATA_ERROR:eo,Z_BUF_ERROR:Hi,Z_DEFAULT_COMPRESSION:to,Z_FILTERED:no,Z_HUFFMAN_ONLY:$n,Z_RLE:io,Z_FIXED:ro,Z_DEFAULT_STRATEGY:so,Z_UNKNOWN:ao,Z_DEFLATED:Kn}=Lt,oo=9,co=15,lo=8,ho=29,Fi=256+1+ho,uo=30,fo=19,go=2*Fi+1,_o=15,K=3,dt=258,Ge=dt+K+1,mo=32,qn=42,Ji=69,Xn=73,jn=91,Qn=103,Pt=113,Sn=666,he=1,bn=2,Gt=3,jt=4,Eo=3,gt=(e,t)=>(e.msg=Mt[t],t),Wr=e=>(e<<1)-(e>4?9:0),_t=e=>{let t=e.length;for(;--t>=0;)e[t]=0};let mt=(e,t,n)=>(t<<e.hash_shift^n)&e.hash_mask;const Et=e=>{const t=e.state;let n=t.pending;n>e.avail_out&&(n=e.avail_out),n!==0&&(e.output.set(t.pending_buf.subarray(t.pending_out,t.pending_out+n),e.next_out),e.next_out+=n,t.pending_out+=n,e.total_out+=n,e.avail_out-=n,t.pending-=n,t.pending===0&&(t.pending_out=0))},we=(e,t)=>{qa(e,e.block_start>=0?e.block_start:-1,e.strstart-e.block_start,t),e.block_start=e.strstart,Et(e.strm)},X=(e,t)=>{e.pending_buf[e.pending++]=t},vn=(e,t)=>{e.pending_buf[e.pending++]=t>>>8&255,e.pending_buf[e.pending++]=t&255},wo=(e,t,n,i)=>{let r=e.avail_in;return r>i&&(r=i),r===0?0:(e.avail_in-=r,t.set(e.input.subarray(e.next_in,e.next_in+r),n),e.state.wrap===1?e.adler=pn(e.adler,t,r,n):e.state.wrap===2&&(e.adler=me(e.adler,t,r,n)),e.next_in+=r,e.total_in+=r,r)},Vr=(e,t)=>{let n=e.max_chain_length,i=e.strstart,r,s,a=e.prev_length,o=e.nice_match;const u=e.strstart>e.w_size-Ge?e.strstart-(e.w_size-Ge):0,c=e.window,h=e.w_mask,f=e.prev,g=e.strstart+dt;let d=c[i+a-1],E=c[i+a];e.prev_length>=e.good_match&&(n>>=2),o>e.lookahead&&(o=e.lookahead);do if(r=t,!(c[r+a]!==E||c[r+a-1]!==d||c[r]!==c[i]||c[++r]!==c[i+1])){i+=2,r++;do;while(c[++i]===c[++r]&&c[++i]===c[++r]&&c[++i]===c[++r]&&c[++i]===c[++r]&&c[++i]===c[++r]&&c[++i]===c[++r]&&c[++i]===c[++r]&&c[++i]===c[++r]&&i<g);if(s=dt-(g-i),i=g-dt,s>a){if(e.match_start=t,a=s,s>=o)break;d=c[i+a-1],E=c[i+a]}}while((t=f[t&h])>u&&--n!==0);return a<=e.lookahead?a:e.lookahead},Dt=e=>{const t=e.w_size;let n,i,r,s,a;do{if(s=e.window_size-e.lookahead-e.strstart,e.strstart>=t+(t-Ge)){e.window.set(e.window.subarray(t,t+t),0),e.match_start-=t,e.strstart-=t,e.block_start-=t,i=e.hash_size,n=i;do r=e.head[--n],e.head[n]=r>=t?r-t:0;while(--i);i=t,n=i;do r=e.prev[--n],e.prev[n]=r>=t?r-t:0;while(--i);s+=t}if(e.strm.avail_in===0)break;if(i=wo(e.strm,e.window,e.strstart+e.lookahead,s),e.lookahead+=i,e.lookahead+e.insert>=K)for(a=e.strstart-e.insert,e.ins_h=e.window[a],e.ins_h=mt(e,e.ins_h,e.window[a+1]);e.insert&&(e.ins_h=mt(e,e.ins_h,e.window[a+K-1]),e.prev[a&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=a,a++,e.insert--,!(e.lookahead+e.insert<K)););}while(e.lookahead<Ge&&e.strm.avail_in!==0)},po=(e,t)=>{let n=65535;for(n>e.pending_buf_size-5&&(n=e.pending_buf_size-5);;){if(e.lookahead<=1){if(Dt(e),e.lookahead===0&&t===Bt)return he;if(e.lookahead===0)break}e.strstart+=e.lookahead,e.lookahead=0;const i=e.block_start+n;if((e.strstart===0||e.strstart>=i)&&(e.lookahead=e.strstart-i,e.strstart=i,we(e,!1),e.strm.avail_out===0)||e.strstart-e.block_start>=e.w_size-Ge&&(we(e,!1),e.strm.avail_out===0))return he}return e.insert=0,t===ft?(we(e,!0),e.strm.avail_out===0?Gt:jt):(e.strstart>e.block_start&&(we(e,!1),e.strm.avail_out===0),he)},Ui=(e,t)=>{let n,i;for(;;){if(e.lookahead<Ge){if(Dt(e),e.lookahead<Ge&&t===Bt)return he;if(e.lookahead===0)break}if(n=0,e.lookahead>=K&&(e.ins_h=mt(e,e.ins_h,e.window[e.strstart+K-1]),n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),n!==0&&e.strstart-n<=e.w_size-Ge&&(e.match_length=Vr(e,n)),e.match_length>=K)if(i=ut(e,e.strstart-e.match_start,e.match_length-K),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=K){e.match_length--;do e.strstart++,e.ins_h=mt(e,e.ins_h,e.window[e.strstart+K-1]),n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart;while(--e.match_length!==0);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=mt(e,e.ins_h,e.window[e.strstart+1]);else i=ut(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(i&&(we(e,!1),e.strm.avail_out===0))return he}return e.insert=e.strstart<K-1?e.strstart:K-1,t===ft?(we(e,!0),e.strm.avail_out===0?Gt:jt):e.last_lit&&(we(e,!1),e.strm.avail_out===0)?he:bn},Qt=(e,t)=>{let n,i,r;for(;;){if(e.lookahead<Ge){if(Dt(e),e.lookahead<Ge&&t===Bt)return he;if(e.lookahead===0)break}if(n=0,e.lookahead>=K&&(e.ins_h=mt(e,e.ins_h,e.window[e.strstart+K-1]),n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=K-1,n!==0&&e.prev_length<e.max_lazy_match&&e.strstart-n<=e.w_size-Ge&&(e.match_length=Vr(e,n),e.match_length<=5&&(e.strategy===no||e.match_length===K&&e.strstart-e.match_start>4096)&&(e.match_length=K-1)),e.prev_length>=K&&e.match_length<=e.prev_length){r=e.strstart+e.lookahead-K,i=ut(e,e.strstart-1-e.prev_match,e.prev_length-K),e.lookahead-=e.prev_length-1,e.prev_length-=2;do++e.strstart<=r&&(e.ins_h=mt(e,e.ins_h,e.window[e.strstart+K-1]),n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart);while(--e.prev_length!==0);if(e.match_available=0,e.match_length=K-1,e.strstart++,i&&(we(e,!1),e.strm.avail_out===0))return he}else if(e.match_available){if(i=ut(e,0,e.window[e.strstart-1]),i&&we(e,!1),e.strstart++,e.lookahead--,e.strm.avail_out===0)return he}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(i=ut(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<K-1?e.strstart:K-1,t===ft?(we(e,!0),e.strm.avail_out===0?Gt:jt):e.last_lit&&(we(e,!1),e.strm.avail_out===0)?he:bn},So=(e,t)=>{let n,i,r,s;const a=e.window;for(;;){if(e.lookahead<=dt){if(Dt(e),e.lookahead<=dt&&t===Bt)return he;if(e.lookahead===0)break}if(e.match_length=0,e.lookahead>=K&&e.strstart>0&&(r=e.strstart-1,i=a[r],i===a[++r]&&i===a[++r]&&i===a[++r])){s=e.strstart+dt;do;while(i===a[++r]&&i===a[++r]&&i===a[++r]&&i===a[++r]&&i===a[++r]&&i===a[++r]&&i===a[++r]&&i===a[++r]&&r<s);e.match_length=dt-(s-r),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=K?(n=ut(e,1,e.match_length-K),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(n=ut(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),n&&(we(e,!1),e.strm.avail_out===0))return he}return e.insert=0,t===ft?(we(e,!0),e.strm.avail_out===0?Gt:jt):e.last_lit&&(we(e,!1),e.strm.avail_out===0)?he:bn},bo=(e,t)=>{let n;for(;;){if(e.lookahead===0&&(Dt(e),e.lookahead===0)){if(t===Bt)return he;break}if(e.match_length=0,n=ut(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,n&&(we(e,!1),e.strm.avail_out===0))return he}return e.insert=0,t===ft?(we(e,!0),e.strm.avail_out===0?Gt:jt):e.last_lit&&(we(e,!1),e.strm.avail_out===0)?he:bn};function $e(e,t,n,i,r){this.good_length=e,this.max_lazy=t,this.nice_length=n,this.max_chain=i,this.func=r}const An=[new $e(0,0,0,0,po),new $e(4,4,8,4,Ui),new $e(4,5,16,8,Ui),new $e(4,6,32,32,Ui),new $e(4,4,16,16,Qt),new $e(8,16,32,32,Qt),new $e(8,16,128,128,Qt),new $e(8,32,128,256,Qt),new $e(32,128,258,1024,Qt),new $e(32,258,258,4096,Qt)],vo=e=>{e.window_size=2*e.w_size,_t(e.head),e.max_lazy_match=An[e.level].max_lazy,e.good_match=An[e.level].good_length,e.nice_match=An[e.level].nice_length,e.max_chain_length=An[e.level].max_chain,e.strstart=0,e.block_start=0,e.lookahead=0,e.insert=0,e.match_length=e.prev_length=K-1,e.match_available=0,e.ins_h=0};function Ao(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=Kn,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(go*2),this.dyn_dtree=new Uint16Array((2*uo+1)*2),this.bl_tree=new Uint16Array((2*fo+1)*2),_t(this.dyn_ltree),_t(this.dyn_dtree),_t(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(_o+1),this.heap=new Uint16Array(2*Fi+1),_t(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(2*Fi+1),_t(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}const Zr=e=>{if(!e||!e.state)return gt(e,Oe);e.total_in=e.total_out=0,e.data_type=ao;const t=e.state;return t.pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=t.wrap?qn:Pt,e.adler=t.wrap===2?0:1,t.last_flush=Bt,$a(t),Ye},Yr=e=>{const t=Zr(e);return t===Ye&&vo(e.state),t},No=(e,t)=>!e||!e.state||e.state.wrap!==2?Oe:(e.state.gzhead=t,Ye),$r=(e,t,n,i,r,s)=>{if(!e)return Oe;let a=1;if(t===to&&(t=6),i<0?(a=0,i=-i):i>15&&(a=2,i-=16),r<1||r>oo||n!==Kn||i<8||i>15||t<0||t>9||s<0||s>ro)return gt(e,Oe);i===8&&(i=9);const o=new Ao;return e.state=o,o.strm=e,o.wrap=a,o.gzhead=null,o.w_bits=i,o.w_size=1<<o.w_bits,o.w_mask=o.w_size-1,o.hash_bits=r+7,o.hash_size=1<<o.hash_bits,o.hash_mask=o.hash_size-1,o.hash_shift=~~((o.hash_bits+K-1)/K),o.window=new Uint8Array(o.w_size*2),o.head=new Uint16Array(o.hash_size),o.prev=new Uint16Array(o.w_size),o.lit_bufsize=1<<r+6,o.pending_buf_size=o.lit_bufsize*4,o.pending_buf=new Uint8Array(o.pending_buf_size),o.d_buf=1*o.lit_bufsize,o.l_buf=(1+2)*o.lit_bufsize,o.level=t,o.strategy=s,o.method=n,Yr(e)},yo=(e,t)=>$r(e,t,Kn,co,lo,so),ko=(e,t)=>{let n,i;if(!e||!e.state||t>Jr||t<0)return e?gt(e,Oe):Oe;const r=e.state;if(!e.output||!e.input&&e.avail_in!==0||r.status===Sn&&t!==ft)return gt(e,e.avail_out===0?Hi:Oe);r.strm=e;const s=r.last_flush;if(r.last_flush=t,r.status===qn)if(r.wrap===2)e.adler=0,X(r,31),X(r,139),X(r,8),r.gzhead?(X(r,(r.gzhead.text?1:0)+(r.gzhead.hcrc?2:0)+(r.gzhead.extra?4:0)+(r.gzhead.name?8:0)+(r.gzhead.comment?16:0)),X(r,r.gzhead.time&255),X(r,r.gzhead.time>>8&255),X(r,r.gzhead.time>>16&255),X(r,r.gzhead.time>>24&255),X(r,r.level===9?2:r.strategy>=$n||r.level<2?4:0),X(r,r.gzhead.os&255),r.gzhead.extra&&r.gzhead.extra.length&&(X(r,r.gzhead.extra.length&255),X(r,r.gzhead.extra.length>>8&255)),r.gzhead.hcrc&&(e.adler=me(e.adler,r.pending_buf,r.pending,0)),r.gzindex=0,r.status=Ji):(X(r,0),X(r,0),X(r,0),X(r,0),X(r,0),X(r,r.level===9?2:r.strategy>=$n||r.level<2?4:0),X(r,Eo),r.status=Pt);else{let a=Kn+(r.w_bits-8<<4)<<8,o=-1;r.strategy>=$n||r.level<2?o=0:r.level<6?o=1:r.level===6?o=2:o=3,a|=o<<6,r.strstart!==0&&(a|=mo),a+=31-a%31,r.status=Pt,vn(r,a),r.strstart!==0&&(vn(r,e.adler>>>16),vn(r,e.adler&65535)),e.adler=1}if(r.status===Ji)if(r.gzhead.extra){for(n=r.pending;r.gzindex<(r.gzhead.extra.length&65535)&&!(r.pending===r.pending_buf_size&&(r.gzhead.hcrc&&r.pending>n&&(e.adler=me(e.adler,r.pending_buf,r.pending-n,n)),Et(e),n=r.pending,r.pending===r.pending_buf_size));)X(r,r.gzhead.extra[r.gzindex]&255),r.gzindex++;r.gzhead.hcrc&&r.pending>n&&(e.adler=me(e.adler,r.pending_buf,r.pending-n,n)),r.gzindex===r.gzhead.extra.length&&(r.gzindex=0,r.status=Xn)}else r.status=Xn;if(r.status===Xn)if(r.gzhead.name){n=r.pending;do{if(r.pending===r.pending_buf_size&&(r.gzhead.hcrc&&r.pending>n&&(e.adler=me(e.adler,r.pending_buf,r.pending-n,n)),Et(e),n=r.pending,r.pending===r.pending_buf_size)){i=1;break}r.gzindex<r.gzhead.name.length?i=r.gzhead.name.charCodeAt(r.gzindex++)&255:i=0,X(r,i)}while(i!==0);r.gzhead.hcrc&&r.pending>n&&(e.adler=me(e.adler,r.pending_buf,r.pending-n,n)),i===0&&(r.gzindex=0,r.status=jn)}else r.status=jn;if(r.status===jn)if(r.gzhead.comment){n=r.pending;do{if(r.pending===r.pending_buf_size&&(r.gzhead.hcrc&&r.pending>n&&(e.adler=me(e.adler,r.pending_buf,r.pending-n,n)),Et(e),n=r.pending,r.pending===r.pending_buf_size)){i=1;break}r.gzindex<r.gzhead.comment.length?i=r.gzhead.comment.charCodeAt(r.gzindex++)&255:i=0,X(r,i)}while(i!==0);r.gzhead.hcrc&&r.pending>n&&(e.adler=me(e.adler,r.pending_buf,r.pending-n,n)),i===0&&(r.status=Qn)}else r.status=Qn;if(r.status===Qn&&(r.gzhead.hcrc?(r.pending+2>r.pending_buf_size&&Et(e),r.pending+2<=r.pending_buf_size&&(X(r,e.adler&255),X(r,e.adler>>8&255),e.adler=0,r.status=Pt)):r.status=Pt),r.pending!==0){if(Et(e),e.avail_out===0)return r.last_flush=-1,Ye}else if(e.avail_in===0&&Wr(t)<=Wr(s)&&t!==ft)return gt(e,Hi);if(r.status===Sn&&e.avail_in!==0)return gt(e,Hi);if(e.avail_in!==0||r.lookahead!==0||t!==Bt&&r.status!==Sn){let a=r.strategy===$n?bo(r,t):r.strategy===io?So(r,t):An[r.level].func(r,t);if((a===Gt||a===jt)&&(r.status=Sn),a===he||a===Gt)return e.avail_out===0&&(r.last_flush=-1),Ye;if(a===bn&&(t===ja?Xa(r):t!==Jr&&(Ka(r,0,0,!1),t===Qa&&(_t(r.head),r.lookahead===0&&(r.strstart=0,r.block_start=0,r.insert=0))),Et(e),e.avail_out===0))return r.last_flush=-1,Ye}return t!==ft?Ye:r.wrap<=0?Ur:(r.wrap===2?(X(r,e.adler&255),X(r,e.adler>>8&255),X(r,e.adler>>16&255),X(r,e.adler>>24&255),X(r,e.total_in&255),X(r,e.total_in>>8&255),X(r,e.total_in>>16&255),X(r,e.total_in>>24&255)):(vn(r,e.adler>>>16),vn(r,e.adler&65535)),Et(e),r.wrap>0&&(r.wrap=-r.wrap),r.pending!==0?Ye:Ur)},Ro=e=>{if(!e||!e.state)return Oe;const t=e.state.status;return t!==qn&&t!==Ji&&t!==Xn&&t!==jn&&t!==Qn&&t!==Pt&&t!==Sn?gt(e,Oe):(e.state=null,t===Pt?gt(e,eo):Ye)},To=(e,t)=>{let n=t.length;if(!e||!e.state)return Oe;const i=e.state,r=i.wrap;if(r===2||r===1&&i.status!==qn||i.lookahead)return Oe;if(r===1&&(e.adler=pn(e.adler,t,n,0)),i.wrap=0,n>=i.w_size){r===0&&(_t(i.head),i.strstart=0,i.block_start=0,i.insert=0);let u=new Uint8Array(i.w_size);u.set(t.subarray(n-i.w_size,n),0),t=u,n=i.w_size}const s=e.avail_in,a=e.next_in,o=e.input;for(e.avail_in=n,e.next_in=0,e.input=t,Dt(i);i.lookahead>=K;){let u=i.strstart,c=i.lookahead-(K-1);do i.ins_h=mt(i,i.ins_h,i.window[u+K-1]),i.prev[u&i.w_mask]=i.head[i.ins_h],i.head[i.ins_h]=u,u++;while(--c);i.strstart=u,i.lookahead=K-1,Dt(i)}return i.strstart+=i.lookahead,i.block_start=i.strstart,i.insert=i.lookahead,i.lookahead=0,i.match_length=i.prev_length=K-1,i.match_available=0,e.next_in=a,e.input=o,e.avail_in=s,i.wrap=r,Ye};var Io=yo,Oo=$r,Co=Yr,Mo=Zr,Lo=No,Bo=ko,Po=Ro,Go=To,Do="pako deflate (from Nodeca project)",Nn={deflateInit:Io,deflateInit2:Oo,deflateReset:Co,deflateResetKeep:Mo,deflateSetHeader:Lo,deflate:Bo,deflateEnd:Po,deflateSetDictionary:Go,deflateInfo:Do};const xo=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var zo=function(e){const t=Array.prototype.slice.call(arguments,1);for(;t.length;){const n=t.shift();if(!!n){if(typeof n!="object")throw new TypeError(n+"must be non-object");for(const i in n)xo(n,i)&&(e[i]=n[i])}}return e},Ho=e=>{let t=0;for(let i=0,r=e.length;i<r;i++)t+=e[i].length;const n=new Uint8Array(t);for(let i=0,r=0,s=e.length;i<s;i++){let a=e[i];n.set(a,r),r+=a.length}return n},ei={assign:zo,flattenChunks:Ho};let Kr=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{Kr=!1}const yn=new Uint8Array(256);for(let e=0;e<256;e++)yn[e]=e>=252?6:e>=248?5:e>=240?4:e>=224?3:e>=192?2:1;yn[254]=yn[254]=1;var Fo=e=>{if(typeof TextEncoder=="function"&&TextEncoder.prototype.encode)return new TextEncoder().encode(e);let t,n,i,r,s,a=e.length,o=0;for(r=0;r<a;r++)n=e.charCodeAt(r),(n&64512)===55296&&r+1<a&&(i=e.charCodeAt(r+1),(i&64512)===56320&&(n=65536+(n-55296<<10)+(i-56320),r++)),o+=n<128?1:n<2048?2:n<65536?3:4;for(t=new Uint8Array(o),s=0,r=0;s<o;r++)n=e.charCodeAt(r),(n&64512)===55296&&r+1<a&&(i=e.charCodeAt(r+1),(i&64512)===56320&&(n=65536+(n-55296<<10)+(i-56320),r++)),n<128?t[s++]=n:n<2048?(t[s++]=192|n>>>6,t[s++]=128|n&63):n<65536?(t[s++]=224|n>>>12,t[s++]=128|n>>>6&63,t[s++]=128|n&63):(t[s++]=240|n>>>18,t[s++]=128|n>>>12&63,t[s++]=128|n>>>6&63,t[s++]=128|n&63);return t};const Jo=(e,t)=>{if(t<65534&&e.subarray&&Kr)return String.fromCharCode.apply(null,e.length===t?e:e.subarray(0,t));let n="";for(let i=0;i<t;i++)n+=String.fromCharCode(e[i]);return n};var Uo=(e,t)=>{const n=t||e.length;if(typeof TextDecoder=="function"&&TextDecoder.prototype.decode)return new TextDecoder().decode(e.subarray(0,t));let i,r;const s=new Array(n*2);for(r=0,i=0;i<n;){let a=e[i++];if(a<128){s[r++]=a;continue}let o=yn[a];if(o>4){s[r++]=65533,i+=o-1;continue}for(a&=o===2?31:o===3?15:7;o>1&&i<n;)a=a<<6|e[i++]&63,o--;if(o>1){s[r++]=65533;continue}a<65536?s[r++]=a:(a-=65536,s[r++]=55296|a>>10&1023,s[r++]=56320|a&1023)}return Jo(s,r)},Wo=(e,t)=>{t=t||e.length,t>e.length&&(t=e.length);let n=t-1;for(;n>=0&&(e[n]&192)===128;)n--;return n<0||n===0?t:n+yn[e[n]]>t?n:t},kn={string2buf:Fo,buf2string:Uo,utf8border:Wo};function Vo(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}var qr=Vo;const Xr=Object.prototype.toString,{Z_NO_FLUSH:Zo,Z_SYNC_FLUSH:Yo,Z_FULL_FLUSH:$o,Z_FINISH:Ko,Z_OK:ti,Z_STREAM_END:qo,Z_DEFAULT_COMPRESSION:Xo,Z_DEFAULT_STRATEGY:jo,Z_DEFLATED:Qo}=Lt;function Rn(e){this.options=ei.assign({level:Xo,method:Qo,chunkSize:16384,windowBits:15,memLevel:8,strategy:jo},e||{});let t=this.options;t.raw&&t.windowBits>0?t.windowBits=-t.windowBits:t.gzip&&t.windowBits>0&&t.windowBits<16&&(t.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new qr,this.strm.avail_out=0;let n=Nn.deflateInit2(this.strm,t.level,t.method,t.windowBits,t.memLevel,t.strategy);if(n!==ti)throw new Error(Mt[n]);if(t.header&&Nn.deflateSetHeader(this.strm,t.header),t.dictionary){let i;if(typeof t.dictionary=="string"?i=kn.string2buf(t.dictionary):Xr.call(t.dictionary)==="[object ArrayBuffer]"?i=new Uint8Array(t.dictionary):i=t.dictionary,n=Nn.deflateSetDictionary(this.strm,i),n!==ti)throw new Error(Mt[n]);this._dict_set=!0}}Rn.prototype.push=function(e,t){const n=this.strm,i=this.options.chunkSize;let r,s;if(this.ended)return!1;for(t===~~t?s=t:s=t===!0?Ko:Zo,typeof e=="string"?n.input=kn.string2buf(e):Xr.call(e)==="[object ArrayBuffer]"?n.input=new Uint8Array(e):n.input=e,n.next_in=0,n.avail_in=n.input.length;;){if(n.avail_out===0&&(n.output=new Uint8Array(i),n.next_out=0,n.avail_out=i),(s===Yo||s===$o)&&n.avail_out<=6){this.onData(n.output.subarray(0,n.next_out)),n.avail_out=0;continue}if(r=Nn.deflate(n,s),r===qo)return n.next_out>0&&this.onData(n.output.subarray(0,n.next_out)),r=Nn.deflateEnd(this.strm),this.onEnd(r),this.ended=!0,r===ti;if(n.avail_out===0){this.onData(n.output);continue}if(s>0&&n.next_out>0){this.onData(n.output.subarray(0,n.next_out)),n.avail_out=0;continue}if(n.avail_in===0)break}return!0},Rn.prototype.onData=function(e){this.chunks.push(e)},Rn.prototype.onEnd=function(e){e===ti&&(this.result=ei.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};function Wi(e,t){const n=new Rn(t);if(n.push(e,!0),n.err)throw n.msg||Mt[n.err];return n.result}function ec(e,t){return t=t||{},t.raw=!0,Wi(e,t)}function tc(e,t){return t=t||{},t.gzip=!0,Wi(e,t)}var nc=Rn,ic=Wi,rc=ec,sc=tc,ac=Lt,oc={Deflate:nc,deflate:ic,deflateRaw:rc,gzip:sc,constants:ac};const ni=30,cc=12;var lc=function(t,n){let i,r,s,a,o,u,c,h,f,g,d,E,b,_,w,A,N,v,R,O,k,T,C,I;const M=t.state;i=t.next_in,C=t.input,r=i+(t.avail_in-5),s=t.next_out,I=t.output,a=s-(n-t.avail_out),o=s+(t.avail_out-257),u=M.dmax,c=M.wsize,h=M.whave,f=M.wnext,g=M.window,d=M.hold,E=M.bits,b=M.lencode,_=M.distcode,w=(1<<M.lenbits)-1,A=(1<<M.distbits)-1;e:do{E<15&&(d+=C[i++]<<E,E+=8,d+=C[i++]<<E,E+=8),N=b[d&w];t:for(;;){if(v=N>>>24,d>>>=v,E-=v,v=N>>>16&255,v===0)I[s++]=N&65535;else if(v&16){R=N&65535,v&=15,v&&(E<v&&(d+=C[i++]<<E,E+=8),R+=d&(1<<v)-1,d>>>=v,E-=v),E<15&&(d+=C[i++]<<E,E+=8,d+=C[i++]<<E,E+=8),N=_[d&A];n:for(;;){if(v=N>>>24,d>>>=v,E-=v,v=N>>>16&255,v&16){if(O=N&65535,v&=15,E<v&&(d+=C[i++]<<E,E+=8,E<v&&(d+=C[i++]<<E,E+=8)),O+=d&(1<<v)-1,O>u){t.msg="invalid distance too far back",M.mode=ni;break e}if(d>>>=v,E-=v,v=s-a,O>v){if(v=O-v,v>h&&M.sane){t.msg="invalid distance too far back",M.mode=ni;break e}if(k=0,T=g,f===0){if(k+=c-v,v<R){R-=v;do I[s++]=g[k++];while(--v);k=s-O,T=I}}else if(f<v){if(k+=c+f-v,v-=f,v<R){R-=v;do I[s++]=g[k++];while(--v);if(k=0,f<R){v=f,R-=v;do I[s++]=g[k++];while(--v);k=s-O,T=I}}}else if(k+=f-v,v<R){R-=v;do I[s++]=g[k++];while(--v);k=s-O,T=I}for(;R>2;)I[s++]=T[k++],I[s++]=T[k++],I[s++]=T[k++],R-=3;R&&(I[s++]=T[k++],R>1&&(I[s++]=T[k++]))}else{k=s-O;do I[s++]=I[k++],I[s++]=I[k++],I[s++]=I[k++],R-=3;while(R>2);R&&(I[s++]=I[k++],R>1&&(I[s++]=I[k++]))}}else if((v&64)===0){N=_[(N&65535)+(d&(1<<v)-1)];continue n}else{t.msg="invalid distance code",M.mode=ni;break e}break}}else if((v&64)===0){N=b[(N&65535)+(d&(1<<v)-1)];continue t}else if(v&32){M.mode=cc;break e}else{t.msg="invalid literal/length code",M.mode=ni;break e}break}}while(i<r&&s<o);R=E>>3,i-=R,E-=R<<3,d&=(1<<E)-1,t.next_in=i,t.next_out=s,t.avail_in=i<r?5+(r-i):5-(i-r),t.avail_out=s<o?257+(o-s):257-(s-o),M.hold=d,M.bits=E};const en=15,jr=852,Qr=592,es=0,Vi=1,ts=2,hc=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),uc=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),fc=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),dc=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]);var Tn=(e,t,n,i,r,s,a,o)=>{const u=o.bits;let c=0,h=0,f=0,g=0,d=0,E=0,b=0,_=0,w=0,A=0,N,v,R,O,k,T=null,C=0,I;const M=new Uint16Array(en+1),x=new Uint16Array(en+1);let J=null,F=0,ne,se,le;for(c=0;c<=en;c++)M[c]=0;for(h=0;h<i;h++)M[t[n+h]]++;for(d=u,g=en;g>=1&&M[g]===0;g--);if(d>g&&(d=g),g===0)return r[s++]=1<<24|64<<16|0,r[s++]=1<<24|64<<16|0,o.bits=1,0;for(f=1;f<g&&M[f]===0;f++);for(d<f&&(d=f),_=1,c=1;c<=en;c++)if(_<<=1,_-=M[c],_<0)return-1;if(_>0&&(e===es||g!==1))return-1;for(x[1]=0,c=1;c<en;c++)x[c+1]=x[c]+M[c];for(h=0;h<i;h++)t[n+h]!==0&&(a[x[t[n+h]]++]=h);if(e===es?(T=J=a,I=19):e===Vi?(T=hc,C-=257,J=uc,F-=257,I=256):(T=fc,J=dc,I=-1),A=0,h=0,c=f,k=s,E=d,b=0,R=-1,w=1<<d,O=w-1,e===Vi&&w>jr||e===ts&&w>Qr)return 1;for(;;){ne=c-b,a[h]<I?(se=0,le=a[h]):a[h]>I?(se=J[F+a[h]],le=T[C+a[h]]):(se=32+64,le=0),N=1<<c-b,v=1<<E,f=v;do v-=N,r[k+(A>>b)+v]=ne<<24|se<<16|le|0;while(v!==0);for(N=1<<c-1;A&N;)N>>=1;if(N!==0?(A&=N-1,A+=N):A=0,h++,--M[c]===0){if(c===g)break;c=t[n+a[h]]}if(c>d&&(A&O)!==R){for(b===0&&(b=d),k+=f,E=c-b,_=1<<E;E+b<g&&(_-=M[E+b],!(_<=0));)E++,_<<=1;if(w+=1<<E,e===Vi&&w>jr||e===ts&&w>Qr)return 1;R=A&O,r[R]=d<<24|E<<16|k-s|0}}return A!==0&&(r[k+A]=c-b<<24|64<<16|0),o.bits=d,0};const gc=0,ns=1,is=2,{Z_FINISH:rs,Z_BLOCK:_c,Z_TREES:ii,Z_OK:xt,Z_STREAM_END:mc,Z_NEED_DICT:Ec,Z_STREAM_ERROR:Ce,Z_DATA_ERROR:ss,Z_MEM_ERROR:as,Z_BUF_ERROR:wc,Z_DEFLATED:os}=Lt,cs=1,ls=2,hs=3,us=4,fs=5,ds=6,gs=7,_s=8,ms=9,Es=10,ri=11,tt=12,Zi=13,ws=14,Yi=15,ps=16,Ss=17,bs=18,vs=19,si=20,ai=21,As=22,Ns=23,ys=24,ks=25,Rs=26,$i=27,Ts=28,Is=29,ae=30,Os=31,pc=32,Sc=852,bc=592,vc=15,Cs=e=>(e>>>24&255)+(e>>>8&65280)+((e&65280)<<8)+((e&255)<<24);function Ac(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const Ms=e=>{if(!e||!e.state)return Ce;const t=e.state;return e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=t.wrap&1),t.mode=cs,t.last=0,t.havedict=0,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new Int32Array(Sc),t.distcode=t.distdyn=new Int32Array(bc),t.sane=1,t.back=-1,xt},Ls=e=>{if(!e||!e.state)return Ce;const t=e.state;return t.wsize=0,t.whave=0,t.wnext=0,Ms(e)},Bs=(e,t)=>{let n;if(!e||!e.state)return Ce;const i=e.state;return t<0?(n=0,t=-t):(n=(t>>4)+1,t<48&&(t&=15)),t&&(t<8||t>15)?Ce:(i.window!==null&&i.wbits!==t&&(i.window=null),i.wrap=n,i.wbits=t,Ls(e))},Ps=(e,t)=>{if(!e)return Ce;const n=new Ac;e.state=n,n.window=null;const i=Bs(e,t);return i!==xt&&(e.state=null),i},Nc=e=>Ps(e,vc);let Gs=!0,Ki,qi;const yc=e=>{if(Gs){Ki=new Int32Array(512),qi=new Int32Array(32);let t=0;for(;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(Tn(ns,e.lens,0,288,Ki,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;Tn(is,e.lens,0,32,qi,0,e.work,{bits:5}),Gs=!1}e.lencode=Ki,e.lenbits=9,e.distcode=qi,e.distbits=5},Ds=(e,t,n,i)=>{let r;const s=e.state;return s.window===null&&(s.wsize=1<<s.wbits,s.wnext=0,s.whave=0,s.window=new Uint8Array(s.wsize)),i>=s.wsize?(s.window.set(t.subarray(n-s.wsize,n),0),s.wnext=0,s.whave=s.wsize):(r=s.wsize-s.wnext,r>i&&(r=i),s.window.set(t.subarray(n-i,n-i+r),s.wnext),i-=r,i?(s.window.set(t.subarray(n-i,n),0),s.wnext=i,s.whave=s.wsize):(s.wnext+=r,s.wnext===s.wsize&&(s.wnext=0),s.whave<s.wsize&&(s.whave+=r))),0},kc=(e,t)=>{let n,i,r,s,a,o,u,c,h,f,g,d,E,b,_=0,w,A,N,v,R,O,k,T;const C=new Uint8Array(4);let I,M;const x=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(!e||!e.state||!e.output||!e.input&&e.avail_in!==0)return Ce;n=e.state,n.mode===tt&&(n.mode=Zi),a=e.next_out,r=e.output,u=e.avail_out,s=e.next_in,i=e.input,o=e.avail_in,c=n.hold,h=n.bits,f=o,g=u,T=xt;e:for(;;)switch(n.mode){case cs:if(n.wrap===0){n.mode=Zi;break}for(;h<16;){if(o===0)break e;o--,c+=i[s++]<<h,h+=8}if(n.wrap&2&&c===35615){n.check=0,C[0]=c&255,C[1]=c>>>8&255,n.check=me(n.check,C,2,0),c=0,h=0,n.mode=ls;break}if(n.flags=0,n.head&&(n.head.done=!1),!(n.wrap&1)||(((c&255)<<8)+(c>>8))%31){e.msg="incorrect header check",n.mode=ae;break}if((c&15)!==os){e.msg="unknown compression method",n.mode=ae;break}if(c>>>=4,h-=4,k=(c&15)+8,n.wbits===0)n.wbits=k;else if(k>n.wbits){e.msg="invalid window size",n.mode=ae;break}n.dmax=1<<n.wbits,e.adler=n.check=1,n.mode=c&512?Es:tt,c=0,h=0;break;case ls:for(;h<16;){if(o===0)break e;o--,c+=i[s++]<<h,h+=8}if(n.flags=c,(n.flags&255)!==os){e.msg="unknown compression method",n.mode=ae;break}if(n.flags&57344){e.msg="unknown header flags set",n.mode=ae;break}n.head&&(n.head.text=c>>8&1),n.flags&512&&(C[0]=c&255,C[1]=c>>>8&255,n.check=me(n.check,C,2,0)),c=0,h=0,n.mode=hs;case hs:for(;h<32;){if(o===0)break e;o--,c+=i[s++]<<h,h+=8}n.head&&(n.head.time=c),n.flags&512&&(C[0]=c&255,C[1]=c>>>8&255,C[2]=c>>>16&255,C[3]=c>>>24&255,n.check=me(n.check,C,4,0)),c=0,h=0,n.mode=us;case us:for(;h<16;){if(o===0)break e;o--,c+=i[s++]<<h,h+=8}n.head&&(n.head.xflags=c&255,n.head.os=c>>8),n.flags&512&&(C[0]=c&255,C[1]=c>>>8&255,n.check=me(n.check,C,2,0)),c=0,h=0,n.mode=fs;case fs:if(n.flags&1024){for(;h<16;){if(o===0)break e;o--,c+=i[s++]<<h,h+=8}n.length=c,n.head&&(n.head.extra_len=c),n.flags&512&&(C[0]=c&255,C[1]=c>>>8&255,n.check=me(n.check,C,2,0)),c=0,h=0}else n.head&&(n.head.extra=null);n.mode=ds;case ds:if(n.flags&1024&&(d=n.length,d>o&&(d=o),d&&(n.head&&(k=n.head.extra_len-n.length,n.head.extra||(n.head.extra=new Uint8Array(n.head.extra_len)),n.head.extra.set(i.subarray(s,s+d),k)),n.flags&512&&(n.check=me(n.check,i,d,s)),o-=d,s+=d,n.length-=d),n.length))break e;n.length=0,n.mode=gs;case gs:if(n.flags&2048){if(o===0)break e;d=0;do k=i[s+d++],n.head&&k&&n.length<65536&&(n.head.name+=String.fromCharCode(k));while(k&&d<o);if(n.flags&512&&(n.check=me(n.check,i,d,s)),o-=d,s+=d,k)break e}else n.head&&(n.head.name=null);n.length=0,n.mode=_s;case _s:if(n.flags&4096){if(o===0)break e;d=0;do k=i[s+d++],n.head&&k&&n.length<65536&&(n.head.comment+=String.fromCharCode(k));while(k&&d<o);if(n.flags&512&&(n.check=me(n.check,i,d,s)),o-=d,s+=d,k)break e}else n.head&&(n.head.comment=null);n.mode=ms;case ms:if(n.flags&512){for(;h<16;){if(o===0)break e;o--,c+=i[s++]<<h,h+=8}if(c!==(n.check&65535)){e.msg="header crc mismatch",n.mode=ae;break}c=0,h=0}n.head&&(n.head.hcrc=n.flags>>9&1,n.head.done=!0),e.adler=n.check=0,n.mode=tt;break;case Es:for(;h<32;){if(o===0)break e;o--,c+=i[s++]<<h,h+=8}e.adler=n.check=Cs(c),c=0,h=0,n.mode=ri;case ri:if(n.havedict===0)return e.next_out=a,e.avail_out=u,e.next_in=s,e.avail_in=o,n.hold=c,n.bits=h,Ec;e.adler=n.check=1,n.mode=tt;case tt:if(t===_c||t===ii)break e;case Zi:if(n.last){c>>>=h&7,h-=h&7,n.mode=$i;break}for(;h<3;){if(o===0)break e;o--,c+=i[s++]<<h,h+=8}switch(n.last=c&1,c>>>=1,h-=1,c&3){case 0:n.mode=ws;break;case 1:if(yc(n),n.mode=si,t===ii){c>>>=2,h-=2;break e}break;case 2:n.mode=Ss;break;case 3:e.msg="invalid block type",n.mode=ae}c>>>=2,h-=2;break;case ws:for(c>>>=h&7,h-=h&7;h<32;){if(o===0)break e;o--,c+=i[s++]<<h,h+=8}if((c&65535)!==(c>>>16^65535)){e.msg="invalid stored block lengths",n.mode=ae;break}if(n.length=c&65535,c=0,h=0,n.mode=Yi,t===ii)break e;case Yi:n.mode=ps;case ps:if(d=n.length,d){if(d>o&&(d=o),d>u&&(d=u),d===0)break e;r.set(i.subarray(s,s+d),a),o-=d,s+=d,u-=d,a+=d,n.length-=d;break}n.mode=tt;break;case Ss:for(;h<14;){if(o===0)break e;o--,c+=i[s++]<<h,h+=8}if(n.nlen=(c&31)+257,c>>>=5,h-=5,n.ndist=(c&31)+1,c>>>=5,h-=5,n.ncode=(c&15)+4,c>>>=4,h-=4,n.nlen>286||n.ndist>30){e.msg="too many length or distance symbols",n.mode=ae;break}n.have=0,n.mode=bs;case bs:for(;n.have<n.ncode;){for(;h<3;){if(o===0)break e;o--,c+=i[s++]<<h,h+=8}n.lens[x[n.have++]]=c&7,c>>>=3,h-=3}for(;n.have<19;)n.lens[x[n.have++]]=0;if(n.lencode=n.lendyn,n.lenbits=7,I={bits:n.lenbits},T=Tn(gc,n.lens,0,19,n.lencode,0,n.work,I),n.lenbits=I.bits,T){e.msg="invalid code lengths set",n.mode=ae;break}n.have=0,n.mode=vs;case vs:for(;n.have<n.nlen+n.ndist;){for(;_=n.lencode[c&(1<<n.lenbits)-1],w=_>>>24,A=_>>>16&255,N=_&65535,!(w<=h);){if(o===0)break e;o--,c+=i[s++]<<h,h+=8}if(N<16)c>>>=w,h-=w,n.lens[n.have++]=N;else{if(N===16){for(M=w+2;h<M;){if(o===0)break e;o--,c+=i[s++]<<h,h+=8}if(c>>>=w,h-=w,n.have===0){e.msg="invalid bit length repeat",n.mode=ae;break}k=n.lens[n.have-1],d=3+(c&3),c>>>=2,h-=2}else if(N===17){for(M=w+3;h<M;){if(o===0)break e;o--,c+=i[s++]<<h,h+=8}c>>>=w,h-=w,k=0,d=3+(c&7),c>>>=3,h-=3}else{for(M=w+7;h<M;){if(o===0)break e;o--,c+=i[s++]<<h,h+=8}c>>>=w,h-=w,k=0,d=11+(c&127),c>>>=7,h-=7}if(n.have+d>n.nlen+n.ndist){e.msg="invalid bit length repeat",n.mode=ae;break}for(;d--;)n.lens[n.have++]=k}}if(n.mode===ae)break;if(n.lens[256]===0){e.msg="invalid code -- missing end-of-block",n.mode=ae;break}if(n.lenbits=9,I={bits:n.lenbits},T=Tn(ns,n.lens,0,n.nlen,n.lencode,0,n.work,I),n.lenbits=I.bits,T){e.msg="invalid literal/lengths set",n.mode=ae;break}if(n.distbits=6,n.distcode=n.distdyn,I={bits:n.distbits},T=Tn(is,n.lens,n.nlen,n.ndist,n.distcode,0,n.work,I),n.distbits=I.bits,T){e.msg="invalid distances set",n.mode=ae;break}if(n.mode=si,t===ii)break e;case si:n.mode=ai;case ai:if(o>=6&&u>=258){e.next_out=a,e.avail_out=u,e.next_in=s,e.avail_in=o,n.hold=c,n.bits=h,lc(e,g),a=e.next_out,r=e.output,u=e.avail_out,s=e.next_in,i=e.input,o=e.avail_in,c=n.hold,h=n.bits,n.mode===tt&&(n.back=-1);break}for(n.back=0;_=n.lencode[c&(1<<n.lenbits)-1],w=_>>>24,A=_>>>16&255,N=_&65535,!(w<=h);){if(o===0)break e;o--,c+=i[s++]<<h,h+=8}if(A&&(A&240)===0){for(v=w,R=A,O=N;_=n.lencode[O+((c&(1<<v+R)-1)>>v)],w=_>>>24,A=_>>>16&255,N=_&65535,!(v+w<=h);){if(o===0)break e;o--,c+=i[s++]<<h,h+=8}c>>>=v,h-=v,n.back+=v}if(c>>>=w,h-=w,n.back+=w,n.length=N,A===0){n.mode=Rs;break}if(A&32){n.back=-1,n.mode=tt;break}if(A&64){e.msg="invalid literal/length code",n.mode=ae;break}n.extra=A&15,n.mode=As;case As:if(n.extra){for(M=n.extra;h<M;){if(o===0)break e;o--,c+=i[s++]<<h,h+=8}n.length+=c&(1<<n.extra)-1,c>>>=n.extra,h-=n.extra,n.back+=n.extra}n.was=n.length,n.mode=Ns;case Ns:for(;_=n.distcode[c&(1<<n.distbits)-1],w=_>>>24,A=_>>>16&255,N=_&65535,!(w<=h);){if(o===0)break e;o--,c+=i[s++]<<h,h+=8}if((A&240)===0){for(v=w,R=A,O=N;_=n.distcode[O+((c&(1<<v+R)-1)>>v)],w=_>>>24,A=_>>>16&255,N=_&65535,!(v+w<=h);){if(o===0)break e;o--,c+=i[s++]<<h,h+=8}c>>>=v,h-=v,n.back+=v}if(c>>>=w,h-=w,n.back+=w,A&64){e.msg="invalid distance code",n.mode=ae;break}n.offset=N,n.extra=A&15,n.mode=ys;case ys:if(n.extra){for(M=n.extra;h<M;){if(o===0)break e;o--,c+=i[s++]<<h,h+=8}n.offset+=c&(1<<n.extra)-1,c>>>=n.extra,h-=n.extra,n.back+=n.extra}if(n.offset>n.dmax){e.msg="invalid distance too far back",n.mode=ae;break}n.mode=ks;case ks:if(u===0)break e;if(d=g-u,n.offset>d){if(d=n.offset-d,d>n.whave&&n.sane){e.msg="invalid distance too far back",n.mode=ae;break}d>n.wnext?(d-=n.wnext,E=n.wsize-d):E=n.wnext-d,d>n.length&&(d=n.length),b=n.window}else b=r,E=a-n.offset,d=n.length;d>u&&(d=u),u-=d,n.length-=d;do r[a++]=b[E++];while(--d);n.length===0&&(n.mode=ai);break;case Rs:if(u===0)break e;r[a++]=n.length,u--,n.mode=ai;break;case $i:if(n.wrap){for(;h<32;){if(o===0)break e;o--,c|=i[s++]<<h,h+=8}if(g-=u,e.total_out+=g,n.total+=g,g&&(e.adler=n.check=n.flags?me(n.check,r,g,a-g):pn(n.check,r,g,a-g)),g=u,(n.flags?c:Cs(c))!==n.check){e.msg="incorrect data check",n.mode=ae;break}c=0,h=0}n.mode=Ts;case Ts:if(n.wrap&&n.flags){for(;h<32;){if(o===0)break e;o--,c+=i[s++]<<h,h+=8}if(c!==(n.total&4294967295)){e.msg="incorrect length check",n.mode=ae;break}c=0,h=0}n.mode=Is;case Is:T=mc;break e;case ae:T=ss;break e;case Os:return as;case pc:default:return Ce}return e.next_out=a,e.avail_out=u,e.next_in=s,e.avail_in=o,n.hold=c,n.bits=h,(n.wsize||g!==e.avail_out&&n.mode<ae&&(n.mode<$i||t!==rs))&&Ds(e,e.output,e.next_out,g-e.avail_out),f-=e.avail_in,g-=e.avail_out,e.total_in+=f,e.total_out+=g,n.total+=g,n.wrap&&g&&(e.adler=n.check=n.flags?me(n.check,r,g,e.next_out-g):pn(n.check,r,g,e.next_out-g)),e.data_type=n.bits+(n.last?64:0)+(n.mode===tt?128:0)+(n.mode===si||n.mode===Yi?256:0),(f===0&&g===0||t===rs)&&T===xt&&(T=wc),T},Rc=e=>{if(!e||!e.state)return Ce;let t=e.state;return t.window&&(t.window=null),e.state=null,xt},Tc=(e,t)=>{if(!e||!e.state)return Ce;const n=e.state;return(n.wrap&2)===0?Ce:(n.head=t,t.done=!1,xt)},Ic=(e,t)=>{const n=t.length;let i,r,s;return!e||!e.state||(i=e.state,i.wrap!==0&&i.mode!==ri)?Ce:i.mode===ri&&(r=1,r=pn(r,t,n,0),r!==i.check)?ss:(s=Ds(e,t,n,n),s?(i.mode=Os,as):(i.havedict=1,xt))};var Oc=Ls,Cc=Bs,Mc=Ms,Lc=Nc,Bc=Ps,Pc=kc,Gc=Rc,Dc=Tc,xc=Ic,zc="pako inflate (from Nodeca project)",nt={inflateReset:Oc,inflateReset2:Cc,inflateResetKeep:Mc,inflateInit:Lc,inflateInit2:Bc,inflate:Pc,inflateEnd:Gc,inflateGetHeader:Dc,inflateSetDictionary:xc,inflateInfo:zc};function Hc(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}var Fc=Hc;const xs=Object.prototype.toString,{Z_NO_FLUSH:Jc,Z_FINISH:Uc,Z_OK:In,Z_STREAM_END:Xi,Z_NEED_DICT:ji,Z_STREAM_ERROR:Wc,Z_DATA_ERROR:zs,Z_MEM_ERROR:Vc}=Lt;function On(e){this.options=ei.assign({chunkSize:1024*64,windowBits:15,to:""},e||{});const t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,t.windowBits===0&&(t.windowBits=-15)),t.windowBits>=0&&t.windowBits<16&&!(e&&e.windowBits)&&(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&(t.windowBits&15)===0&&(t.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new qr,this.strm.avail_out=0;let n=nt.inflateInit2(this.strm,t.windowBits);if(n!==In)throw new Error(Mt[n]);if(this.header=new Fc,nt.inflateGetHeader(this.strm,this.header),t.dictionary&&(typeof t.dictionary=="string"?t.dictionary=kn.string2buf(t.dictionary):xs.call(t.dictionary)==="[object ArrayBuffer]"&&(t.dictionary=new Uint8Array(t.dictionary)),t.raw&&(n=nt.inflateSetDictionary(this.strm,t.dictionary),n!==In)))throw new Error(Mt[n])}On.prototype.push=function(e,t){const n=this.strm,i=this.options.chunkSize,r=this.options.dictionary;let s,a,o;if(this.ended)return!1;for(t===~~t?a=t:a=t===!0?Uc:Jc,xs.call(e)==="[object ArrayBuffer]"?n.input=new Uint8Array(e):n.input=e,n.next_in=0,n.avail_in=n.input.length;;){for(n.avail_out===0&&(n.output=new Uint8Array(i),n.next_out=0,n.avail_out=i),s=nt.inflate(n,a),s===ji&&r&&(s=nt.inflateSetDictionary(n,r),s===In?s=nt.inflate(n,a):s===zs&&(s=ji));n.avail_in>0&&s===Xi&&n.state.wrap>0&&e[n.next_in]!==0;)nt.inflateReset(n),s=nt.inflate(n,a);switch(s){case Wc:case zs:case ji:case Vc:return this.onEnd(s),this.ended=!0,!1}if(o=n.avail_out,n.next_out&&(n.avail_out===0||s===Xi))if(this.options.to==="string"){let u=kn.utf8border(n.output,n.next_out),c=n.next_out-u,h=kn.buf2string(n.output,u);n.next_out=c,n.avail_out=i-c,c&&n.output.set(n.output.subarray(u,u+c),0),this.onData(h)}else this.onData(n.output.length===n.next_out?n.output:n.output.subarray(0,n.next_out));if(!(s===In&&o===0)){if(s===Xi)return s=nt.inflateEnd(this.strm),this.onEnd(s),this.ended=!0,!0;if(n.avail_in===0)break}}return!0},On.prototype.onData=function(e){this.chunks.push(e)},On.prototype.onEnd=function(e){e===In&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=ei.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};function Qi(e,t){const n=new On(t);if(n.push(e),n.err)throw n.msg||Mt[n.err];return n.result}function Zc(e,t){return t=t||{},t.raw=!0,Qi(e,t)}var Yc=On,$c=Qi,Kc=Zc,qc=Qi,Xc=Lt,jc={Inflate:Yc,inflate:$c,inflateRaw:Kc,ungzip:qc,constants:Xc};const{Deflate:Qc,deflate:el,deflateRaw:tl,gzip:nl}=oc,{Inflate:il,inflate:rl,inflateRaw:sl,ungzip:al}=jc;var ol=Qc,cl=el,ll=tl,hl=nl,ul=il,fl=rl,dl=sl,gl=al,_l=Lt,er={Deflate:ol,deflate:cl,deflateRaw:ll,gzip:hl,Inflate:ul,inflate:fl,inflateRaw:dl,ungzip:gl,constants:_l},B=(e=>(e[e.End=0]="End",e[e.Byte=1]="Byte",e[e.Short=2]="Short",e[e.Int=3]="Int",e[e.Long=4]="Long",e[e.Float=5]="Float",e[e.Double=6]="Double",e[e.ByteArray=7]="ByteArray",e[e.String=8]="String",e[e.List=9]="List",e[e.Compound=10]="Compound",e[e.IntArray=11]="IntArray",e[e.LongArray=12]="LongArray",e))(B||{});const Ri=class{static register(t,n){const i=n.create().getId();if(i!==t)throw new Error(`Registered factory ${B[i]} does not match type ${B[t]}`);Ri.FACTORIES.set(t,n)}isEnd(){return this.getId()===B.End}isByte(){return this.getId()===B.Byte}isShort(){return this.getId()===B.Short}isInt(){return this.getId()===B.Int}isLong(){return this.getId()===B.Long}isFloat(){return this.getId()===B.Float}isDouble(){return this.getId()===B.Double}isByteArray(){return this.getId()===B.ByteArray}isString(){return this.getId()===B.String}isList(){return this.getId()===B.List}isCompound(){return this.getId()===B.Compound}isIntArray(){return this.getId()===B.IntArray}isLongArray(){return this.getId()===B.LongArray}isNumber(){return this.isByte()||this.isShort()||this.isInt()||this.isLong()||this.isFloat()||this.isDouble()}isArray(){return this.isByteArray()||this.isIntArray()||this.isLongArray()}isListOrArray(){return this.isList()||this.isArray()}getAsNumber(){return 0}getAsString(){return""}toJsonWithId(){return{type:this.getId(),value:this.toJson()}}static getFactory(t){const n=this.FACTORIES.get(t);if(!n)throw new Error(`Invalid tag id ${t}`);return n}static create(t){return this.getFactory(t).create()}static fromString(t){const n=typeof t=="string"?new Ie(t):t;return this.getFactory(B.Compound).fromString(n)}static fromJson(t,n=B.Compound){return this.getFactory(n).fromJson(t)}static fromJsonWithId(t){var r,s,a;const n=(r=l.Json.readObject(t))!=null?r:{},i=(s=l.Json.readInt(n.type))!=null?s:0;return Ri.fromJson((a=n.value)!=null?a:{},i)}static fromBytes(t,n=B.Compound){return this.getFactory(n).fromBytes(t)}};let j=Ri;p(j,"FACTORIES",new Map);const Yt=class extends j{constructor(n){super();p(this,"value");this.value=typeof n=="number"?n:n?1:0}getId(){return B.Byte}getAsNumber(){return this.value}toString(){return this.value.toFixed()+"b"}toPrettyString(){return this.toString()}toSimplifiedJson(){return this.value}toJson(){return this.value}toBytes(n){n.writeByte(this.value)}static create(){return Yt.ZERO}static fromJson(n){var i;return new Yt((i=l.Json.readInt(n))!=null?i:0)}static fromBytes(n){const i=n.readByte();return new Yt(i)}};let Ke=Yt;p(Ke,"ZERO",new Yt(0)),p(Ke,"ONE",new Yt(1)),j.register(B.Byte,Ke);class Cn extends j{constructor(n){super();p(this,"items");this.items=n}getItems(){return this.items.slice(0)}getAsTuple(n,i){return[...Array(n)].map((r,s)=>i(this.items[s]))}get(n){if(n=Math.floor(n),!(n<0||n>=this.items.length))return this.items[n]}get length(){return this.items.length}map(n){return this.items.map(n)}filter(n){return this.items.filter(n)}forEach(n){this.items.forEach(n)}set(n,i){this.items[n]=i}add(n){this.items.push(n)}insert(n,i){this.items.splice(n,0,i)}delete(n){this.items.splice(n,1)}clear(){this.items=[]}}class wt extends Cn{constructor(t){super(Array.from(t!=null?t:[],n=>typeof n=="number"?new Ke(n):n))}getId(){return B.ByteArray}getType(){return B.Byte}toString(){return"[B;"+this.items.map(n=>n.getAsNumber().toFixed()+"B").join(",")+"]"}toPrettyString(){return this.toString()}toSimplifiedJson(){return this.items.map(t=>t.getAsNumber())}toJson(){return this.items.map(t=>t.getAsNumber())}toBytes(t){t.writeInt(this.items.length),t.writeBytes(this.items.map(n=>n.getAsNumber()))}static create(){return new wt([])}static fromJson(t){var i;const n=(i=l.Json.readArray(t,r=>{var s;return(s=l.Json.readNumber(r))!=null?s:0}))!=null?i:[];return new wt(n)}static fromBytes(t){const n=t.readInt(),i=t.readBytes(n);return new wt(i)}}j.register(B.ByteArray,wt);class zt extends j{constructor(n){super();p(this,"value");this.value=n}getId(){return B.Float}getAsNumber(){return this.value}toString(){return this.value.toString()+"f"}toPrettyString(){return this.toString()}toSimplifiedJson(){return this.value}toJson(){return this.value}toBytes(n){n.writeFloat(this.value)}static create(){return new zt(0)}static fromJson(n){var i;return new zt((i=l.Json.readNumber(n))!=null?i:0)}static fromBytes(n){const i=n.readFloat();return new zt(i)}}j.register(B.Float,zt);class it extends j{constructor(n){super();p(this,"value");this.value=n}getId(){return B.Int}getAsNumber(){return this.value}toString(){return this.value.toFixed()}toPrettyString(){return this.toString()}toSimplifiedJson(){return this.value}toJson(){return this.value}toBytes(n){n.writeInt(this.value)}static create(){return new it(0)}static fromJson(n){var i;return new it((i=l.Json.readInt(n))!=null?i:0)}static fromBytes(n){const i=n.readInt();return new it(i)}}j.register(B.Int,it);class pt extends Cn{constructor(t){super(Array.from(t!=null?t:[],n=>typeof n=="number"?new it(n):n))}getId(){return B.IntArray}getType(){return B.Int}get length(){return this.items.length}toString(){return"[I;"+this.items.map(n=>n.getAsNumber().toFixed()).join(",")+"]"}toPrettyString(){return this.toString()}toSimplifiedJson(){return this.items.map(t=>t.getAsNumber())}toJson(){return this.items.map(t=>t.getAsNumber())}toBytes(t){t.writeInt(this.items.length);for(const n of this.items)t.writeInt(n.getAsNumber())}static create(){return new pt}static fromJson(t){var i;const n=(i=l.Json.readArray(t,r=>{var s;return(s=l.Json.readNumber(r))!=null?s:0}))!=null?i:[];return new pt(n)}static fromBytes(t){const n=t.readInt(),i=[];for(let r=0;r<n;r+=1)i.push(t.readInt());return new pt(i)}}j.register(B.IntArray,pt);class De extends Cn{constructor(n,i){super(n!=null?n:[]);p(this,"type");this.type=this.items.length===0?B.End:i!=null?i:this.items[0].getId()}static make(n,i){return new De(i.map(r=>new n(r)))}getId(){return B.List}getType(){return this.type}getNumber(n){const i=this.get(n);return i!=null&&i.isNumber()?i.getAsNumber():0}getString(n){const i=this.get(n);return i!=null&&i.isString()?i.getAsString():""}getList(n,i){const r=this.get(n);return(r==null?void 0:r.isList())&&r.getType()===i?r:De.create()}getCompound(n){const i=this.get(n);return i!=null&&i.isCompound()?i:ue.create()}set(n,i){this.updateType(i),super.set(n,i)}add(n){this.updateType(n),super.add(n)}insert(n,i){this.updateType(i),super.insert(n,i)}updateType(n){if(n.getId()!==B.End){if(this.type===B.End)this.type=n.getId();else if(this.type!==n.getId())throw new Error(`Trying to add tag of type ${B[n.getId()]} to list of ${B[this.type]}`)}}clear(){super.clear(),this.type=B.End}toString(){return"["+this.items.map(n=>n.toString()).join(",")+"]"}toPrettyString(n="  ",i=0){if(this.length===0)return"[]";const r=n.repeat(i),s=n.repeat(i+1);return`[
`+this.map(a=>s+a.toPrettyString(n,i+1)).join(`,
`)+`
`+r+"]"}toSimplifiedJson(){return this.map(n=>n.toSimplifiedJson())}toJson(){return{type:this.type,items:this.items.map(n=>n.toJson())}}toBytes(n){this.items.length===0?this.type=B.End:this.type=this.items[0].getId(),n.writeByte(this.type),n.writeInt(this.items.length);for(const i of this.items)i.toBytes(n)}static create(){return new De}static fromJson(n){var a,o,u;const i=(a=l.Json.readObject(n))!=null?a:{},r=(o=l.Json.readNumber(i.type))!=null?o:B.Compound,s=((u=l.Json.readArray(i.items))!=null?u:[]).flatMap(c=>c!==void 0?[j.fromJson(c,r)]:[]);return new De(s,r)}static fromBytes(n){const i=n.readByte(),r=n.readInt();if(i===B.End&&r>0)throw new Error(`Missing type on ListTag but length is ${r}`);const s=[];for(let a=0;a<r;a+=1)s.push(j.fromBytes(n,i));return new De(s,i)}}j.register(B.List,De);const fe=class extends j{constructor(n){super();p(this,"value");this.value=fe.toPair(n)}static toPair(n){return Array.isArray(n)?n:fe.bigintToPair(n)}static bigintToPair(n){return fe.dataview.setBigInt64(0,n),[fe.dataview.getInt32(0),fe.dataview.getInt32(4)]}static pairToBigint(n){return fe.dataview.setInt32(0,Number(n[0])),fe.dataview.setInt32(4,Number(n[1])),fe.dataview.getBigInt64(0)}static pairToString(n){return fe.pairToBigint(n).toString()}static pairToNumber(n){return Number(fe.pairToBigint(n))}getId(){return B.Long}getAsNumber(){return fe.pairToNumber(this.value)}getAsPair(){return this.value}toBigInt(){return fe.pairToBigint(this.value)}toString(){return fe.pairToString(this.value)+"L"}toPrettyString(){return this.toString()}toSimplifiedJson(){return fe.pairToNumber(this.value)}toJson(){return this.value}toBytes(n){n.writeInt(this.value[0]),n.writeInt(this.value[1])}static create(){return new fe([0,0])}static fromJson(n){return new fe(Array.isArray(n)&&n.length===2?n.map(i=>typeof i=="number"?i:0):[0,0])}static fromBytes(n){const i=n.readInt(),r=n.readInt();return new fe([i,r])}};let Ht=fe;p(Ht,"dataview",new DataView(new Uint8Array(8).buffer)),j.register(B.Long,Ht);class St extends Cn{constructor(t){super(Array.from(t!=null?t:[],n=>typeof n=="bigint"||Array.isArray(n)?new Ht(n):n))}getId(){return B.LongArray}getType(){return B.Long}get length(){return this.items.length}toString(){return"[I;"+this.items.map(n=>n.toString()).join(",")+"]"}toPrettyString(){return this.toString()}toSimplifiedJson(){return this.items.map(t=>t.getAsPair())}toJson(){return this.items.map(t=>t.getAsPair())}toBytes(t){t.writeInt(this.items.length);for(const n of this.items){const[i,r]=n.getAsPair();t.writeInt(i),t.writeInt(r)}}static create(){return new St}static fromJson(t){var i;const n=(i=l.Json.readArray(t,r=>{var s;return(s=l.Json.readPair(r,a=>{var o;return(o=l.Json.readNumber(a))!=null?o:0}))!=null?s:[0,0]}))!=null?i:[];return new St(n)}static fromBytes(t){const n=t.readInt(),i=[];for(let r=0;r<n;r+=1)i.push([t.readInt(),t.readInt()]);return new St(i)}}j.register(B.LongArray,St);class Ft extends j{constructor(n){super();p(this,"value");this.value=n}getId(){return B.Short}getAsNumber(){return this.value}toString(){return this.value.toFixed()+"s"}toPrettyString(){return this.toString()}toSimplifiedJson(){return this.value}toJson(){return this.value}toBytes(n){n.writeShort(this.value)}static create(){return new Ft(0)}static fromJson(n){return new Ft(typeof n=="number"?Math.floor(n):0)}static fromBytes(n){const i=n.readShort();return new Ft(i)}}j.register(B.Short,Ft);const an=class extends j{constructor(n){super();p(this,"value");this.value=n}getId(){return B.String}getAsString(){return this.value}toString(){return'"'+this.value.replace(/(\\|")/g,"\\$1")+'"'}toPrettyString(){return this.toString()}toSimplifiedJson(){return this.value}toJson(){return this.value}toBytes(n){n.writeString(this.value)}static create(){return an.EMPTY}static fromJson(n){return new an(typeof n=="string"?n:"")}static fromBytes(n){const i=n.readString();return new an(i)}};let ke=an;p(ke,"EMPTY",new an("")),j.register(B.String,ke);var tr;(e=>{const t=new RegExp("^[-+]?(?:[0-9]+[.]|[0-9]*[.][0-9]+)(?:e[-+]?[0-9]+)?$","i"),n=new RegExp("^[-+]?(?:[0-9]+[.]?|[0-9]*[.][0-9]+)(?:e[-+]?[0-9]+)?d$","i"),i=new RegExp("^[-+]?(?:[0-9]+[.]?|[0-9]*[.][0-9]+)(?:e[-+]?[0-9]+)?f$","i"),r=new RegExp("^[-+]?(?:0|[1-9][0-9]*)b$","i"),s=new RegExp("^[-+]?(?:0|[1-9][0-9]*)l$","i"),a=new RegExp("^[-+]?(?:0|[1-9][0-9]*)s$","i"),o=new RegExp("^[-+]?(?:0|[1-9][0-9]*)$","i");function u(d){if(d.skipWhitespace(),!d.canRead())throw d.createError("Expected value");const E=d.peek();if(E==="{")return c(d);if(E==="[")if(d.canRead(3)&&!Ie.isQuotedStringStart(d.peek(1))&&d.peek(2)===";"){d.expect("[",!0);const b=d.cursor,_=d.read();if(d.skip(),d.skipWhitespace(),d.canRead()){if(_==="B")return f(d,wt,B.ByteArray,B.Byte);if(_==="L")return f(d,St,B.LongArray,B.Long);if(_==="I")return f(d,pt,B.IntArray,B.Int);throw d.cursor=b,d.createError(`Invalid array type '${_}'`)}else throw d.createError("Expected value")}else return h(d);else{d.skipWhitespace();const b=d.cursor;if(Ie.isQuotedStringStart(d.peek()))return new ke(d.readQuotedString());{const _=d.readUnquotedString();if(_.length===0)throw d.cursor=b,d.createError("Expected value");try{if(i.test(_)){const w=Number(_.substring(0,_.length-1));return new zt(w)}else if(r.test(_)){const w=Number(_.substring(0,_.length-1));return new Ke(Math.floor(w))}else if(s.test(_)){const w=BigInt(_.substring(0,_.length-1));return new Ht(w)}else if(a.test(_)){const w=Number(_.substring(0,_.length-1));return new Ft(Math.floor(w))}else if(o.test(_)){const w=Number(_);return new it(Math.floor(w))}else if(n.test(_)){const w=Number(_.substring(0,_.length-1));return new vt(w)}else if(t.test(_)){const w=Number(_);return new vt(w)}else{if(_.toLowerCase()==="true")return Ke.ONE;if(_.toLowerCase()==="false")return Ke.ZERO}}catch{}return _.length===0?ke.EMPTY:new ke(_)}}}e.readTag=u;function c(d){d.expect("{",!0);const E=new Map;for(d.skipWhitespace();d.canRead()&&d.peek()!=="}";){const b=d.cursor;if(d.skipWhitespace(),!d.canRead())throw d.createError("Expected key");const _=d.readString();if(_.length===0)throw d.cursor=b,d.createError("Expected key");d.expect(":",!0);const w=u(d);if(E.set(_,w),!g(d))break;if(!d.canRead())throw d.createError("Expected key")}return d.expect("}",!0),new ue(E)}function h(d){if(d.expect("[",!0),d.skipWhitespace(),!d.canRead())throw d.createError("Expected value");const E=[];let b=B.End;for(;d.peek()!=="]";){const _=d.cursor,w=u(d),A=w.getId();if(b===B.End)b=A;else if(A!==b)throw d.cursor=_,d.createError(`Can't insert ${B[A]} into list of ${B[b]}`);if(E.push(w),!g(d))break;if(!d.canRead())throw d.createError("Expected value")}return d.expect("]",!0),new De(E,b)}function f(d,E,b,_){const w=[];for(;d.peek()!=="]";){const A=u(d);if(A.getId()!==_)throw d.createError(`Can't insert ${B[A.getId()]} into ${B[b]}`);if(w.push(A.isLong()?A.getAsPair():A.getAsNumber()),!g(d))break;if(!d.canRead())throw d.createError("Expected value")}return d.expect("]"),new E(w)}function g(d){return d.skipWhitespace(),d.canRead()&&d.peek()===","?(d.skip(),d.skipWhitespace(),!0):!1}})(tr||(tr={}));class ue extends j{constructor(n){super();p(this,"properties");this.properties=n!=null?n:new Map}getId(){return B.Compound}has(n){return this.properties.has(n)}hasNumber(n){var i,r;return(r=(i=this.get(n))==null?void 0:i.isNumber())!=null?r:!1}hasString(n){var i,r;return(r=(i=this.get(n))==null?void 0:i.isString())!=null?r:!1}hasList(n,i,r){var a;const s=this.get(n);return(a=(s==null?void 0:s.isList())&&(i===void 0||s.getType()===i)&&(r===void 0||s.length===r))!=null?a:!1}hasCompound(n){var i,r;return(r=(i=this.get(n))==null?void 0:i.isCompound())!=null?r:!1}get(n){return this.properties.get(n)}getString(n){var i,r;return(r=(i=this.get(n))==null?void 0:i.getAsString())!=null?r:""}getNumber(n){var i,r;return(r=(i=this.get(n))==null?void 0:i.getAsNumber())!=null?r:0}getBoolean(n){return this.getNumber(n)!==0}getList(n,i){const r=this.get(n);return(r==null?void 0:r.isList())&&(i===void 0||r.getType()===i)?r:De.create()}getCompound(n){const i=this.get(n);return i!=null&&i.isCompound()?i:ue.create()}getByteArray(n){const i=this.get(n);return i!=null&&i.isByteArray()?i:wt.create()}getIntArray(n){const i=this.get(n);return i!=null&&i.isIntArray()?i:pt.create()}getLongArray(n){const i=this.get(n);return i!=null&&i.isLongArray()?i:St.create()}keys(){return this.properties.keys()}get size(){return this.properties.size}map(n){return Object.fromEntries([...this.properties.entries()].map(([i,r])=>n(i,r,this)))}forEach(n){[...this.properties.entries()].forEach(([i,r])=>n(i,r,this))}set(n,i){return this.properties.set(n,i),this}delete(n){return this.properties.delete(n)}clear(){return this.properties.clear(),this}toString(){const n=[];for(const[i,r]of this.properties.entries()){const s=i.split("").some(a=>!Ie.isAllowedInUnquotedString(a));n.push((s?JSON.stringify(i):i)+":"+r.toString())}return"{"+n.join(",")+"}"}toPrettyString(n="  ",i=0){if(this.size===0)return"{}";const r=n.repeat(i),s=n.repeat(i+1);return`{
`+Object.values(this.map((a,o)=>[a,s+a+": "+o.toPrettyString(n,i+1)])).join(`,
`)+`
`+r+"}"}toSimplifiedJson(){return this.map((n,i)=>[n,i.toSimplifiedJson()])}toJson(){return this.map((n,i)=>[n,{type:i.getId(),value:i.toJson()}])}toBytes(n){for(const[i,r]of this.properties.entries()){const s=r.getId();n.writeByte(s),n.writeString(i),r.toBytes(n)}n.writeByte(B.End)}static create(){return new ue}static fromString(n){return tr.readTag(n)}static fromJson(n){const i=l.Json.readMap(n,r=>{var c;const{type:s,value:a}=(c=l.Json.readObject(r))!=null?c:{},o=l.Json.readNumber(s);return j.fromJson(a!=null?a:{},o)});return new ue(new Map(Object.entries(i)))}static fromBytes(n){const i=new Map;for(;;){const r=n.readByte();if(r===B.End)break;const s=n.readString(),a=j.fromBytes(n,r);i.set(s,a)}return new ue(i)}}j.register(B.Compound,ue);const kt=class{constructor(t,n,i,r,s){this.name=t,this.root=n,this.compression=i,this.littleEndian=r,this.bedrockHeader=s}writeNamedTag(t){t.writeByte(B.Compound),t.writeString(this.name),this.root.toBytes(t)}write(){const t=this.littleEndian===!0||this.bedrockHeader!==void 0,n=new pr({littleEndian:t,offset:this.bedrockHeader&&8});if(this.writeNamedTag(n),this.bedrockHeader!==void 0){const r=n.offset;n.offset=0,n.writeInt(this.bedrockHeader),n.writeInt(r-8),n.offset=r}const i=n.getData();return this.compression==="gzip"?er.gzip(i):this.compression==="zlib"?er.deflate(i):i}static readNamedTag(t){if(t.readByte()!==B.Compound)throw new Error("Top tag should be a compound");return{name:t.readString(),root:ue.fromBytes(t)}}static create(t={}){var o,u,c;const n=(o=t.name)!=null?o:kt.DEFAULT_NAME,i=ue.create(),r=(u=t.compression)!=null?u:"none",s=typeof t.bedrockHeader=="boolean"?kt.DEFAULT_BEDROCK_HEADER:t.bedrockHeader,a=(c=t.littleEndian)!=null?c:t.bedrockHeader!==void 0;return new kt(n,i,r,a,s)}static read(t,n={}){var g;const i=typeof n.bedrockHeader!="number"?void 0:Ea(t),r=n.compression==="gzip"||!i&&n.compression===void 0&&ye(t),s=n.compression==="zlib"||!i&&n.compression===void 0&&It(t),a=s||r?er.inflate(t):t,o=n.littleEndian||i!==void 0,u=r?"gzip":s?"zlib":"none",c=new wr(a,{littleEndian:o,offset:i&&8}),{name:h,root:f}=kt.readNamedTag(c);return new kt((g=n.name)!=null?g:h,f,u,o,i)}toJson(){var t;return{name:this.name,root:this.root.toJson(),compression:this.compression,littleEndian:this.littleEndian,bedrockHeader:(t=this.bedrockHeader)!=null?t:null}}static fromJson(t){var u,c,h,f,g;const n=(u=l.Json.readObject(t))!=null?u:{},i=(c=l.Json.readString(n.name))!=null?c:"",r=ue.fromJson((h=n.root)!=null?h:{}),s=(f=l.Json.readString(n.compression))!=null?f:"none",a=(g=l.Json.readBoolean(n.littleEndian))!=null?g:!1,o=l.Json.readNumber(n.bedrockHeader);return new kt(i,r,s,a,o)}};let qe=kt;p(qe,"DEFAULT_NAME",""),p(qe,"DEFAULT_BEDROCK_HEADER",4);class rt{constructor(t,n,i,r,s){p(this,"file");p(this,"dirty");this.x=t,this.z=n,this.compression=i,this.timestamp=r,this.raw=s,this.dirty=!1}getCompression(){switch(this.compression){case 1:return"gzip";case 2:return"zlib";case 3:return"none";default:throw new Error(`Invalid compression mode ${this.compression}`)}}setCompression(t){switch(t){case"gzip":this.compression=1;break;case"zlib":this.compression=2;break;case"none":this.compression=3;break;default:throw new Error(`Invalid compression mode ${t}`)}}getFile(){return this.file===void 0&&(this.file=qe.read(this.raw,{compression:this.getCompression()})),this.file}getRoot(){return this.getFile().root}setRoot(t){this.file===void 0&&(this.file=qe.create({compression:this.getCompression()})),this.file.root=t,this.markDirty()}markDirty(){this.dirty=!0}getRaw(){if(this.file===void 0||this.dirty===!1)return this.raw;this.file.compression=this.getCompression();const t=this.file.write();return this.raw=t,this.dirty=!1,t}toJson(){return{x:this.x,z:this.z,compression:this.compression,timestamp:this.timestamp,size:this.raw.byteLength}}toRef(t){return new rt.Ref(this.x,this.z,this.compression,this.timestamp,this.raw.byteLength,t)}static create(t,n,i,r){const s=new rt(t,n,0,r!=null?r:0,i.write());return s.setCompression(i.compression),s}static fromJson(t,n){var c,h,f,g,d,E;const i=(c=l.Json.readObject(t))!=null?c:{},r=(h=l.Json.readInt(i.x))!=null?h:0,s=(f=l.Json.readInt(i.z))!=null?f:0,a=(g=l.Json.readNumber(i.compression))!=null?g:2,o=(d=l.Json.readInt(i.timestamp))!=null?d:0,u=(E=l.Json.readInt(i.size))!=null?E:0;return new rt.Ref(r,s,a,o,u,n)}}(e=>{class t{constructor(i,r,s,a,o,u){p(this,"file");this.x=i,this.z=r,this.compression=s,this.timestamp=a,this.size=o,this.resolver=u}getFile(){if(this.file instanceof qe)return this.file}getRoot(){if(this.file instanceof qe)return this.file.root}async getFileAsync(){return this.file?this.file:(this.file=(async()=>{const i=await this.resolver(this.x,this.z);return this.file=i,i})(),this.file)}async getRootAsync(){return(await this.getFileAsync()).root}isResolved(){return this.file instanceof qe}}e.Ref=t})(rt||(rt={}));class Hs{constructor(t){p(this,"chunks");this.chunks=Array(32*32).fill(void 0);for(const n of t){const i=bt.getIndex(n.x,n.z);this.chunks[i]=n}}getChunkPositions(){return this.chunks.flatMap(t=>t?[[t.x,t.z]]:[])}getChunk(t){if(!(t<0||t>=32*32))return this.chunks[t]}findChunk(t,n){return this.getChunk(bt.getIndex(t,n))}getFirstChunk(){return this.chunks.filter(t=>t!==void 0)[0]}filter(t){return this.chunks.filter(n=>n!==void 0&&t(n))}map(t){return this.chunks.flatMap(n=>n!==void 0?[t(n)]:[])}}class bt extends Hs{constructor(t){super(t)}write(){let t=0;for(const s of this.chunks)s!==void 0&&(t+=Math.ceil(s.getRaw().length/4096));const n=new Uint8Array(8192+t*4096),i=new DataView(n.buffer);let r=2;for(const s of this.chunks){if(s===void 0)continue;const a=s.getRaw(),o=4*((s.x&31)+(s.z&31)*32),u=Math.ceil(a.length/4096);i.setInt8(o,r>>16),i.setInt16(o+1,r&65535),i.setInt8(o+3,u),i.setInt32(o+4096,s.timestamp);const c=r*4096;i.setInt32(c,a.length+1),i.setInt8(c+4,s.compression),n.set(a,c+5),r+=u}return n}static read(t){const n=[];for(let i=0;i<32;i+=1)for(let r=0;r<32;r+=1){const s=4*((i&31)+(r&31)*32);if(t[s+3]===0)continue;const o=(t[s]<<16)+(t[s+1]<<8)+t[s+2],u=(t[s+4096]<<24)+(t[s+4097]<<16)+(t[s+4098]<<8)+t[s+4099],c=o*4096,h=(t[c]<<24)+(t[c+1]<<16)+(t[c+2]<<8)+t[c+3],f=t[c+4],g=t.slice(c+5,c+4+h);n.push(new rt(i,r,f,u,g))}return new bt(n)}static getIndex(t,n){return(t&31)+(n&31)*32}toJson(){return{chunks:this.map(t=>t.toJson())}}static fromJson(t,n){var a,o;const i=(a=l.Json.readObject(t))!=null?a:{},s=((o=l.Json.readArray(i.chunks))!=null?o:[]).flatMap(u=>u!==void 0?[rt.fromJson(u,n)]:[]);return new bt.Ref(s)}}(e=>{class t extends Hs{}e.Ref=t})(bt||(bt={}));class vt extends j{constructor(n){super();p(this,"value");this.value=n}getId(){return B.Double}getAsNumber(){return this.value}toString(){return Number.isInteger(this.value)?this.value.toFixed(1):this.value.toString()}toPrettyString(){return this.toString()}toSimplifiedJson(){return this.value}toJson(){return this.value}toBytes(n){n.writeDouble(this.value)}static create(){return new vt(0)}static fromJson(n){var i;return new vt((i=l.Json.readNumber(n))!=null?i:0)}static fromBytes(n){const i=n.readDouble();return new vt(i)}}j.register(B.Double,vt);const on=class extends j{constructor(){super()}getId(){return B.End}toString(){return"END"}toPrettyString(){return this.toString()}toSimplifiedJson(){return null}toJson(){return null}toBytes(){}static create(){return on.INSTANCE}static fromJson(){return on.INSTANCE}static fromBytes(){return on.INSTANCE}};let Mn=on;p(Mn,"INSTANCE",new on),j.register(B.End,Mn),l.Direction=(e=>(e.UP="up",e.DOWN="down",e.NORTH="north",e.EAST="east",e.SOUTH="south",e.WEST="west",e))(l.Direction||{});const ml={up:[0,1,0],down:[0,-1,0],north:[0,0,-1],east:[1,0,0],south:[0,0,1],west:[-1,0,0]};(e=>{e.ALL=["up","down","north","east","south","west"];function t(n){return ml[n]}e.normal=t})(l.Direction||(l.Direction={})),l.BlockPos=void 0,(e=>{function t(f,g,d){return[f,g,d]}e.create=t,e.ZERO=e.create(0,0,0);function n(f,g,d,E){return[f[0]+g,f[1]+d,f[2]+E]}e.offset=n;function i(f,g){return[f[0]-g[0],f[1]-g[1],f[2]-g[2]]}e.subtract=i;function r(f,g){return[f[0]+g[0],f[1]+g[1],f[2]+g[2]]}e.add=r;function s(f,g){return e.offset(f,...l.Direction.normal(g))}e.towards=s;function a(f,g){return f===g?!0:f[0]===g[0]&&f[1]===g[1]&&f[2]===g[2]}e.equals=a;function o(f){return f[0]*f[0]+f[1]*f[1]+f[2]*f[2]}e.magnitude=o;function u(f){return new De(f.map(g=>new it(g)))}e.toNbt=u;function c(f){return f.getAsTuple(3,g=>g!=null&&g.isInt()?g.getAsNumber():0)}e.fromNbt=c;function h(f){var d;const g=(d=l.Json.readArray(f,E=>{var b;return(b=l.Json.readInt(E))!=null?b:0}))!=null?d:[0,0,0];return t(g[0],g[1],g[2])}e.fromJson=h})(l.BlockPos||(l.BlockPos={}));const je=class{constructor(t,n){if(this.namespace=t,this.path=n,!t.match(/^[a-z0-9._-]*$/))throw new Error(`Non [a-z0-9._-] character in namespace of ${t}${je.SEPARATOR}${n}`);if(!n.match(/^[a-z0-9/._-]*$/))throw new Error(`Non [a-z0-9/._-] character in path of ${t}${je.SEPARATOR}${n}`)}equals(t){return this===t?!0:t instanceof je?this.namespace===t.namespace&&this.path===t.path:!1}toString(){return this.namespace+je.SEPARATOR+this.path}withPrefix(t){return new je(this.namespace,t+this.path)}static create(t){return new je(this.DEFAULT_NAMESPACE,t)}static parse(t){const n=t.indexOf(this.SEPARATOR);if(n>=0){const i=n>=1?t.substring(0,n):this.DEFAULT_NAMESPACE,r=t.substring(n+1);return new je(i,r)}return new je(this.DEFAULT_NAMESPACE,t)}};let G=je;p(G,"DEFAULT_NAMESPACE","minecraft"),p(G,"SEPARATOR",":");const Je=class{constructor(t,n={}){p(this,"name");this.properties=n,this.name=typeof t=="string"?G.parse(t):t}getName(){return this.name}getProperties(){return this.properties}getProperty(t){return this.properties[t]}isFluid(){return this.is(Je.WATER)||this.is(Je.LAVA)}equals(t){return this.name.equals(t.name)?Object.keys(this.properties).every(n=>t.properties[n]===this.properties[n]):!1}is(t){return this.name.equals(t.name)}toString(){return Object.keys(this.properties).length===0?this.name.toString():`${this.name.toString()}[${Object.entries(this.properties).map(([t,n])=>t+"="+n).join(",")}]`}static fromNbt(t){const n=G.parse(t.getString("Name")),i=t.getCompound("Properties").map((r,s)=>[r,s.getAsString()]);return new Je(n,i)}static fromJson(t){var s,a;const n=(s=l.Json.readObject(t))!=null?s:{},i=G.parse((a=l.Json.readString(n.Name))!=null?a:Je.STONE.name.toString()),r=l.Json.readMap(n.Properties,o=>{var u;return(u=l.Json.readString(o))!=null?u:""});return new Je(i,r)}};let $=Je;p($,"AIR",new Je(G.create("air"))),p($,"STONE",new Je(G.create("stone"))),p($,"WATER",new Je(G.create("water"),{level:"0"})),p($,"LAVA",new Je(G.create("lava"),{level:"0"}));class Fs{constructor(t,n){p(this,"storage");p(this,"palette");this.size=t,this.defaultValue=n,this.storage=Array(t).fill(0),this.palette=[n]}index(t,n,i){return(t<<8)+(n<<4)+i}get(t,n,i){const r=this.storage[this.index(t,n,i)];return this.palette[r]}set(t,n,i,r){let s=this.palette.findIndex(a=>a.equals(r));s===-1&&(s=this.palette.length,this.palette.push(r)),this.storage[this.index(t,n,i)]=s}}const cn=class{constructor(t){p(this,"states");this.minY=t,this.states=new Fs(cn.SIZE,$.AIR)}get minBlockY(){return this.minY<<4}getBlockState(t,n,i){return this.states.get(t,n,i)}setBlockState(t,n,i,r){this.states.set(t,n,i,r)}};let tn=cn;p(tn,"WIDTH",16),p(tn,"SIZE",cn.WIDTH*cn.WIDTH*cn.WIDTH);class El{constructor(t,n,i){p(this,"sections");this.minY=t,this.height=n,this.pos=i,this.sections=Array(this.sectionsCount).fill(null)}get maxY(){return this.minY+this.height}get minSection(){return this.minY>>4}get maxSection(){return(this.maxY-1>>4)+1}get sectionsCount(){return this.maxSection-this.minSection}getSectionIndex(t){return(t>>4)-this.minSection}getBlockState(t){var a;const[n,i,r]=t,s=this.sections[this.getSectionIndex(i)];return(a=s==null?void 0:s.getBlockState(n&15,i&15,r&15))!=null?a:$.AIR}setBlockState(t,n){const[i,r,s]=t,a=this.getSectionIndex(r);let o=this.sections[a];if(o===null){if(n.equals($.AIR))return;o=this.getOrCreateSection(a)}o.setBlockState(i&15,r&15,s&15,n)}getOrCreateSection(t){return this.sections[t]==null&&(this.sections[t]=new tn(this.minSection+t)),this.sections[t]}}l.ChunkPos=void 0,(e=>{function t(h,f){return[h,f]}e.create=t;function n(h){return[h[0]>>4,h[2]>>4]}e.fromBlockPos=n;function i(h){return[Number(h)&4294967295,Number(h>>BigInt(32))]}e.fromLong=i;function r(h){return s(h[0],h[1])}e.toLong=r;function s(h,f){return BigInt(h&4294967295)|BigInt(f&4294967295)<<BigInt(32)}e.asLong=s;function a(h){return h[0]<<4}e.minBlockX=a;function o(h){return h[1]<<4}e.minBlockZ=o;function u(h){return(h[0]<<4)+15}e.maxBlockX=u;function c(h){return(h[1]<<4)+15}e.maxBlockZ=c})(l.ChunkPos||(l.ChunkPos={})),l.Holder=void 0,(e=>{function t(r,s){return a=>typeof a=="string"?i(r,G.parse(a)):n(s(a))}e.parser=t;function n(r,s){return{value:()=>r,key:()=>s}}e.direct=n;function i(r,s,a=!0){return a?{value:()=>r.getOrThrow(s),key:()=>s}:{value:()=>r.get(s),key:()=>s}}e.reference=i})(l.Holder||(l.Holder={}));class At{constructor(t){this.entries=t}static parser(t,n){const i=n!=null?n:r=>{var s;return l.Holder.reference(t,G.parse((s=l.Json.readString(r))!=null?s:""))};return r=>{var s,a;return typeof r=="string"?r.startsWith("#")?l.Holder.reference(t.getTagRegistry(),G.parse(r.substring(1))):l.Holder.direct(new At([])):l.Holder.direct((a=new At((s=l.Json.readArray(r,i))!=null?s:[]))!=null?a:[])}}static fromJson(t,n,i){var o,u,c;const r=(o=l.Json.readObject(n))!=null?o:{},s=(u=l.Json.readBoolean(r.replace))!=null?u:!1,a=(c=l.Json.readArray(r.values,h=>{var d,E,b;var f=!0,g="";if(typeof h=="string")g=h;else{const _=(d=l.Json.readObject(h))!=null?d:{};f=(E=l.Json.readBoolean(_.required))!=null?E:!1,g=(b=l.Json.readString(_.id))!=null?b:""}return g.startsWith("#")?l.Holder.reference(t.getTagRegistry(),G.parse(g.substring(1)),f):l.Holder.reference(t,G.parse(g),f)}))!=null?c:[];return i&&!s&&t.getTagRegistry().has(i)&&(a==null||a.push(l.Holder.direct(t.getTagRegistry().get(i)))),new At(a)}*getEntries(){for(const t of this.entries){const n=t.value();n!==void 0&&(n instanceof At?yield*n.getEntries():yield t)}}}const $t=class{constructor(t,n){p(this,"storage",new Map);p(this,"builtin",new Map);p(this,"tags");this.key=t,this.parser=n}static createAndRegister(t,n){const i=new $t(G.create(t),n);return $t.REGISTRY.register(i.key,i),i}register(t,n,i){return this.storage.set(t.toString(),n),i&&this.builtin.set(t.toString(),n),l.Holder.reference(this,t)}delete(t){const n=this.storage.delete(t.toString());return this.builtin.delete(t.toString()),n}keys(){return[...this.storage.keys()].map(t=>G.parse(t))}has(t){return this.storage.has(t.toString())}get(t){var n=this.storage.get(t.toString());return n instanceof Function&&(n=n(),this.storage.set(t.toString(),n)),n}getOrThrow(t){const n=this.get(t);if(n===void 0)throw new Error(`Missing key in ${this.key.toString()}: ${t.toString()}`);return n}parse(t){if(!this.parser)throw new Error(`No parser exists for ${this.key.toString()}`);return this.parser(t)}clear(){this.storage.clear();for(const[t,n]of this.builtin.entries())this.storage.set(t,n);return this.tags&&this.tags.clear(),this}assign(t){if(!this.key.equals(t.key))throw new Error(`Cannot assign registry of type ${t.key.toString()} to registry of type ${this.key.toString()}`);for(const n of t.keys())this.storage.set(n.toString(),t.getOrThrow(n));return this}cloneEmpty(){return new $t(this.key,this.parser)}forEach(t){for(const[n,i]of this.storage.entries())t(G.parse(n),i instanceof Function?i():i,this)}map(t){return[...this.storage.entries()].map(([n,i])=>t(G.parse(n),i instanceof Function?i():i,this))}getTagRegistry(){return this.tags===void 0&&(this.tags=new $t(new G(this.key.namespace,`tags/${this.key.path}`))),this.tags}};let oe=$t;p(oe,"REGISTRY",new $t(G.create("root")));const oi=new oe(G.create("attribute"));oe.REGISTRY.register(oi.key,oi),l.Attribute=void 0,(e=>{e.REGISTRY=oi})(l.Attribute||(l.Attribute={}));function Re(e,t,n,i){const r={id:G.create(e),defaultValue:t,minValue:n,maxValue:i};return oi.register(r.id,r,!0),r}l.Attributes=void 0,(e=>{e.MAX_HEALTH=Re("generic.max_health",20,1,1024),e.FOLLOW_RANGE=Re("generic.follow_range",32,0,2048),e.KNOCKBACK_RESISTANCE=Re("generic.knockback_resistance",0,0,1),e.MOVEMENT_SPEED=Re("generic.movement_speed",.7,0,1024),e.FLYING_SPEED=Re("generic.flying_speed",.4,0,1024),e.ATTACK_DAMAGE=Re("generic.attack_damage",2,0,2048),e.ATTACK_KNOCKBACK=Re("generic.attack_knockback",0,0,5),e.ATTACK_SPEED=Re("generic.attack_speed",4,0,1024),e.ARMOR=Re("generic.armor",0,0,30),e.ARMOR_TOUGHNESS=Re("generic.armor_toughness",0,0,20),e.LUCK=Re("generic.luck",0,-1024,1024),e.SPAWN_REINFORCEMENTS=Re("zombie.spawn_reinforcements",0,0,1),e.JUMP_STRENGTH=Re("generic.jump_strength",.7,0,2)})(l.Attributes||(l.Attributes={}));var xe=(e=>(e[e.addition=0]="addition",e[e.multiply_base=1]="multiply_base",e[e.multiply_total=2]="multiply_total",e))(xe||{});const ci=new oe(G.create("mob_effect"));oe.REGISTRY.register(ci.key,ci);const Js=new Map;l.MobEffect=void 0,(e=>{e.REGISTRY=ci;function t(n){return Js.get(n)}e.fromId=t})(l.MobEffect||(l.MobEffect={}));function q(e,t,n,i,r=new Map){const s={index:e,id:G.create(t),category:n,color:typeof i=="number"?Ee(i):i,modifiers:r};return Js.set(e,s),ci.register(s.id,s,!0),s}l.MobEffects=void 0,(e=>{e.SPEED=q(1,"speed","beneficial",8171462,new Map([[l.Attributes.MOVEMENT_SPEED,{amount:.2,operation:xe.multiply_total}]])),e.SLOWNESS=q(2,"slowness","harmful",5926017,new Map([[l.Attributes.MOVEMENT_SPEED,{amount:-.15,operation:xe.multiply_total}]])),e.HASTE=q(3,"haste","beneficial",14270531,new Map([[l.Attributes.ATTACK_SPEED,{amount:.1,operation:xe.multiply_total}]])),e.MINING_FATIGUE=q(4,"mining_fatigue","harmful",4866583,new Map([[l.Attributes.ATTACK_SPEED,{amount:-.1,operation:xe.multiply_total}]])),e.STRENGTH=q(5,"strength","beneficial",9643043,new Map([[l.Attributes.ATTACK_DAMAGE,{amount:3,operation:xe.addition}]])),e.INSTANT_HEALTH=q(6,"instant_health","beneficial",16262179),e.INSTANT_DAMAGE=q(7,"instant_damage","harmful",4393481),e.JUMP_BOOST=q(8,"jump_boost","beneficial",2293580),e.NAUSEA=q(9,"nausea","harmful",5578058),e.REGENERATION=q(10,"regeneration","beneficial",13458603),e.RESISTANCE=q(11,"resistance","beneficial",10044730),e.FIRE_RESISTANCE=q(12,"fire_resistance","beneficial",14981690),e.WATER_BREATHING=q(13,"water_breathing","beneficial",3035801),e.INVISIBILITY=q(14,"invisibility","beneficial",8356754),e.BLINDNESS=q(15,"blindness","harmful",2039587),e.NIGHT_VISION=q(16,"night_vision","beneficial",2039713),e.HUNGER=q(17,"hunger","harmful",5797459),e.WEAKNESS=q(18,"weakness","harmful",4738376,new Map([[l.Attributes.ATTACK_DAMAGE,{amount:-4,operation:xe.addition}]])),e.POISON=q(19,"poison","harmful",5149489),e.WITHER=q(20,"wither","harmful",3484199),e.HEALTH_BOOST=q(21,"health_boost","beneficial",16284963,new Map([[l.Attributes.MAX_HEALTH,{amount:4,operation:xe.addition}]])),e.ABSORPTION=q(22,"absorption","beneficial",2445989),e.SATURATION=q(23,"saturation","beneficial",16262179),e.GLOWING=q(24,"glowing","neutral",9740385),e.LEVITATION=q(25,"levitation","harmful",13565951),e.LUCK=q(26,"luck","beneficial",3381504,new Map([[l.Attributes.LUCK,{amount:1,operation:xe.addition}]])),e.UNLUCK=q(27,"unluck","harmful",12624973,new Map([[l.Attributes.LUCK,{amount:-1,operation:xe.addition}]])),e.SLOW_FALLING=q(28,"slow_falling","beneficial",16773073),e.CONDUIT_POWER=q(29,"conduit_power","beneficial",1950417),e.DOLPHINS_GRACE=q(30,"dolphins_grace","beneficial",8954814),e.BAD_OMEN=q(31,"bad_omen","neutral",745784),e.HERO_OF_THE_VILLAGE=q(32,"hero_of_the_village","beneficial",4521796),e.DARKNESS=q(33,"darkness","harmful",2696993)})(l.MobEffects||(l.MobEffects={})),l.MobEffectInstance=void 0,(e=>{function t(s,a=0,o=0,u=!1,c=!0,h){return{effect:s,duration:a,amplifier:o,ambient:u,visible:c,showIcon:h!=null?h:c}}e.create=t;function n(s){const a=s.getNumber("Id"),o=l.MobEffect.fromId(a);if(o===void 0)return;const u=s.getNumber("Amplifier"),c=s.getNumber("Duration"),h=s.getBoolean("Ambient"),f=!s.has("ShowParticles")||s.getBoolean("ShowParticles"),g=s.has("ShowIcon")?f:s.getBoolean("ShowIcon");return{effect:o,duration:c,amplifier:u,ambient:h,visible:f,showIcon:g}}e.fromNbt=n;function i(s){let[a,o,u]=[0,0,0],c=0;for(const h of s){const f=h.amplifier+1,g=h.effect.color;g!==void 0&&(a+=f*g[0],o+=f*g[1],u+=f*g[2],c+=f)}return c===0?Ee(0):(a=a/c,o=o/c,u=u/c,[a,o,u])}e.getColor=i;function r(s){const a=Math.floor(s.duration);let o=Math.floor(a/20),u=Math.floor(o/60);o%=60;const c=Math.floor(u/60);return u%=60,`${c>0?`${c}:`:""}${u.toFixed().padStart(2,"0")}:${o.toFixed().padStart(2,"0")}`}e.formatDuration=r})(l.MobEffectInstance||(l.MobEffectInstance={}));const wl={mainhand:0,offhand:1,feet:0,legs:1,chest:2,head:3},Ln=new oe(G.create("item"));oe.REGISTRY.register(Ln.key,Ln),l.Item=void 0,(e=>{e.REGISTRY=Ln;function t(n){const i=typeof n=="string"?G.parse(n):n,r=Ln.get(i);return r!=null?r:{id:i,rarity:"common",stack:64}}e.get=t})(l.Item||(l.Item={}));function m(e,t){const n={id:G.create(e),rarity:"common",stack:64,...t,...(t==null?void 0:t.vanishable)||(t==null?void 0:t.wearable)?{vanishable:!0}:{}};return Ln.register(n.id,n,!0),n}function P(e,t,n){return{spawnEgg:{entityType:e,background:t,highlight:n}}}function Z(e,t,n){return{food:{nutrition:e,saturationModifier:t,isMeat:!1,canAlwaysEat:!1,fastFood:!1,effects:[],...n}}}const pl={leather:[5,[1,2,3,1],15,0,0],chainmail:[15,[1,4,5,2],12,0,0],iron:[15,[2,5,6,2],12,0,0],gold:[7,[1,3,5,2],25,0,0],diamond:[33,[3,6,8,3],9,2,0],turtle:[25,[2,5,6,2],9,0,0],netherite:[37,[3,6,8,3],15,3,.1]};function re(e,t){const[n,i,r,s,a]=pl[t],o=wl[e];return{stack:1,durability:[13,15,16,11][o]*n,enchantmentValue:r,...t==="netherite"?{fireResistant:!0}:{},wearable:!0,armor:{slot:e,material:t,defense:i[o],toughness:s,knockbackResistance:a}}}const Sl={wood:[0,59,2,0,15],stone:[1,131,4,1,5],iron:[2,250,6,2,14],diamond:[3,1561,8,3,10],gold:[0,32,12,0,22],netherite:[4,2031,9,4,15]};function ee(e,t){const[n,i,r,s,a]=Sl[e];return{durability:i,enchantmentValue:a,...e==="netherite"?{fireResistant:!0}:{},tiered:{tier:e,level:n,speed:r,damage:s,isWeapon:t==="weapon",isDigger:t==="digger"||t==="axe",isAxe:t==="axe"}}}l.Items=void 0,(e=>{e.AIR=m("air"),e.CARVED_PUMPKIN=m("carved_pumpkin",{wearable:!0}),e.SADDLE=m("saddle",{stack:1}),e.MINECART=m("minecart",{stack:1}),e.CHEST_MINECART=m("chest_minecart",{stack:1}),e.FURNACE_MINECART=m("furnace_minecart",{stack:1}),e.TNT_MINECART=m("tnt_minecart",{stack:1}),e.HOPPER_MINECART=m("hopper_minecart",{stack:1}),e.CARROT_ON_A_STICK=m("carrot_on_a_stick",{stack:1,durability:25}),e.WARPED_FUNGUS_ON_A_STICK=m("warped_fungus_on_a_stick",{stack:1,durability:100}),e.ELYTRA=m("elytra",{rarity:"uncommon",stack:1,durability:432,wearable:!0}),e.OAK_BOAT=m("oak_boat",{stack:1}),e.OAK_CHEST_BOAT=m("oak_chest_boat",{stack:1}),e.SPRUCE_BOAT=m("spruce_boat",{stack:1}),e.SPRUCE_CHEST_BOAT=m("spruce_chest_boat",{stack:1}),e.BIRCH_BOAT=m("birch_boat",{stack:1}),e.BIRCH_CHEST_BOAT=m("birch_chest_boat",{stack:1}),e.JUNGLE_BOAT=m("jungle_boat",{stack:1}),e.JUNGLE_CHEST_BOAT=m("jungle_chest_boat",{stack:1}),e.ACACIA_BOAT=m("acacia_boat",{stack:1}),e.ACACIA_CHEST_BOAT=m("acacia_chest_boat",{stack:1}),e.DARK_OAK_BOAT=m("dark_oak_boat",{stack:1}),e.DARK_OAK_CHEST_BOAT=m("dark_oak_chest_boat",{stack:1}),e.MANGROVE_BOAT=m("mangrove_boat",{stack:1}),e.MANGROVE_CHEST_BOAT=m("mangrove_chest_boat",{stack:1}),e.BAMBOO_RAFT=m("bamboo_raft",{stack:1}),e.BAMBOO_CHEST_RAFT=m("bamboo_chest_raft",{stack:1}),e.STRUCTURE_BLOCK=m("structure_block",{rarity:"epic"}),e.JIGSAW=m("jigsaw",{rarity:"epic"}),e.TURTLE_HELMET=m("turtle_helmet",re("head","turtle")),e.FLINT_AND_STEEL=m("flint_and_steel",{stack:1,durability:64}),e.APPLE=m("apple",Z(4,.3)),e.BOW=m("bow",{stack:1,durability:384,enchantmentValue:1}),e.NETHERITE_INGOT=m("netherite_ingot",{fireResistant:!0}),e.NETHERITE_SCRAP=m("netherite_scrap",{fireResistant:!0}),e.WOODEN_SWORD=m("wooden_sword",ee("wood","weapon")),e.WOODEN_SHOVEL=m("wooden_shovel",ee("wood","digger")),e.WOODEN_PICKAXE=m("wooden_pickaxe",ee("wood","digger")),e.WOODEN_AXE=m("wooden_axe",ee("wood","axe")),e.WOODEN_HOE=m("wooden_hoe",ee("wood","digger")),e.STONE_SWORD=m("stone_sword",ee("stone","weapon")),e.STONE_SHOVEL=m("stone_shovel",ee("stone","digger")),e.STONE_PICKAXE=m("stone_pickaxe",ee("stone","digger")),e.STONE_AXE=m("stone_axe",ee("stone","axe")),e.STONE_HOE=m("stone_hoe",ee("stone","digger")),e.GOLDEN_SWORD=m("golden_sword",ee("gold","weapon")),e.GOLDEN_SHOVEL=m("golden_shovel",ee("gold","digger")),e.GOLDEN_PICKAXE=m("golden_pickaxe",ee("gold","digger")),e.GOLDEN_AXE=m("golden_axe",ee("gold","axe")),e.GOLDEN_HOE=m("golden_hoe",ee("gold","digger")),e.IRON_SWORD=m("iron_sword",ee("iron","weapon")),e.IRON_SHOVEL=m("iron_shovel",ee("iron","digger")),e.IRON_PICKAXE=m("iron_pickaxe",ee("iron","digger")),e.IRON_AXE=m("iron_axe",ee("iron","axe")),e.IRON_HOE=m("iron_hoe",ee("iron","digger")),e.DIAMOND_SWORD=m("diamond_sword",ee("diamond","weapon")),e.DIAMOND_SHOVEL=m("diamond_shovel",ee("diamond","digger")),e.DIAMOND_PICKAXE=m("diamond_pickaxe",ee("diamond","digger")),e.DIAMOND_AXE=m("diamond_axe",ee("diamond","axe")),e.DIAMOND_HOE=m("diamond_hoe",ee("diamond","digger")),e.NETHERITE_SWORD=m("netherite_sword",ee("netherite","weapon")),e.NETHERITE_SHOVEL=m("netherite_shovel",ee("netherite","digger")),e.NETHERITE_PICKAXE=m("netherite_pickaxe",ee("netherite","digger")),e.NETHERITE_AXE=m("netherite_axe",ee("netherite","axe")),e.NETHERITE_HOE=m("netherite_hoe",ee("netherite","digger")),e.MUSHROOM_STEW=m("mushroom_stew",{stack:1,...Z(6,.6)}),e.BREAD=m("bread",Z(5,.6)),e.LEATHER_HELMET=m("leather_helmet",re("head","leather")),e.LEATHER_CHESTPLATE=m("leather_chestplate",re("chest","leather")),e.LEATHER_LEGGINGS=m("leather_leggings",re("legs","leather")),e.LEATHER_BOOTS=m("leather_boots",re("feet","leather")),e.CHAINMAIL_HELMET=m("chainmail_helmet",re("head","chainmail")),e.CHAINMAIL_CHESTPLATE=m("chainmail_chestplate",re("chest","chainmail")),e.CHAINMAIL_LEGGINGS=m("chainmail_leggings",re("legs","chainmail")),e.CHAINMAIL_BOOTS=m("chainmail_boots",re("feet","chainmail")),e.IRON_HELMET=m("iron_helmet",re("head","iron")),e.IRON_CHESTPLATE=m("iron_chestplate",re("chest","iron")),e.IRON_LEGGINGS=m("iron_leggings",re("legs","iron")),e.IRON_BOOTS=m("iron_boots",re("feet","iron")),e.DIAMOND_HELMET=m("diamond_helmet",re("head","diamond")),e.DIAMOND_CHESTPLATE=m("diamond_chestplate",re("chest","diamond")),e.DIAMOND_LEGGINGS=m("diamond_leggings",re("legs","diamond")),e.DIAMOND_BOOTS=m("diamond_boots",re("feet","diamond")),e.GOLDEN_HELMET=m("golden_helmet",re("head","gold")),e.GOLDEN_CHESTPLATE=m("golden_chestplate",re("chest","gold")),e.GOLDEN_LEGGINGS=m("golden_leggings",re("legs","gold")),e.GOLDEN_BOOTS=m("golden_boots",re("feet","gold")),e.NETHERITE_HELMET=m("netherite_helmet",re("head","netherite")),e.NETHERITE_CHESTPLATE=m("netherite_chestplate",re("chest","netherite")),e.NETHERITE_LEGGINGS=m("netherite_leggings",re("legs","netherite")),e.NETHERITE_BOOTS=m("netherite_boots",re("feet","netherite")),e.PORKCHOP=m("porkchop",Z(3,.3,{isMeat:!0})),e.COOKED_PORKCHOP=m("cooked_porkchop",Z(8,.8,{isMeat:!0})),e.GOLDEN_APPLE=m("golden_apple",{rarity:"rare",...Z(4,1.2,{canAlwaysEat:!0,effects:[[l.MobEffectInstance.create(l.MobEffects.REGENERATION,100,1),1],[l.MobEffectInstance.create(l.MobEffects.ABSORPTION,2400,0),1]]})}),e.ENCHANTED_GOLDEN_APPLE=m("enchanted_golden_apple",{rarity:"epic",...Z(4,1.2,{canAlwaysEat:!0,effects:[[l.MobEffectInstance.create(l.MobEffects.REGENERATION,400,1),1],[l.MobEffectInstance.create(l.MobEffects.RESISTANCE,6e3,0),1],[l.MobEffectInstance.create(l.MobEffects.FIRE_RESISTANCE,6e3,0),1],[l.MobEffectInstance.create(l.MobEffects.ABSORPTION,2400,3),1]]})}),e.OAK_SIGN=m("oak_sign",{stack:16}),e.SPRUCE_SIGN=m("spruce_sign",{stack:16}),e.BIRCH_SIGN=m("birch_sign",{stack:16}),e.JUNGLE_SIGN=m("jungle_sign",{stack:16}),e.ACACIA_SIGN=m("acacia_sign",{stack:16}),e.DARK_OAK_SIGN=m("dark_oak_sign",{stack:16}),e.MANGROVE_SIGN=m("mangrove_sign",{stack:16}),e.BAMBOO_SIGN=m("bamboo_sign",{stack:16}),e.CRIMSON_SIGN=m("crimson_sign",{stack:16}),e.WARPED_SIGN=m("warped_sign",{stack:16}),e.OAK_HANGING_SIGN=m("oak_hanging_sign",{stack:16}),e.SPRUCE_HANGING_SIGN=m("spruce_hanging_sign",{stack:16}),e.BIRCH_HANGING_SIGN=m("birch_hanging_sign",{stack:16}),e.JUNGLE_HANGING_SIGN=m("jungle_hanging_sign",{stack:16}),e.ACACIA_HANGING_SIGN=m("acacia_hanging_sign",{stack:16}),e.DARK_OAK_HANGING_SIGN=m("dark_oak_hanging_sign",{stack:16}),e.MANGROVE_HANGING_SIGN=m("mangrove_hanging_sign",{stack:16}),e.BAMBOO_HANGING_SIGN=m("bamboo_hanging_sign",{stack:16}),e.CRIMSON_HANGING_SIGN=m("crimson_hanging_sign",{stack:16}),e.WARPED_HANGING_SIGN=m("warped_hanging_sign",{stack:16}),e.BUCKET=m("bucket",{stack:16}),e.WATER_BUCKET=m("water_bucket",{stack:1,craftRemainder:e.BUCKET}),e.LAVA_BUCKET=m("lava_bucket",{stack:1,craftRemainder:e.BUCKET}),e.POWDER_SNOW_BUCKET=m("powder_snow_bucket",{stack:1}),e.SNOWBALL=m("snowball",{stack:16}),e.MILK_BUCKET=m("milk_bucket",{stack:1,craftRemainder:e.BUCKET}),e.PUFFERFISH_BUCKET=m("pufferfish_bucket",{stack:1}),e.SALMON_BUCKET=m("salmon_bucket",{stack:1}),e.COD_BUCKET=m("cod_bucket",{stack:1}),e.TROPICAL_FISH_BUCKET=m("tropical_fish_bucket",{stack:1}),e.AXOLOTL_BUCKET=m("axolotl_bucket",{stack:1}),e.TADPOLE_BUCKET=m("tadpole_bucket",{stack:1}),e.BOOK=m("book",{enchantmentValue:1}),e.EGG=m("egg",{stack:16}),e.COMPASS=m("compass",{vanishable:!0}),e.BUNDLE=m("bundle",{stack:1}),e.FISHING_ROD=m("fishing_rod",{stack:1,durability:64,enchantmentValue:1}),e.SPYGLASS=m("spyglass",{stack:1}),e.COD=m("cod",Z(2,.1)),e.SALMON=m("salmon",Z(2,.1)),e.TROPICAL_FISH=m("tropical_fish",Z(1,.1)),e.PUFFERFISH=m("pufferfish",Z(1,.1,{effects:[[l.MobEffectInstance.create(l.MobEffects.POISON,1200,1),1],[l.MobEffectInstance.create(l.MobEffects.HUNGER,300,2),1],[l.MobEffectInstance.create(l.MobEffects.NAUSEA,300,0),1]]})),e.COOKED_COD=m("cooked_cod",Z(5,.6)),e.COOKED_SALMON=m("cooked_salmon",Z(6,.8)),e.CAKE=m("cake",{stack:1}),e.WHITE_BED=m("white_bed",{stack:1}),e.ORANGE_BED=m("orange_bed",{stack:1}),e.MAGENTA_BED=m("magenta_bed",{stack:1}),e.LIGHT_BLUE_BED=m("light_blue_bed",{stack:1}),e.YELLOW_BED=m("yellow_bed",{stack:1}),e.LIME_BED=m("lime_bed",{stack:1}),e.PINK_BED=m("pink_bed",{stack:1}),e.GRAY_BED=m("gray_bed",{stack:1}),e.LIGHT_GRAY_BED=m("light_gray_bed",{stack:1}),e.CYAN_BED=m("cyan_bed",{stack:1}),e.PURPLE_BED=m("purple_bed",{stack:1}),e.BLUE_BED=m("blue_bed",{stack:1}),e.BROWN_BED=m("brown_bed",{stack:1}),e.GREEN_BED=m("green_bed",{stack:1}),e.RED_BED=m("red_bed",{stack:1}),e.BLACK_BED=m("black_bed",{stack:1}),e.COOKIE=m("cookie",Z(2,.1)),e.SHEARS=m("shears",{stack:1,durability:238}),e.MELON_SLICE=m("melon_slice",Z(2,.3)),e.DRIED_KELP=m("dried_kelp",Z(1,.3,{fastFood:!0})),e.BEEF=m("beef",Z(3,.3,{isMeat:!0})),e.COOKED_BEEF=m("cooked_beef",Z(8,.8,{isMeat:!0})),e.CHICKEN=m("chicken",Z(2,.3,{isMeat:!0,effects:[[l.MobEffectInstance.create(l.MobEffects.HUNGER,600,0),.3]]})),e.COOKED_CHICKEN=m("cooked_chicken",Z(6,.6,{isMeat:!0})),e.ROTTEN_FLESH=m("rotten_flesh",Z(4,.1,{isMeat:!0,effects:[[l.MobEffectInstance.create(l.MobEffects.HUNGER,600,0),.8]]})),e.ENDER_PEARL=m("ender_pearl",{stack:16}),e.POTION=m("potion",{stack:1}),e.GLASS_BOTTLE=m("glass_bottle"),e.SPIDER_EYE=m("spider_eye",Z(2,.8,{effects:[[l.MobEffectInstance.create(l.MobEffects.POISON,100,0),1]]})),e.ALLAY_SPAWN_EGG=m("allay_spawn_egg",P("allay",56063,44543)),e.AXOLOTL_SPAWN_EGG=m("axolotl_spawn_egg",P("axolotl",16499171,10890612)),e.BAT_SPAWN_EGG=m("bat_spawn_egg",P("bat",4996656,986895)),e.BEE_SPAWN_EGG=m("bee_spawn_egg",P("bee",15582019,4400155)),e.BLAZE_SPAWN_EGG=m("blaze_spawn_egg",P("blaze",16167425,16775294)),e.CAT_SPAWN_EGG=m("cat_spawn_egg",P("cat",15714446,9794134)),e.CAMEL_SPAWN_EGG=m("camel_spawn_egg",P("camel",16565097,13341495)),e.CAVE_SPIDER_SPAWN_EGG=m("cave_spider_spawn_egg",P("cave_spider",803406,11013646)),e.CHICKEN_SPAWN_EGG=m("chicken_spawn_egg",P("chicken",10592673,16711680)),e.COD_SPAWN_EGG=m("cod_spawn_egg",P("cod",12691306,15058059)),e.COW_SPAWN_EGG=m("cow_spawn_egg",P("cow",4470310,10592673)),e.CREEPER_SPAWN_EGG=m("creeper_spawn_egg",P("creeper",894731,0)),e.DOLPHIN_SPAWN_EGG=m("dolphin_spawn_egg",P("dolphin",2243405,16382457)),e.DONKEY_SPAWN_EGG=m("donkey_spawn_egg",P("donkey",5457209,8811878)),e.DROWNED_SPAWN_EGG=m("drowned_spawn_egg",P("drowned",9433559,7969893)),e.ELDER_GUARDIAN_SPAWN_EGG=m("elder_guardian_spawn_egg",P("elder_guardian",13552826,7632531)),e.ENDER_DRAGON_SPAWN_EGG=m("ender_dragon_spawn_egg",P("ender_dragon",1842204,14711290)),e.ENDERMAN_SPAWN_EGG=m("enderman_spawn_egg",P("enderman",1447446,0)),e.ENDERMITE_SPAWN_EGG=m("endermite_spawn_egg",P("endermite",1447446,7237230)),e.EVOKER_SPAWN_EGG=m("evoker_spawn_egg",P("evoker",9804699,1973274)),e.FOX_SPAWN_EGG=m("fox_spawn_egg",P("fox",14005919,13396256)),e.FROG_SPAWN_EGG=m("frog_spawn_egg",P("frog",13661252,16762748)),e.GHAST_SPAWN_EGG=m("ghast_spawn_egg",P("ghast",16382457,12369084)),e.GLOW_SQUID_SPAWN_EGG=m("glow_squid_spawn_egg",P("glow_squid",611926,8778172)),e.GOAT_SPAWN_EGG=m("goat_spawn_egg",P("goat",10851452,5589310)),e.GUARDIAN_SPAWN_EGG=m("guardian_spawn_egg",P("guardian",5931634,15826224)),e.HOGLIN_SPAWN_EGG=m("hoglin_spawn_egg",P("hoglin",13004373,6251620)),e.HORSE_SPAWN_EGG=m("horse_spawn_egg",P("horse",12623485,15656192)),e.HUSK_SPAWN_EGG=m("husk_spawn_egg",P("husk",7958625,15125652)),e.IRON_GOLEM_SPAWN_EGG=m("iron_golem_spawn_egg",P("iron_golem",14405058,7643954)),e.LLAMA_SPAWN_EGG=m("llama_spawn_egg",P("llama",12623485,10051392)),e.MAGMA_CUBE_SPAWN_EGG=m("magma_cube_spawn_egg",P("magma_cube",3407872,16579584)),e.MOOSHROOM_SPAWN_EGG=m("mooshroom_spawn_egg",P("mooshroom",10489616,12040119)),e.MULE_SPAWN_EGG=m("mule_spawn_egg",P("mule",1769984,5321501)),e.OCELOT_SPAWN_EGG=m("ocelot_spawn_egg",P("ocelot",15720061,5653556)),e.PANDA_SPAWN_EGG=m("panda_spawn_egg",P("panda",15198183,1776418)),e.PARROT_SPAWN_EGG=m("parrot_spawn_egg",P("parrot",894731,16711680)),e.PHANTOM_SPAWN_EGG=m("phantom_spawn_egg",P("phantom",4411786,8978176)),e.PIG_SPAWN_EGG=m("pig_spawn_egg",P("pig",15771042,14377823)),e.PIGLIN_SPAWN_EGG=m("piglin_spawn_egg",P("piglin",10051392,16380836)),e.PIGLIN_BRUTE_SPAWN_EGG=m("piglin_brute_spawn_egg",P("piglin_brute",5843472,16380836)),e.PILLAGER_SPAWN_EGG=m("pillager_spawn_egg",P("pillager",5451574,9804699)),e.POLAR_BEAR_SPAWN_EGG=m("polar_bear_spawn_egg",P("polar_bear",15658718,14014157)),e.PUFFERFISH_SPAWN_EGG=m("pufferfish_spawn_egg",P("pufferfish",16167425,3654642)),e.RABBIT_SPAWN_EGG=m("rabbit_spawn_egg",P("rabbit",10051392,7555121)),e.RAVAGER_SPAWN_EGG=m("ravager_spawn_egg",P("ravager",7697520,5984329)),e.SALMON_SPAWN_EGG=m("salmon_spawn_egg",P("salmon",10489616,951412)),e.SHEEP_SPAWN_EGG=m("sheep_spawn_egg",P("sheep",15198183,16758197)),e.SHULKER_SPAWN_EGG=m("shulker_spawn_egg",P("shulker",9725844,5060690)),e.SILVERFISH_SPAWN_EGG=m("silverfish_spawn_egg",P("silverfish",7237230,3158064)),e.SKELETON_SPAWN_EGG=m("skeleton_spawn_egg",P("skeleton",12698049,4802889)),e.SKELETON_HORSE_SPAWN_EGG=m("skeleton_horse_spawn_egg",P("skeleton_horse",6842447,15066584)),e.SLIME_SPAWN_EGG=m("slime_spawn_egg",P("slime",5349438,8306542)),e.SNOW_GOLEM_SPAWN_EGG=m("snow_golem_spawn_egg",P("snow_golem",14283506,8496292)),e.SPIDER_SPAWN_EGG=m("spider_spawn_egg",P("spider",3419431,11013646)),e.SQUID_SPAWN_EGG=m("squid_spawn_egg",P("squid",2243405,7375001)),e.STRAY_SPAWN_EGG=m("stray_spawn_egg",P("stray",6387319,14543594)),e.STRIDER_SPAWN_EGG=m("strider_spawn_egg",P("strider",10236982,5065037)),e.TADPOLE_SPAWN_EGG=m("tadpole_spawn_egg",P("tadpole",7164733,1444352)),e.TRADER_LLAMA_SPAWN_EGG=m("trader_llama_spawn_egg",P("trader_llama",15377456,4547222)),e.TROPICAL_FISH_SPAWN_EGG=m("tropical_fish_spawn_egg",P("tropical_fish",15690005,16775663)),e.TURTLE_SPAWN_EGG=m("turtle_spawn_egg",P("turtle",15198183,44975)),e.VEX_SPAWN_EGG=m("vex_spawn_egg",P("vex",8032420,15265265)),e.VILLAGER_SPAWN_EGG=m("villager_spawn_egg",P("villager",5651507,12422002)),e.VINDICATOR_SPAWN_EGG=m("vindicator_spawn_egg",P("vindicator",9804699,2580065)),e.WANDERING_TRADER_SPAWN_EGG=m("wandering_trader_spawn_egg",P("wandering_trader",4547222,15377456)),e.WARDEN_SPAWN_EGG=m("warden_spawn_egg",P("warden",1001033,3790560)),e.WITCH_SPAWN_EGG=m("witch_spawn_egg",P("witch",3407872,5349438)),e.WITHER_SPAWN_EGG=m("wither_spawn_egg",P("wither",1315860,5075616)),e.WITHER_SKELETON_SPAWN_EGG=m("wither_skeleton_spawn_egg",P("wither_skeleton",1315860,4672845)),e.WOLF_SPAWN_EGG=m("wolf_spawn_egg",P("wolf",14144467,13545366)),e.ZOGLIN_SPAWN_EGG=m("zoglin_spawn_egg",P("zoglin",13004373,15132390)),e.ZOMBIE_SPAWN_EGG=m("zombie_spawn_egg",P("zombie",44975,7969893)),e.ZOMBIE_HORSE_SPAWN_EGG=m("zombie_horse_spawn_egg",P("zombie_horse",3232308,9945732)),e.ZOMBIE_VILLAGER_SPAWN_EGG=m("zombie_villager_spawn_egg",P("zombie_villager",5651507,7969893)),e.ZOMBIFIED_PIGLIN_SPAWN_EGG=m("zombified_piglin_spawn_egg",P("zombified_piglin",15373203,5009705)),e.EXPERIENCE_BOTTLE=m("experience_bottle",{rarity:"uncommon"}),e.WRITABLE_BOOK=m("writable_book",{stack:1}),e.WRITTEN_BOOK=m("written_book",{stack:16}),e.CARROT=m("carrot",Z(3,.6)),e.POTATO=m("potato",Z(1,.3)),e.BAKED_POTATO=m("baked_potato",Z(5,.6)),e.POISONOUS_POTATO=m("poisonous_potato",Z(2,.3,{effects:[[l.MobEffectInstance.create(l.MobEffects.POISON,100,0),.6]]})),e.GOLDEN_CARROT=m("golden_carrot",Z(6,1.2)),e.SKELETON_SKULL=m("skeleton_skull",{rarity:"uncommon",wearable:!0}),e.WITHER_SKELETON_SKULL=m("wither_skeleton_skull",{rarity:"uncommon",wearable:!0}),e.PLAYER_HEAD=m("player_head",{rarity:"uncommon",wearable:!0}),e.ZOMBIE_HEAD=m("zombie_head",{rarity:"uncommon",wearable:!0}),e.CREEPER_HEAD=m("creeper_head",{rarity:"uncommon",wearable:!0}),e.DRAGON_HEAD=m("dragon_head",{rarity:"uncommon",wearable:!0}),e.PIGLIN_HEAD=m("piglin_head",{rarity:"uncommon",wearable:!0}),e.NETHER_STAR=m("nether_star",{rarity:"uncommon"}),e.PUMPKIN_PIE=m("pumpkin_pie",Z(8,.3)),e.ENCHANTED_BOOK=m("enchanted_book",{rarity:"uncommon",stack:1}),e.RABBIT=m("rabbit",Z(3,.3,{isMeat:!0})),e.COOKED_RABBIT=m("cooked_rabbit",Z(5,.6,{isMeat:!0})),e.RABBIT_STEW=m("rabbit_stew",{stack:1,...Z(10,.6)}),e.ARMOR_STAND=m("armor_stand",{stack:16}),e.IRON_HORSE_ARMOR=m("iron_horse_armor",{stack:1}),e.GOLDEN_HORSE_ARMOR=m("golden_horse_armor",{stack:1}),e.DIAMOND_HORSE_ARMOR=m("diamond_horse_armor",{stack:1}),e.LEATHER_HORSE_ARMOR=m("leather_horse_armor",{stack:1}),e.COMMAND_BLOCK_MINECART=m("command_block_minecart",{rarity:"epic",stack:1}),e.MUTTON=m("mutton",Z(2,.3,{isMeat:!0})),e.COOKED_MUTTON=m("cooked_mutton",Z(6,.8,{isMeat:!0})),e.WHITE_BANNER=m("white_banner",{stack:16}),e.ORANGE_BANNER=m("orange_banner",{stack:16}),e.MAGENTA_BANNER=m("magenta_banner",{stack:16}),e.LIGHT_BLUE_BANNER=m("light_blue_banner",{stack:16}),e.YELLOW_BANNER=m("yellow_banner",{stack:16}),e.LIME_BANNER=m("lime_banner",{stack:16}),e.PINK_BANNER=m("pink_banner",{stack:16}),e.GRAY_BANNER=m("gray_banner",{stack:16}),e.LIGHT_GRAY_BANNER=m("light_gray_banner",{stack:16}),e.CYAN_BANNER=m("cyan_banner",{stack:16}),e.PURPLE_BANNER=m("purple_banner",{stack:16}),e.BLUE_BANNER=m("blue_banner",{stack:16}),e.BROWN_BANNER=m("brown_banner",{stack:16}),e.GREEN_BANNER=m("green_banner",{stack:16}),e.RED_BANNER=m("red_banner",{stack:16}),e.BLACK_BANNER=m("black_banner",{stack:16}),e.END_CRYSTAL=m("end_crystal",{rarity:"rare"}),e.CHORUS_FRUIT=m("chorus_fruit",Z(4,.3,{canAlwaysEat:!0})),e.BEETROOT=m("beetroot",Z(1,.6)),e.BEETROOT_SOUP=m("beetroot_soup",{stack:1,...Z(6,.6)}),e.DRAGON_BREATH=m("dragon_breath",{rarity:"uncommon",craftRemainder:e.GLASS_BOTTLE}),e.SPLASH_POTION=m("splash_potion",{stack:1}),e.LINGERING_POTION=m("lingering_potion",{stack:1}),e.SHIELD=m("shield",{stack:1,durability:336}),e.TOTEM_OF_UNDYING=m("totem_of_undying",{rarity:"uncommon",stack:1}),e.KNOWLEDGE_BOOK=m("knowledge_book",{rarity:"epic",stack:1}),e.DEBUG_STICK=m("debug_stick",{rarity:"epic",stack:1}),e.MUSIC_DISC_13=m("music_disc_13",{rarity:"rare",stack:1}),e.MUSIC_DISC_CAT=m("music_disc_cat",{rarity:"rare",stack:1}),e.MUSIC_DISC_BLOCKS=m("music_disc_blocks",{rarity:"rare",stack:1}),e.MUSIC_DISC_CHIRP=m("music_disc_chirp",{rarity:"rare",stack:1}),e.MUSIC_DISC_FAR=m("music_disc_far",{rarity:"rare",stack:1}),e.MUSIC_DISC_MALL=m("music_disc_mall",{rarity:"rare",stack:1}),e.MUSIC_DISC_MELLOHI=m("music_disc_mellohi",{rarity:"rare",stack:1}),e.MUSIC_DISC_STAL=m("music_disc_stal",{rarity:"rare",stack:1}),e.MUSIC_DISC_STRAD=m("music_disc_strad",{rarity:"rare",stack:1}),e.MUSIC_DISC_WARD=m("music_disc_ward",{rarity:"rare",stack:1}),e.MUSIC_DISC_11=m("music_disc_11",{rarity:"rare",stack:1}),e.MUSIC_DISC_WAIT=m("music_disc_wait",{rarity:"rare",stack:1}),e.MUSIC_DISC_OTHERSIDE=m("music_disc_otherside",{rarity:"rare",stack:1}),e.MUSIC_DISC_5=m("music_disc_5",{rarity:"rare",stack:1}),e.MUSIC_DISC_PIGSTEP=m("music_disc_pigstep",{rarity:"rare",stack:1}),e.TRIDENT=m("trident",{stack:1,durability:250,enchantmentValue:1}),e.HEART_OF_THE_SEA=m("heart_of_the_sea",{rarity:"uncommon"}),e.CROSSBOW=m("crossbow",{stack:1,durability:465,enchantmentValue:1}),e.SUSPICIOUS_STEW=m("suspicious_stew",{stack:1,...Z(6,.6,{canAlwaysEat:!0})}),e.FLOWER_BANNER_PATTERN=m("flower_banner_pattern",{stack:1}),e.CREEPER_BANNER_PATTERN=m("creeper_banner_pattern",{rarity:"uncommon",stack:1}),e.SKULL_BANNER_PATTERN=m("skull_banner_pattern",{rarity:"uncommon",stack:1}),e.MOJANG_BANNER_PATTERN=m("mojang_banner_pattern",{rarity:"epic",stack:1}),e.GLOBE_BANNER_PATTERN=m("globe_banner_pattern",{stack:1}),e.PIGLIN_BANNER_PATTERN=m("piglin_banner_pattern",{stack:1}),e.GOAT_HORN=m("goat_horn",{stack:1}),e.SWEET_BERRIES=m("sweet_berries",Z(2,.1)),e.GLOW_BERRIES=m("glow_berries",Z(2,.1)),e.HONEY_BOTTLE=m("honey_bottle",{stack:16,craftRemainder:e.GLASS_BOTTLE,...Z(6,.1)})})(l.Items||(l.Items={}));class ve{constructor(t,n,i=new ue){p(this,"item");this.id=t,this.count=n,this.tag=i}getItem(){return this.item===void 0&&(this.item=l.Item.get(this.id)),this.item}clone(){const t=ue.fromJson(this.tag.toJson());return new ve(this.id,this.count,t)}is(t){return typeof t=="string"?this.id.equals(G.parse(t)):t instanceof G?this.id.equals(t):this.id.equals(t.id)}equals(t){return this===t?!0:t instanceof ve?this.id.equals(t.id)&&this.count===t.count&&this.tag.toString()==t.tag.toString():!1}toString(){return this.id.toString()+(this.tag.size>0?this.tag.toString():"")+(this.count>1?` ${this.count}`:"")}}l.Rotation=(e=>(e.NONE="none",e.CLOCKWISE_90="clockwise_90",e.CLOCKWISE_180="180",e.COUNTERCLOCKWISE_90="counterclockwise_90",e))(l.Rotation||{}),(e=>{function t(n){return["none","clockwise_90","180","counterclockwise_90"][n.nextInt(4)]}e.getRandom=t})(l.Rotation||(l.Rotation={}));const Ti=class{constructor(t,n=[],i=[]){p(this,"blocksMap",[]);this.size=t,this.palette=n,this.blocks=i,i.forEach(r=>{if(!this.isInside(r.pos))throw new Error(`Found block at ${r.pos} which is outside the structure bounds ${this.size}`);this.blocksMap[r.pos[0]*t[1]*t[2]+r.pos[1]*t[2]+r.pos[2]]=r})}getSize(){return this.size}addBlock(t,n,i,r){if(!this.isInside(t))throw new Error(`Cannot add block at ${t} outside the structure bounds ${this.size}`);const s=new $(n,i);let a=this.palette.findIndex(o=>o.equals(s));return a===-1&&(a=this.palette.length,this.palette.push(s)),this.blocks.push({pos:t,state:a,nbt:r}),this.blocksMap[t[0]*this.size[1]*this.size[2]+t[1]*this.size[2]+t[2]]={pos:t,state:a,nbt:r},this}getBlocks(){return this.blocks.map(t=>this.toPlacedBlock(t))}getBlock(t){if(!this.isInside(t))return null;const n=this.blocksMap[t[0]*this.size[1]*this.size[2]+t[1]*this.size[2]+t[2]];return n?this.toPlacedBlock(n):null}toPlacedBlock(t){const n=this.palette[t.state];if(!n)throw new Error(`Block at ${t.pos.join(" ")} in structure references invalid palette index ${t.state}`);return{pos:t.pos,state:n,nbt:t.nbt}}isInside(t){return t[0]>=0&&t[0]<this.size[0]&&t[1]>=0&&t[1]<this.size[1]&&t[2]>=0&&t[2]<this.size[2]}static fromNbt(t){const n=l.BlockPos.fromNbt(t.getList("size")),i=t.getList("palette",B.Compound).map(s=>$.fromNbt(s)),r=t.getList("blocks",B.Compound).map(s=>{const a=l.BlockPos.fromNbt(s.getList("pos")),o=s.getNumber("state"),u=s.getCompound("nbt");return{pos:a,state:o,nbt:u.size>0?u:void 0}});return new Ti(n,i,r)}static transform(t,n,i){switch(n){case l.Rotation.COUNTERCLOCKWISE_90:return l.BlockPos.create(i[0]-i[2]+t[2],t[1],i[0]+i[2]-t[0]);case l.Rotation.CLOCKWISE_90:return l.BlockPos.create(i[0]+i[2]-t[2],t[1],i[2]-i[0]+t[0]);case l.Rotation.CLOCKWISE_180:return l.BlockPos.create(i[0]+i[0]-t[0],t[1],i[2]+i[2]-t[2]);default:return t}}};let st=Ti;p(st,"REGISTRY",oe.createAndRegister("structures")),p(st,"EMPTY",new Ti(l.BlockPos.ZERO));const li=new oe(G.create("enchantment"));oe.REGISTRY.register(li.key,li),l.Enchantment=void 0,(e=>{e.REGISTRY=li;function t(i,r){return i!==r&&i._isCompatible(r)&&r._isCompatible(i)}e.isCompatible=t;function n(i,r){return r._canEnchant(i,()=>{var s,a;return(a=(s=bl.get(r.category))==null?void 0:s(i.getItem()))!=null?a:!1})}e.canEnchant=n})(l.Enchantment||(l.Enchantment={}));function Y(e,t,n,i){const r={id:G.create(e),rarity:t,category:n,isDiscoverable:!0,isTradeable:!0,isTreasure:!1,isCurse:!1,minLevel:1,maxLevel:1,minCost(s){return 1+s*10},maxCost(s){return this.minCost(s)+5},_isCompatible(){return!0},_canEnchant(s,a){return a()},...i};return li.register(r.id,r,!0),r}l.Enchantments=void 0,(e=>{e.PROTECTION=Y("protection","common","armor",{maxLevel:4,minCost:i=>1+(i-1)*11,maxCost:i=>1+(i-1)*11+11,_isCompatible:i=>!t.has(i)}),e.FIRE_PROTECTION=Y("fire_protection","uncommon","armor",{maxLevel:4,minCost:i=>10+(i-1)*8,maxCost:i=>10+(i-1)*8+8,_isCompatible:i=>!t.has(i)}),e.FEATHER_FALLING=Y("feather_falling","uncommon","armor_feet",{maxLevel:4,minCost:i=>5+(i-1)*6,maxCost:i=>5+(i-1)*6+6}),e.BLAST_PROTECTION=Y("blast_protection","rare","armor",{maxLevel:4,minCost:i=>5+(i-1)*8,maxCost:i=>5+(i-1)*8+8,_isCompatible:i=>!t.has(i)}),e.PROJECTILE_PROTECTION=Y("projectile_protection","uncommon","armor",{maxLevel:4,minCost:i=>3+(i-1)*6,maxCost:i=>3+(i-1)*6+6,_isCompatible:i=>!t.has(i)}),e.RESPIRATION=Y("respiration","rare","armor_head",{maxLevel:3,minCost:i=>10*i,maxCost:i=>10*i+30}),e.AQUA_AFFINITY=Y("aqua_affinity","rare","armor_head",{minCost:()=>1,maxCost:()=>40}),e.THORNS=Y("thorns","very_rare","armor_chest",{maxLevel:3,minCost:i=>10+20*(i-1),maxCost:i=>10+20*(i-1)+50}),e.DEPTH_STRIDER=Y("depth_strider","rare","armor_feet",{maxLevel:3,minCost:i=>10*i,maxCost:i=>10*i+15,_isCompatible:i=>i!==e.FROST_WALKER}),e.FROST_WALKER=Y("frost_walker","rare","armor_feet",{isTreasure:!0,maxLevel:2,minCost:i=>10*i,maxCost:i=>10*i+15,_isCompatible:i=>i!==e.DEPTH_STRIDER}),e.BINDING_CURSE=Y("binding_curse","very_rare","wearable",{isTreasure:!0,isCurse:!0,minCost:()=>25,maxCost:()=>50}),e.SOUL_SPEED=Y("soul_speed","very_rare","armor_feet",{isDiscoverable:!1,isTradeable:!1,isTreasure:!0,maxLevel:3,minCost:i=>10*i,maxCost:i=>10*i+15}),e.SWIFT_SNEAK=Y("swift_sneak","very_rare","armor_legs",{isDiscoverable:!1,isTradeable:!1,isTreasure:!0,maxLevel:3,minCost:i=>25*i,maxCost:i=>25*i+50}),e.SHARPNESS=Y("sharpness","common","weapon",{maxLevel:5,minCost:i=>1+(i-1)*11,maxCost:i=>1+(i-1)*11+20,_isCompatible:i=>!n.has(i),_canEnchant:(i,r)=>{var s;return((s=i.getItem().tiered)==null?void 0:s.isAxe)||r()}}),e.SMITE=Y("smite","common","weapon",{maxLevel:5,minCost:i=>5+(i-1)*8,maxCost:i=>5+(i-1)*8+20,_isCompatible:i=>!n.has(i),_canEnchant:(i,r)=>{var s;return((s=i.getItem().tiered)==null?void 0:s.isAxe)||r()}}),e.BANE_OF_ARTHROPODS=Y("bane_of_arthropods","common","weapon",{maxLevel:5,minCost:i=>5+(i-1)*8,maxCost:i=>5+(i-1)*8+20,_isCompatible:i=>!n.has(i),_canEnchant:(i,r)=>{var s;return((s=i.getItem().tiered)==null?void 0:s.isAxe)||r()}}),e.KNOCKBACK=Y("knockback","uncommon","weapon",{maxLevel:2,minCost:i=>5+20*(i-1),maxCost:i=>1+i*10+50}),e.FIRE_ASPECT=Y("fire_aspect","rare","weapon",{maxLevel:2,minCost:i=>5+20*(i-1),maxCost:i=>1+i*10+50}),e.LOOTING=Y("looting","rare","weapon",{maxLevel:3,minCost:i=>15+(i-1)*9,maxCost:i=>1+i*10+50,_isCompatible:i=>i!==e.SILK_TOUCH}),e.SWEEPING=Y("sweeping","rare","weapon",{maxLevel:3,minCost:i=>5+(i-1)*9,maxCost:i=>5+(i-1)*9+15}),e.EFFICIENCY=Y("efficiency","common","digger",{maxLevel:5,minCost:i=>1+10*(i-1),maxCost:i=>1+i*10+50,_canEnchant:(i,r)=>i.is("shears")||r()}),e.SILK_TOUCH=Y("silk_touch","very_rare","digger",{minCost:()=>15,maxCost:i=>1+i*10+50,_isCompatible:i=>i!==e.FORTUNE}),e.UNBREAKING=Y("unbreaking","uncommon","breakable",{maxLevel:3,minCost:i=>5+(i-1)*8,maxCost:i=>1+i*10+50,_canEnchant:(i,r)=>r()&&!i.tag.getBoolean("Unbreakable")}),e.FORTUNE=Y("fortune","rare","digger",{maxLevel:3,minCost:i=>15+(i-1)*9,maxCost:i=>1+i*10+50,_isCompatible:i=>i!==e.SILK_TOUCH}),e.POWER=Y("power","common","bow",{maxLevel:5,minCost:i=>1+(i-1)*10,maxCost:i=>1+(i-1)*10+15}),e.PUNCH=Y("punch","rare","bow",{maxLevel:2,minCost:i=>12+(i-1)*20,maxCost:i=>12+(i-1)*20+25}),e.FLAME=Y("flame","rare","bow",{minCost:()=>20,maxCost:()=>50}),e.INFINITY=Y("infinity","very_rare","bow",{minCost:()=>20,maxCost:()=>50,_isCompatible:i=>i!==e.MENDING}),e.LUCK_OF_THE_SEA=Y("luck_of_the_sea","rare","fishing_rod",{maxLevel:3,minCost:i=>15+(i-1)*9,maxCost:i=>1+i*10+50,_isCompatible:i=>i!==e.SILK_TOUCH}),e.LURE=Y("lure","rare","fishing_rod",{maxLevel:3,minCost:i=>15+(i-1)*9,maxCost:i=>1+i*10+50}),e.LOYALTY=Y("loyalty","uncommon","trident",{maxLevel:3,minCost:i=>5+i*7,maxCost:()=>50}),e.IMPALING=Y("impaling","rare","trident",{maxLevel:5,minCost:i=>1+(i-1)*8,maxCost:i=>1+(i-1)*8+20}),e.RIPTIDE=Y("riptide","rare","trident",{maxLevel:3,minCost:i=>5+i*7,maxCost:()=>50,_isCompatible:i=>i!==e.RIPTIDE&&i!==e.CHANNELING}),e.CHANNELING=Y("channeling","very_rare","trident",{minCost:()=>25,maxCost:()=>50}),e.MULTISHOT=Y("multishot","rare","crossbow",{minCost:()=>20,maxCost:()=>50,_isCompatible:i=>i!==e.PIERCING}),e.QUICK_CHARGE=Y("quick_charge","uncommon","crossbow",{maxLevel:3,minCost:i=>12+(i-1)*20,maxCost:()=>50}),e.PIERCING=Y("piercing","common","crossbow",{maxLevel:4,minCost:i=>1+(i-1)*10,maxCost:()=>50,_isCompatible:i=>i!==e.MULTISHOT}),e.MENDING=Y("mending","rare","breakable",{isTreasure:!0,minCost:i=>i*25,maxCost:i=>i*25+50}),e.VANISHING_CURSE=Y("vanishing_curse","very_rare","vanishable",{isTreasure:!0,isCurse:!0,minCost:()=>25,maxCost:()=>50});const t=new Set([e.PROTECTION,e.FIRE_PROTECTION,e.BLAST_PROTECTION,e.PROJECTILE_PROTECTION]),n=new Set([e.SHARPNESS,e.SMITE,e.BANE_OF_ARTHROPODS])})(l.Enchantments||(l.Enchantments={}));const bl=new Map(Object.entries({armor:e=>e.armor!==void 0,armor_feet:e=>{var t;return((t=e.armor)==null?void 0:t.slot)==="feet"},armor_legs:e=>{var t;return((t=e.armor)==null?void 0:t.slot)==="legs"},armor_chest:e=>{var t;return((t=e.armor)==null?void 0:t.slot)==="chest"},armor_head:e=>{var t;return((t=e.armor)==null?void 0:t.slot)==="head"},weapon:e=>{var t;return((t=e.tiered)==null?void 0:t.isWeapon)===!0},digger:e=>{var t;return((t=e.tiered)==null?void 0:t.isDigger)===!0},fishing_rod:e=>e.id.path==="fishing_rod",trident:e=>e.id.path==="trident",breakable:e=>e.durability!==void 0,bow:e=>e.id.path==="bow",wearable:e=>e.wearable===!0,crossbow:e=>e.id.path==="crossbow",vanishable:e=>e.vanishable===!0})),Bn=new oe(G.create("potion"));oe.REGISTRY.register(Bn.key,Bn),l.Potion=void 0,(e=>{e.REGISTRY=Bn;function t(s){var u;const o=(s instanceof ve?s.tag:s).getString("Potion");return(u=Bn.get(G.parse(o)))!=null?u:l.Potions.EMPTY}e.fromNbt=t;function n(s){const a=s instanceof ve||s instanceof ue?t(s):s,o=[];return o.push(...a.effects),(a instanceof ve||a instanceof ue)&&(a instanceof ve?a.tag:a).getList("CustomPotionEffects",B.Compound).forEach(c=>{const h=l.MobEffectInstance.fromNbt(c);h!==void 0&&o.push(h)}),o}e.getAllEffects=n;function i(s){return(s instanceof ve||s instanceof ue?t(s):s).effects.flatMap(o=>Array.from(o.effect.modifiers.entries()))}e.getAllAttributeModifiers=i;function r(s){if(s===l.Potions.EMPTY)return Ee(16253176);if(s instanceof ve||s instanceof ue){const o=s instanceof ve?s.tag:s;if(o.hasNumber("CustomPotionColor"))return Ee(o.getNumber("CustomPotionColor"))}const a=n(s);return l.MobEffectInstance.getColor(a)}e.getColor=r})(l.Potion||(l.Potion={}));function U(e,...t){let n=e;n.startsWith("long_")&&(n=n.slice(5)),n.startsWith("strong_")&&(n=n.slice(7));const i={id:G.create(e),name:n,effects:t};return Bn.register(i.id,i,!0),i}l.Potions=void 0,(e=>{e.EMPTY=U("empty"),e.WATER=U("water"),e.MUNDANE=U("mundane"),e.THICK=U("thick"),e.AWKWARD=U("awkward"),e.NIGHT_VISION=U("night_vision",l.MobEffectInstance.create(l.MobEffects.NIGHT_VISION,3600)),e.LONG_NIGHT_VISION=U("long_night_vision",l.MobEffectInstance.create(l.MobEffects.NIGHT_VISION,9600)),e.INVISIBILITY=U("invisibility",l.MobEffectInstance.create(l.MobEffects.INVISIBILITY,3600)),e.LONG_INVISIBILITY=U("long_invisibility",l.MobEffectInstance.create(l.MobEffects.INVISIBILITY,9600)),e.LEAPING=U("leaping",l.MobEffectInstance.create(l.MobEffects.JUMP_BOOST,3600)),e.LONG_LEAPING=U("long_leaping",l.MobEffectInstance.create(l.MobEffects.JUMP_BOOST,9600)),e.STRONG_LEAPING=U("strong_leaping",l.MobEffectInstance.create(l.MobEffects.JUMP_BOOST,1800,1)),e.FIRE_RESISTANCE=U("fire_resistance",l.MobEffectInstance.create(l.MobEffects.FIRE_RESISTANCE,3600)),e.LONG_FIRE_RESISTANCE=U("long_fire_resistance",l.MobEffectInstance.create(l.MobEffects.FIRE_RESISTANCE,9600)),e.SWIFTNESS=U("swiftness",l.MobEffectInstance.create(l.MobEffects.SPEED,3600)),e.LONG_SWIFTNESS=U("long_swiftness",l.MobEffectInstance.create(l.MobEffects.SPEED,9600)),e.STRONG_SWIFTNESS=U("strong_swiftness",l.MobEffectInstance.create(l.MobEffects.SPEED,1800,1)),e.SLOWNESS=U("slowness",l.MobEffectInstance.create(l.MobEffects.SLOWNESS,1800)),e.LONG_SLOWNESS=U("long_slowness",l.MobEffectInstance.create(l.MobEffects.SLOWNESS,4800)),e.STRONG_SLOWNESS=U("strong_slowness",l.MobEffectInstance.create(l.MobEffects.SLOWNESS,400,3)),e.TURTLE_MASTER=U("turtle_master",l.MobEffectInstance.create(l.MobEffects.SLOWNESS,400,3),l.MobEffectInstance.create(l.MobEffects.RESISTANCE,400,2)),e.LONG_TURTLE_MASTER=U("long_turtle_master",l.MobEffectInstance.create(l.MobEffects.SLOWNESS,800,3),l.MobEffectInstance.create(l.MobEffects.RESISTANCE,800,2)),e.STRONG_TURTLE_MASTER=U("strong_turtle_master",l.MobEffectInstance.create(l.MobEffects.SLOWNESS,400,5),l.MobEffectInstance.create(l.MobEffects.RESISTANCE,400,3)),e.WATER_BREATHING=U("water_breathing",l.MobEffectInstance.create(l.MobEffects.WATER_BREATHING,3600)),e.LONG_WATER_BREATHING=U("long_water_breathing",l.MobEffectInstance.create(l.MobEffects.WATER_BREATHING,9600)),e.HEALING=U("healing",l.MobEffectInstance.create(l.MobEffects.INSTANT_HEALTH,1)),e.STRONG_HEALING=U("strong_healing",l.MobEffectInstance.create(l.MobEffects.INSTANT_HEALTH,1,1)),e.HARMING=U("harming",l.MobEffectInstance.create(l.MobEffects.INSTANT_DAMAGE,1)),e.STRONG_HARMING=U("strong_harming",l.MobEffectInstance.create(l.MobEffects.INSTANT_DAMAGE,1,1)),e.POISON=U("poison",l.MobEffectInstance.create(l.MobEffects.POISON,900)),e.LONG_POISON=U("long_poison",l.MobEffectInstance.create(l.MobEffects.POISON,1800)),e.STRONG_POISON=U("strong_poison",l.MobEffectInstance.create(l.MobEffects.POISON,432,1)),e.REGENERATION=U("regeneration",l.MobEffectInstance.create(l.MobEffects.REGENERATION,900)),e.LONG_REGENERATION=U("long_regeneration",l.MobEffectInstance.create(l.MobEffects.REGENERATION,1800)),e.STRONG_REGENERATION=U("strong_regeneration",l.MobEffectInstance.create(l.MobEffects.REGENERATION,450,1)),e.STRENGTH=U("strength",l.MobEffectInstance.create(l.MobEffects.STRENGTH,3600)),e.LONG_STRENGTH=U("long_strength",l.MobEffectInstance.create(l.MobEffects.STRENGTH,9600)),e.STRONG_STRENGTH=U("strong_strength",l.MobEffectInstance.create(l.MobEffects.STRENGTH,1800,1)),e.WEAKNESS=U("weakness",l.MobEffectInstance.create(l.MobEffects.WEAKNESS,1800)),e.LONG_WEAKNESS=U("long_weakness",l.MobEffectInstance.create(l.MobEffects.WEAKNESS,4800)),e.LUCK=U("luck",l.MobEffectInstance.create(l.MobEffects.LUCK,6e3)),e.SLOW_FALLING=U("slow_falling",l.MobEffectInstance.create(l.MobEffects.SLOW_FALLING,1800)),e.LONG_SLOW_FALLING=U("long_slow_falling",l.MobEffectInstance.create(l.MobEffects.SLOW_FALLING,4800))})(l.Potions||(l.Potions={}));function at(e){return e*e}function Nt(e,t,n){return Math.max(t,Math.min(n,e))}function ot(e,t,n){return t+e*(n-t)}function hi(e,t,n,i,r,s){return ot(t,ot(e,n,i),ot(e,r,s))}function Us(e,t,n,i,r,s,a,o,u,c,h){return ot(n,hi(e,t,i,r,s,a),hi(e,t,o,u,c,h))}function Pn(e,t,n){return e===0?t():e===1?n():t()+e*(n()-t())}function nr(e,t,n,i,r,s){return Pn(t,()=>Pn(e,n,i),()=>Pn(e,r,s))}function Ws(e,t,n,i,r,s,a,o,u,c,h){return Pn(n,()=>nr(e,t,i,r,s,a),()=>nr(e,t,o,u,c,h))}function ui(e,t,n){return n<0?e:n>1?t:ot(n,e,t)}function ir(e,t,n){return(e-t)/(n-t)}function fi(e){return e*e*e*(e*(e*6-15)+10)}function Gn(e,t,n,i,r){return ot(ir(e,t,n),i,r)}function rr(e,t,n,i,r){return ui(i,r,ir(e,t,n))}function Vs(e,t,n){let i=t-e;for(;i>0;){const r=Math.floor(i/2),s=e+r;if(n(s)){i=r;continue}e=s+1,i-=r+1}return e}function sr(e,t,n){let i=BigInt(e*3129871)^BigInt(n)*BigInt(116129781)^BigInt(t);return i=i*i*BigInt(42317861)+i*BigInt(11),i>>BigInt(16)}function di(e,t,n,i,r,s,a,o){return BigInt(e)<<BigInt(56)|BigInt(t)<<BigInt(48)|BigInt(n)<<BigInt(40)|BigInt(i)<<BigInt(32)|BigInt(r)<<BigInt(24)|BigInt(s)<<BigInt(16)|BigInt(a)<<BigInt(8)|BigInt(o)}function ar(e){return(e&e-1)===0}function Zs(e){return e-=1,e|=e>>1,e|=e>>2,e|=e>>4,e|=e>>8,e|=e>>18,e|=e>>32,e+1}function gi(e,t,n){return e.nextInt(n-t+1)+t}function _i(e,t,n){return t>=n?t:e.nextInt(n-t+1)+t}function Ys(e,t){for(var n=e.length;n>1;n--){const i=t.nextInt(n),r=e[i];e[i]=e[n-1],e[n-1]=r}}l.MinMaxNumberFunction=void 0,(e=>{function t(n){return typeof n=="object"&&n!==null&&"minValue"in n&&"maxValue"in n}e.is=t})(l.MinMaxNumberFunction||(l.MinMaxNumberFunction={})),l.CubicSpline=void 0,(e=>{function t(r,s){var c,h,f,g;if(typeof r=="number")return new n(r);const a=(c=l.Json.readObject(r))!=null?c:{},o=new i(s(a.coordinate)),u=(h=l.Json.readArray(a.points,d=>{var E;return(E=l.Json.readObject(d))!=null?E:{}}))!=null?h:[];if(u.length===0)return new n(0);for(const d of u){const E=(f=l.Json.readNumber(d.location))!=null?f:0,b=t(d.value,s),_=(g=l.Json.readNumber(d.derivative))!=null?g:0;o.addPoint(E,b,_)}return o}e.fromJson=t;class n{constructor(s){this.value=s}compute(){return this.value}min(){return this.value}max(){return this.value}mapAll(){return this}calculateMinMax(){}}e.Constant=n;class i{constructor(s,a=[],o=[],u=[]){p(this,"calculatedMin",Number.NEGATIVE_INFINITY);p(this,"calculatedMax",Number.POSITIVE_INFINITY);this.coordinate=s,this.locations=a,this.values=o,this.derivatives=u}compute(s){const a=this.coordinate.compute(s),o=Vs(0,this.locations.length,N=>a<this.locations[N])-1,u=this.locations.length-1;if(o<0)return this.values[0].compute(s)+this.derivatives[0]*(a-this.locations[0]);if(o===u)return this.values[u].compute(s)+this.derivatives[u]*(a-this.locations[u]);const c=this.locations[o],h=this.locations[o+1],f=this.derivatives[o],g=this.derivatives[o+1],d=(a-c)/(h-c),E=this.values[o].compute(s),b=this.values[o+1].compute(s),_=f*(h-c)-(b-E),w=-g*(h-c)+(b-E);return ot(d,E,b)+d*(1-d)*ot(d,_,w)}min(){return this.calculatedMin}max(){return this.calculatedMax}mapAll(s){return new i(s(this.coordinate),this.locations,this.values.map(a=>a.mapAll(s)),this.derivatives)}addPoint(s,a,o=0){return this.locations.push(s),this.values.push(typeof a=="number"?new e.Constant(a):a),this.derivatives.push(o),this}calculateMinMax(){if(!l.MinMaxNumberFunction.is(this.coordinate))return;const s=this.locations.length-1;var a=Number.POSITIVE_INFINITY,o=Number.NEGATIVE_INFINITY;const u=this.coordinate.minValue(),c=this.coordinate.maxValue();for(const f of this.values)f.calculateMinMax();if(u<this.locations[0]){const f=i.linearExtend(u,this.locations,this.values[0].min(),this.derivatives,0),g=i.linearExtend(u,this.locations,this.values[0].max(),this.derivatives,0);a=Math.min(a,Math.min(f,g)),o=Math.max(o,Math.max(f,g))}if(c>this.locations[s]){const f=i.linearExtend(c,this.locations,this.values[s].min(),this.derivatives,s),g=i.linearExtend(c,this.locations,this.values[s].max(),this.derivatives,s);a=Math.min(a,Math.min(f,g)),o=Math.max(o,Math.max(f,g))}for(const f of this.values)a=Math.min(a,f.min()),o=Math.max(o,f.max());for(var h=0;h<s;++h){const f=this.locations[h],d=this.locations[h+1]-f,E=this.values[h],b=this.values[h+1],_=E.min(),w=E.max(),A=b.min(),N=b.max(),v=this.derivatives[h],R=this.derivatives[h+1];if(v!==0||R!==0){const O=v*d,k=R*d,T=Math.min(_,A),C=Math.max(w,N),I=O-N+_,M=O-A+w,x=-k+A-w,J=-k+N-_,F=Math.min(I,x),ne=Math.max(M,J);a=Math.min(a,T+.25*F),o=Math.max(o,C+.25*ne)}}this.calculatedMin=a,this.calculatedMax=o}static linearExtend(s,a,o,u,c){const h=u[c];return h==0?o:o+h*(s-a[c])}}e.MultiPoint=i})(l.CubicSpline||(l.CubicSpline={}));var mi=1e-6,ct=typeof Float32Array<"u"?Float32Array:Array,vl=Math.PI/180;function or(e){return e*vl}Math.hypot||(Math.hypot=function(){for(var e=0,t=arguments.length;t--;)e+=arguments[t]*arguments[t];return Math.sqrt(e)});function cr(){var e=new ct(9);return ct!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[5]=0,e[6]=0,e[7]=0),e[0]=1,e[4]=1,e[8]=1,e}function Al(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[4],e[4]=t[5],e[5]=t[6],e[6]=t[8],e[7]=t[9],e[8]=t[10],e}function Nl(e){var t=new ct(9);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t}function yl(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e}function kl(e,t){if(e===t){var n=t[1],i=t[2],r=t[5];e[1]=t[3],e[2]=t[6],e[3]=n,e[5]=t[7],e[6]=i,e[7]=r}else e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8];return e}function Rl(e,t){var n=t[0],i=t[1],r=t[2],s=t[3],a=t[4],o=t[5],u=t[6],c=t[7],h=t[8],f=h*a-o*c,g=-h*s+o*u,d=c*s-a*u,E=n*f+i*g+r*d;return E?(E=1/E,e[0]=f*E,e[1]=(-h*i+r*c)*E,e[2]=(o*i-r*a)*E,e[3]=g*E,e[4]=(h*n-r*u)*E,e[5]=(-o*n+r*s)*E,e[6]=d*E,e[7]=(-c*n+i*u)*E,e[8]=(a*n-i*s)*E,e):null}function Tl(e,t,n){var i=t[0],r=t[1],s=t[2],a=t[3],o=t[4],u=t[5],c=t[6],h=t[7],f=t[8],g=n[0],d=n[1],E=n[2],b=n[3],_=n[4],w=n[5],A=n[6],N=n[7],v=n[8];return e[0]=g*i+d*a+E*c,e[1]=g*r+d*o+E*h,e[2]=g*s+d*u+E*f,e[3]=b*i+_*a+w*c,e[4]=b*r+_*o+w*h,e[5]=b*s+_*u+w*f,e[6]=A*i+N*a+v*c,e[7]=A*r+N*o+v*h,e[8]=A*s+N*u+v*f,e}function Il(e,t,n){var i=t[0],r=t[1],s=t[2],a=t[3],o=t[4],u=t[5],c=t[6],h=t[7],f=t[8],g=n[0],d=n[1];return e[0]=i,e[1]=r,e[2]=s,e[3]=a,e[4]=o,e[5]=u,e[6]=g*i+d*a+c,e[7]=g*r+d*o+h,e[8]=g*s+d*u+f,e}function Ol(e,t,n){var i=n[0],r=n[1];return e[0]=i*t[0],e[1]=i*t[1],e[2]=i*t[2],e[3]=r*t[3],e[4]=r*t[4],e[5]=r*t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e}function Cl(e,t){var n=t[0],i=t[1],r=t[2],s=t[3],a=n+n,o=i+i,u=r+r,c=n*a,h=i*a,f=i*o,g=r*a,d=r*o,E=r*u,b=s*a,_=s*o,w=s*u;return e[0]=1-f-E,e[3]=h-w,e[6]=g+_,e[1]=h+w,e[4]=1-c-E,e[7]=d-b,e[2]=g-_,e[5]=d+b,e[8]=1-c-f,e}function Ml(e){return"mat3("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+")"}function Ll(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e[2]=t[2]+n[2],e[3]=t[3]+n[3],e[4]=t[4]+n[4],e[5]=t[5]+n[5],e[6]=t[6]+n[6],e[7]=t[7]+n[7],e[8]=t[8]+n[8],e}function Bl(e,t,n){return e[0]=t[0]-n[0],e[1]=t[1]-n[1],e[2]=t[2]-n[2],e[3]=t[3]-n[3],e[4]=t[4]-n[4],e[5]=t[5]-n[5],e[6]=t[6]-n[6],e[7]=t[7]-n[7],e[8]=t[8]-n[8],e}function Pl(e,t,n){return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e[3]=t[3]*n,e[4]=t[4]*n,e[5]=t[5]*n,e[6]=t[6]*n,e[7]=t[7]*n,e[8]=t[8]*n,e}var Gl=Tl,Dl=Bl;function ze(){var e=new ct(16);return ct!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0),e[0]=1,e[5]=1,e[10]=1,e[15]=1,e}function xl(e){var t=new ct(16);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function zl(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function Ei(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function Hl(e,t){if(e===t){var n=t[1],i=t[2],r=t[3],s=t[6],a=t[7],o=t[11];e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=n,e[6]=t[9],e[7]=t[13],e[8]=i,e[9]=s,e[11]=t[14],e[12]=r,e[13]=a,e[14]=o}else e[0]=t[0],e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=t[1],e[5]=t[5],e[6]=t[9],e[7]=t[13],e[8]=t[2],e[9]=t[6],e[10]=t[10],e[11]=t[14],e[12]=t[3],e[13]=t[7],e[14]=t[11],e[15]=t[15];return e}function Fl(e,t){var n=t[0],i=t[1],r=t[2],s=t[3],a=t[4],o=t[5],u=t[6],c=t[7],h=t[8],f=t[9],g=t[10],d=t[11],E=t[12],b=t[13],_=t[14],w=t[15],A=n*o-i*a,N=n*u-r*a,v=n*c-s*a,R=i*u-r*o,O=i*c-s*o,k=r*c-s*u,T=h*b-f*E,C=h*_-g*E,I=h*w-d*E,M=f*_-g*b,x=f*w-d*b,J=g*w-d*_,F=A*J-N*x+v*M+R*I-O*C+k*T;return F?(F=1/F,e[0]=(o*J-u*x+c*M)*F,e[1]=(r*x-i*J-s*M)*F,e[2]=(b*k-_*O+w*R)*F,e[3]=(g*O-f*k-d*R)*F,e[4]=(u*I-a*J-c*C)*F,e[5]=(n*J-r*I+s*C)*F,e[6]=(_*v-E*k-w*N)*F,e[7]=(h*k-g*v+d*N)*F,e[8]=(a*x-o*I+c*T)*F,e[9]=(i*I-n*x-s*T)*F,e[10]=(E*O-b*v+w*A)*F,e[11]=(f*v-h*O-d*A)*F,e[12]=(o*C-a*M-u*T)*F,e[13]=(n*M-i*C+r*T)*F,e[14]=(b*N-E*R-_*A)*F,e[15]=(h*R-f*N+g*A)*F,e):null}function Jl(e,t,n){var i=t[0],r=t[1],s=t[2],a=t[3],o=t[4],u=t[5],c=t[6],h=t[7],f=t[8],g=t[9],d=t[10],E=t[11],b=t[12],_=t[13],w=t[14],A=t[15],N=n[0],v=n[1],R=n[2],O=n[3];return e[0]=N*i+v*o+R*f+O*b,e[1]=N*r+v*u+R*g+O*_,e[2]=N*s+v*c+R*d+O*w,e[3]=N*a+v*h+R*E+O*A,N=n[4],v=n[5],R=n[6],O=n[7],e[4]=N*i+v*o+R*f+O*b,e[5]=N*r+v*u+R*g+O*_,e[6]=N*s+v*c+R*d+O*w,e[7]=N*a+v*h+R*E+O*A,N=n[8],v=n[9],R=n[10],O=n[11],e[8]=N*i+v*o+R*f+O*b,e[9]=N*r+v*u+R*g+O*_,e[10]=N*s+v*c+R*d+O*w,e[11]=N*a+v*h+R*E+O*A,N=n[12],v=n[13],R=n[14],O=n[15],e[12]=N*i+v*o+R*f+O*b,e[13]=N*r+v*u+R*g+O*_,e[14]=N*s+v*c+R*d+O*w,e[15]=N*a+v*h+R*E+O*A,e}function He(e,t,n){var i=n[0],r=n[1],s=n[2],a,o,u,c,h,f,g,d,E,b,_,w;return t===e?(e[12]=t[0]*i+t[4]*r+t[8]*s+t[12],e[13]=t[1]*i+t[5]*r+t[9]*s+t[13],e[14]=t[2]*i+t[6]*r+t[10]*s+t[14],e[15]=t[3]*i+t[7]*r+t[11]*s+t[15]):(a=t[0],o=t[1],u=t[2],c=t[3],h=t[4],f=t[5],g=t[6],d=t[7],E=t[8],b=t[9],_=t[10],w=t[11],e[0]=a,e[1]=o,e[2]=u,e[3]=c,e[4]=h,e[5]=f,e[6]=g,e[7]=d,e[8]=E,e[9]=b,e[10]=_,e[11]=w,e[12]=a*i+h*r+E*s+t[12],e[13]=o*i+f*r+b*s+t[13],e[14]=u*i+g*r+_*s+t[14],e[15]=c*i+d*r+w*s+t[15]),e}function wi(e,t,n){var i=n[0],r=n[1],s=n[2];return e[0]=t[0]*i,e[1]=t[1]*i,e[2]=t[2]*i,e[3]=t[3]*i,e[4]=t[4]*r,e[5]=t[5]*r,e[6]=t[6]*r,e[7]=t[7]*r,e[8]=t[8]*s,e[9]=t[9]*s,e[10]=t[10]*s,e[11]=t[11]*s,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function Ul(e,t,n,i){var r=i[0],s=i[1],a=i[2],o=Math.hypot(r,s,a),u,c,h,f,g,d,E,b,_,w,A,N,v,R,O,k,T,C,I,M,x,J,F,ne;return o<mi?null:(o=1/o,r*=o,s*=o,a*=o,u=Math.sin(n),c=Math.cos(n),h=1-c,f=t[0],g=t[1],d=t[2],E=t[3],b=t[4],_=t[5],w=t[6],A=t[7],N=t[8],v=t[9],R=t[10],O=t[11],k=r*r*h+c,T=s*r*h+a*u,C=a*r*h-s*u,I=r*s*h-a*u,M=s*s*h+c,x=a*s*h+r*u,J=r*a*h+s*u,F=s*a*h-r*u,ne=a*a*h+c,e[0]=f*k+b*T+N*C,e[1]=g*k+_*T+v*C,e[2]=d*k+w*T+R*C,e[3]=E*k+A*T+O*C,e[4]=f*I+b*M+N*x,e[5]=g*I+_*M+v*x,e[6]=d*I+w*M+R*x,e[7]=E*I+A*M+O*x,e[8]=f*J+b*F+N*ne,e[9]=g*J+_*F+v*ne,e[10]=d*J+w*F+R*ne,e[11]=E*J+A*F+O*ne,t!==e&&(e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e)}function $s(e,t,n){var i=Math.sin(n),r=Math.cos(n),s=t[4],a=t[5],o=t[6],u=t[7],c=t[8],h=t[9],f=t[10],g=t[11];return t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[4]=s*r+c*i,e[5]=a*r+h*i,e[6]=o*r+f*i,e[7]=u*r+g*i,e[8]=c*r-s*i,e[9]=h*r-a*i,e[10]=f*r-o*i,e[11]=g*r-u*i,e}function Ks(e,t,n){var i=Math.sin(n),r=Math.cos(n),s=t[0],a=t[1],o=t[2],u=t[3],c=t[8],h=t[9],f=t[10],g=t[11];return t!==e&&(e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=s*r-c*i,e[1]=a*r-h*i,e[2]=o*r-f*i,e[3]=u*r-g*i,e[8]=s*i+c*r,e[9]=a*i+h*r,e[10]=o*i+f*r,e[11]=u*i+g*r,e}function Wl(e,t,n){var i=Math.sin(n),r=Math.cos(n),s=t[0],a=t[1],o=t[2],u=t[3],c=t[4],h=t[5],f=t[6],g=t[7];return t!==e&&(e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=s*r+c*i,e[1]=a*r+h*i,e[2]=o*r+f*i,e[3]=u*r+g*i,e[4]=c*r-s*i,e[5]=h*r-a*i,e[6]=f*r-o*i,e[7]=g*r-u*i,e}function Vl(e,t){return e[0]=t[12],e[1]=t[13],e[2]=t[14],e}function Zl(e,t){var n=t[0],i=t[1],r=t[2],s=t[3],a=n+n,o=i+i,u=r+r,c=n*a,h=i*a,f=i*o,g=r*a,d=r*o,E=r*u,b=s*a,_=s*o,w=s*u;return e[0]=1-f-E,e[1]=h+w,e[2]=g-_,e[3]=0,e[4]=h-w,e[5]=1-c-E,e[6]=d+b,e[7]=0,e[8]=g+_,e[9]=d-b,e[10]=1-c-f,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function Yl(e,t,n,i,r){var s=1/Math.tan(t/2),a;return e[0]=s/n,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=s,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,r!=null&&r!==1/0?(a=1/(i-r),e[10]=(r+i)*a,e[14]=2*r*i*a):(e[10]=-1,e[14]=-2*i),e}function $l(e,t,n,i,r,s,a){var o=1/(t-n),u=1/(i-r),c=1/(s-a);return e[0]=-2*o,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*u,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*c,e[11]=0,e[12]=(t+n)*o,e[13]=(r+i)*u,e[14]=(a+s)*c,e[15]=1,e}function Kl(e){return"mat4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+", "+e[9]+", "+e[10]+", "+e[11]+", "+e[12]+", "+e[13]+", "+e[14]+", "+e[15]+")"}function ql(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e[2]=t[2]+n[2],e[3]=t[3]+n[3],e[4]=t[4]+n[4],e[5]=t[5]+n[5],e[6]=t[6]+n[6],e[7]=t[7]+n[7],e[8]=t[8]+n[8],e[9]=t[9]+n[9],e[10]=t[10]+n[10],e[11]=t[11]+n[11],e[12]=t[12]+n[12],e[13]=t[13]+n[13],e[14]=t[14]+n[14],e[15]=t[15]+n[15],e}function Xl(e,t,n){return e[0]=t[0]-n[0],e[1]=t[1]-n[1],e[2]=t[2]-n[2],e[3]=t[3]-n[3],e[4]=t[4]-n[4],e[5]=t[5]-n[5],e[6]=t[6]-n[6],e[7]=t[7]-n[7],e[8]=t[8]-n[8],e[9]=t[9]-n[9],e[10]=t[10]-n[10],e[11]=t[11]-n[11],e[12]=t[12]-n[12],e[13]=t[13]-n[13],e[14]=t[14]-n[14],e[15]=t[15]-n[15],e}function jl(e,t,n){return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e[3]=t[3]*n,e[4]=t[4]*n,e[5]=t[5]*n,e[6]=t[6]*n,e[7]=t[7]*n,e[8]=t[8]*n,e[9]=t[9]*n,e[10]=t[10]*n,e[11]=t[11]*n,e[12]=t[12]*n,e[13]=t[13]*n,e[14]=t[14]*n,e[15]=t[15]*n,e}var Ql=Jl,eh=Xl;function lr(){var e=new ct(3);return ct!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e}function th(e,t,n){var i=new ct(3);return i[0]=e,i[1]=t,i[2]=n,i}function nh(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e}function ih(e,t,n){var i=t[0],r=t[1],s=t[2],a=n[3]*i+n[7]*r+n[11]*s+n[15];return a=a||1,e[0]=(n[0]*i+n[4]*r+n[8]*s+n[12])/a,e[1]=(n[1]*i+n[5]*r+n[9]*s+n[13])/a,e[2]=(n[2]*i+n[6]*r+n[10]*s+n[14])/a,e}function rh(e,t){var n=e[0],i=e[1],r=e[2],s=t[0],a=t[1],o=t[2];return Math.abs(n-s)<=mi*Math.max(1,Math.abs(n),Math.abs(s))&&Math.abs(i-a)<=mi*Math.max(1,Math.abs(i),Math.abs(a))&&Math.abs(r-o)<=mi*Math.max(1,Math.abs(r),Math.abs(o))}(function(){var e=lr();return function(t,n,i,r,s,a){var o,u;for(n||(n=3),i||(i=0),r?u=Math.min(r*n+i,t.length):u=t.length,o=i;o<u;o+=n)e[0]=t[o],e[1]=t[o+1],e[2]=t[o+2],s(e,e,a),t[o]=e[0],t[o+1]=e[1],t[o+2]=e[2];return t}})();class Dn{constructor(t){p(this,"data");this.data=t!=null?t:cr()}static fromMatrix4(t){return new Dn(Al(cr(),t.data))}static fromQuat(t){return new Dn(Cl(cr(),t))}clone(){return new Dn(Nl(this.data))}copy(t){return yl(this.data,t.data),this}translate(t){return Il(this.data,this.data,Array.isArray(t)?t:[t.x,t.y]),this}scale(t){return typeof t=="number"?Pl(this.data,this.data,t):Ol(this.data,this.data,Array.isArray(t)?t:[t.x,t.y]),this}add(t){return Ll(this.data,this.data,t.data),this}sub(t){return Dl(this.data,this.data,t.data),this}mul(t){return Gl(this.data,this.data,t.data),this}transpose(){return kl(this.data,this.data),this}invert(){return Rl(this.data,this.data),this}get m00(){return this.data[0]}get m01(){return this.data[1]}get m02(){return this.data[2]}get m10(){return this.data[3]}get m11(){return this.data[4]}get m12(){return this.data[5]}get m20(){return this.data[6]}get m21(){return this.data[7]}get m22(){return this.data[8]}set m00(t){this.data[0]=t}set m01(t){this.data[1]=t}set m02(t){this.data[2]=t}set m10(t){this.data[3]=t}set m11(t){this.data[4]=t}set m12(t){this.data[5]=t}set m20(t){this.data[6]=t}set m21(t){this.data[7]=t}set m22(t){this.data[8]=t}toString(){return Ml(this.data)}}class W{constructor(t,n,i){this.x=t,this.y=n,this.z=i}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}lengthSquared(){return this.x*this.x+this.y*this.y+this.z*this.z}distance(t){return this.sub(t).length()}distanceSquared(t){return this.sub(t).lengthSquared()}abs(){return new W(Math.abs(this.x),Math.abs(this.y),Math.abs(this.z))}add(t){return new W(this.x+t.x,this.y+t.y,this.z+t.z)}sub(t){return new W(this.x-t.x,this.y-t.y,this.z-t.z)}mul(t){return new W(this.x*t.x,this.y*t.y,this.z*t.z)}div(t){return new W(this.x/t.x,this.y/t.y,this.z/t.z)}scale(t){return new W(this.x*t,this.y*t,this.z*t)}dot(t){return this.x*t.x+this.y*t.y+this.z*t.z}cross(t){const n=this.y*t.z-this.z*t.y,i=this.z*t.x-this.x*t.z,r=this.x*t.y-this.y*t.x;return new W(n,i,r)}normalize(){if(this.x==0&&this.y==0&&this.z==0)return this;const t=1/this.length();return new W(this.x*t,this.y*t,this.z*t)}components(){return[this.x,this.y,this.z]}toString(){return`[${this.x} ${this.y} ${this.z}]`}}class pi{constructor(t){p(this,"data");this.data=t!=null?t:ze()}static fromQuat(t){return new pi(Zl(ze(),t))}clone(){return new pi(xl(this.data))}translate(t){return He(this.data,this.data,Array.isArray(t)?t:t.components()),this}scale(t){return typeof t=="number"?jl(this.data,this.data,t):wi(this.data,this.data,Array.isArray(t)?t:t.components()),this}add(t){return ql(this.data,this.data,t.data),this}sub(t){return eh(this.data,this.data,t.data),this}mul(t){return Ql(this.data,this.data,t.data),this}transpose(){return Hl(this.data,this.data),this}invert(){return Fl(this.data,this.data),this}affine(){return this.scale(1/this.m33)}get m00(){return this.data[0]}get m01(){return this.data[1]}get m02(){return this.data[2]}get m03(){return this.data[3]}get m10(){return this.data[4]}get m11(){return this.data[5]}get m12(){return this.data[6]}get m13(){return this.data[7]}get m20(){return this.data[8]}get m21(){return this.data[9]}get m22(){return this.data[10]}get m23(){return this.data[11]}get m30(){return this.data[12]}get m31(){return this.data[13]}get m32(){return this.data[14]}get m33(){return this.data[15]}set m00(t){this.data[0]=t}set m01(t){this.data[1]=t}set m02(t){this.data[2]=t}set m03(t){this.data[3]=t}set m10(t){this.data[4]=t}set m11(t){this.data[5]=t}set m12(t){this.data[6]=t}set m13(t){this.data[7]=t}set m20(t){this.data[8]=t}set m21(t){this.data[9]=t}set m22(t){this.data[10]=t}set m23(t){this.data[11]=t}set m30(t){this.data[12]=t}set m31(t){this.data[13]=t}set m32(t){this.data[14]=t}set m33(t){this.data[15]=t}getTranslation(){const[t,n,i]=Vl(lr(),this.data);return new W(t,n,i)}toString(){return Kl(this.data)}}var hr={exports:{}},qs={exports:{}};(function(){var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",t={rotl:function(n,i){return n<<i|n>>>32-i},rotr:function(n,i){return n<<32-i|n>>>i},endian:function(n){if(n.constructor==Number)return t.rotl(n,8)&16711935|t.rotl(n,24)&4278255360;for(var i=0;i<n.length;i++)n[i]=t.endian(n[i]);return n},randomBytes:function(n){for(var i=[];n>0;n--)i.push(Math.floor(Math.random()*256));return i},bytesToWords:function(n){for(var i=[],r=0,s=0;r<n.length;r++,s+=8)i[s>>>5]|=n[r]<<24-s%32;return i},wordsToBytes:function(n){for(var i=[],r=0;r<n.length*32;r+=8)i.push(n[r>>>5]>>>24-r%32&255);return i},bytesToHex:function(n){for(var i=[],r=0;r<n.length;r++)i.push((n[r]>>>4).toString(16)),i.push((n[r]&15).toString(16));return i.join("")},hexToBytes:function(n){for(var i=[],r=0;r<n.length;r+=2)i.push(parseInt(n.substr(r,2),16));return i},bytesToBase64:function(n){for(var i=[],r=0;r<n.length;r+=3)for(var s=n[r]<<16|n[r+1]<<8|n[r+2],a=0;a<4;a++)r*8+a*6<=n.length*8?i.push(e.charAt(s>>>6*(3-a)&63)):i.push("=");return i.join("")},base64ToBytes:function(n){n=n.replace(/[^A-Z0-9+\/]/ig,"");for(var i=[],r=0,s=0;r<n.length;s=++r%4)s!=0&&i.push((e.indexOf(n.charAt(r-1))&Math.pow(2,-2*s+8)-1)<<s*2|e.indexOf(n.charAt(r))>>>6-s*2);return i}};qs.exports=t})();var ur={utf8:{stringToBytes:function(e){return ur.bin.stringToBytes(unescape(encodeURIComponent(e)))},bytesToString:function(e){return decodeURIComponent(escape(ur.bin.bytesToString(e)))}},bin:{stringToBytes:function(e){for(var t=[],n=0;n<e.length;n++)t.push(e.charCodeAt(n)&255);return t},bytesToString:function(e){for(var t=[],n=0;n<e.length;n++)t.push(String.fromCharCode(e[n]));return t.join("")}}},Xs=ur;/*!
 * Determine if an object is a Buffer
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */var sh=function(e){return e!=null&&(js(e)||ah(e)||!!e._isBuffer)};function js(e){return!!e.constructor&&typeof e.constructor.isBuffer=="function"&&e.constructor.isBuffer(e)}function ah(e){return typeof e.readFloatLE=="function"&&typeof e.slice=="function"&&js(e.slice(0,0))}(function(){var e=qs.exports,t=Xs.utf8,n=sh,i=Xs.bin,r=function(s,a){s.constructor==String?a&&a.encoding==="binary"?s=i.stringToBytes(s):s=t.stringToBytes(s):n(s)?s=Array.prototype.slice.call(s,0):!Array.isArray(s)&&s.constructor!==Uint8Array&&(s=s.toString());for(var o=e.bytesToWords(s),u=s.length*8,c=1732584193,h=-271733879,f=-1732584194,g=271733878,d=0;d<o.length;d++)o[d]=(o[d]<<8|o[d]>>>24)&16711935|(o[d]<<24|o[d]>>>8)&4278255360;o[u>>>5]|=128<<u%32,o[(u+64>>>9<<4)+14]=u;for(var E=r._ff,b=r._gg,_=r._hh,w=r._ii,d=0;d<o.length;d+=16){var A=c,N=h,v=f,R=g;c=E(c,h,f,g,o[d+0],7,-680876936),g=E(g,c,h,f,o[d+1],12,-389564586),f=E(f,g,c,h,o[d+2],17,606105819),h=E(h,f,g,c,o[d+3],22,-1044525330),c=E(c,h,f,g,o[d+4],7,-176418897),g=E(g,c,h,f,o[d+5],12,1200080426),f=E(f,g,c,h,o[d+6],17,-1473231341),h=E(h,f,g,c,o[d+7],22,-45705983),c=E(c,h,f,g,o[d+8],7,1770035416),g=E(g,c,h,f,o[d+9],12,-1958414417),f=E(f,g,c,h,o[d+10],17,-42063),h=E(h,f,g,c,o[d+11],22,-1990404162),c=E(c,h,f,g,o[d+12],7,1804603682),g=E(g,c,h,f,o[d+13],12,-40341101),f=E(f,g,c,h,o[d+14],17,-1502002290),h=E(h,f,g,c,o[d+15],22,1236535329),c=b(c,h,f,g,o[d+1],5,-165796510),g=b(g,c,h,f,o[d+6],9,-1069501632),f=b(f,g,c,h,o[d+11],14,643717713),h=b(h,f,g,c,o[d+0],20,-373897302),c=b(c,h,f,g,o[d+5],5,-701558691),g=b(g,c,h,f,o[d+10],9,38016083),f=b(f,g,c,h,o[d+15],14,-660478335),h=b(h,f,g,c,o[d+4],20,-405537848),c=b(c,h,f,g,o[d+9],5,568446438),g=b(g,c,h,f,o[d+14],9,-1019803690),f=b(f,g,c,h,o[d+3],14,-187363961),h=b(h,f,g,c,o[d+8],20,1163531501),c=b(c,h,f,g,o[d+13],5,-1444681467),g=b(g,c,h,f,o[d+2],9,-51403784),f=b(f,g,c,h,o[d+7],14,1735328473),h=b(h,f,g,c,o[d+12],20,-1926607734),c=_(c,h,f,g,o[d+5],4,-378558),g=_(g,c,h,f,o[d+8],11,-2022574463),f=_(f,g,c,h,o[d+11],16,1839030562),h=_(h,f,g,c,o[d+14],23,-35309556),c=_(c,h,f,g,o[d+1],4,-1530992060),g=_(g,c,h,f,o[d+4],11,1272893353),f=_(f,g,c,h,o[d+7],16,-155497632),h=_(h,f,g,c,o[d+10],23,-1094730640),c=_(c,h,f,g,o[d+13],4,681279174),g=_(g,c,h,f,o[d+0],11,-358537222),f=_(f,g,c,h,o[d+3],16,-722521979),h=_(h,f,g,c,o[d+6],23,76029189),c=_(c,h,f,g,o[d+9],4,-640364487),g=_(g,c,h,f,o[d+12],11,-421815835),f=_(f,g,c,h,o[d+15],16,530742520),h=_(h,f,g,c,o[d+2],23,-995338651),c=w(c,h,f,g,o[d+0],6,-198630844),g=w(g,c,h,f,o[d+7],10,1126891415),f=w(f,g,c,h,o[d+14],15,-1416354905),h=w(h,f,g,c,o[d+5],21,-57434055),c=w(c,h,f,g,o[d+12],6,1700485571),g=w(g,c,h,f,o[d+3],10,-1894986606),f=w(f,g,c,h,o[d+10],15,-1051523),h=w(h,f,g,c,o[d+1],21,-2054922799),c=w(c,h,f,g,o[d+8],6,1873313359),g=w(g,c,h,f,o[d+15],10,-30611744),f=w(f,g,c,h,o[d+6],15,-1560198380),h=w(h,f,g,c,o[d+13],21,1309151649),c=w(c,h,f,g,o[d+4],6,-145523070),g=w(g,c,h,f,o[d+11],10,-1120210379),f=w(f,g,c,h,o[d+2],15,718787259),h=w(h,f,g,c,o[d+9],21,-343485551),c=c+A>>>0,h=h+N>>>0,f=f+v>>>0,g=g+R>>>0}return e.endian([c,h,f,g])};r._ff=function(s,a,o,u,c,h,f){var g=s+(a&o|~a&u)+(c>>>0)+f;return(g<<h|g>>>32-h)+a},r._gg=function(s,a,o,u,c,h,f){var g=s+(a&u|o&~u)+(c>>>0)+f;return(g<<h|g>>>32-h)+a},r._hh=function(s,a,o,u,c,h,f){var g=s+(a^o^u)+(c>>>0)+f;return(g<<h|g>>>32-h)+a},r._ii=function(s,a,o,u,c,h,f){var g=s+(o^(a|~u))+(c>>>0)+f;return(g<<h|g>>>32-h)+a},r._blocksize=16,r._digestsize=16,hr.exports=function(s,a){if(s==null)throw new Error("Illegal argument "+s);var o=e.wordsToBytes(r(s,a));return a&&a.asBytes?o:a&&a.asString?i.bytesToString(o):e.bytesToHex(o)}})();const Te=class{constructor(t){p(this,"seed",BigInt(0));this.setSeed(t)}static fromLargeFeatureSeed(t,n,i){const r=new Te(t),s=r.nextLong(),a=r.nextLong(),o=BigInt(n)*s^BigInt(i)*a^t;return r.setSeed(o),r}static fromLargeFeatureWithSalt(t,n,i,r){const s=BigInt(n)*BigInt("341873128712")+BigInt(i)*BigInt("132897987541")+t+BigInt(r);return new Te(s)}fork(){return new Te(this.nextLong())}forkPositional(){return new Qs(this.nextLong())}setSeed(t){this.seed=(t^Te.MULTIPLIER)&Te.MODULUS_MASK}advance(){this.seed=this.seed*Te.MULTIPLIER+Te.INCREMENT&Te.MODULUS_MASK}consume(t){for(let n=0;n<t;n+=1)this.advance()}next(t){this.advance();const n=Number(this.seed>>BigInt(Te.MODULUS_BITS-t));return n>2147483647?n-4294967296:n}nextInt(t){if(t===void 0)return this.next(32);if((t&t-1)==0)return Number(BigInt(t)*BigInt(this.next(31))>>BigInt(31));let n,i;for(;(n=this.next(31))-(i=n%t)+(t-1)<0;);return i}nextLong(){return(BigInt(this.next(32))<<BigInt(32))+BigInt(this.next(32))}nextFloat(){return this.next(24)*Te.FLOAT_MULTIPLIER}nextDouble(){const t=this.next(30);return this.advance(),t*Te.DOUBLE_MULTIPLIER}};let ce=Te;p(ce,"MODULUS_BITS",48),p(ce,"MODULUS_MASK",BigInt("281474976710655")),p(ce,"MULTIPLIER",BigInt("25214903917")),p(ce,"INCREMENT",BigInt("11")),p(ce,"FLOAT_MULTIPLIER",1/Math.pow(2,24)),p(ce,"DOUBLE_MULTIPLIER",1/Math.pow(2,30));class Qs{constructor(t){this.seed=t}at(t,n,i){const r=sr(t,n,i);return new ce(r^this.seed)}fromHashOf(t){const n=hr.exports(t,{asBytes:!0}),i=di(n[0],n[1],n[2],n[3],n[4],n[5],n[6],n[7]);return new ce(i^this.seed)}seedKey(){return[this.seed,BigInt(0)]}}const H=class{constructor(t){p(this,"seed",[BigInt(0),BigInt(0)]);this.seed=t}static create(t){return new H(H.upgradeSeedTo128bit(t))}static mixStafford13(t){return t=(t^t>>H.BIGINT_30)*H.STAFFORD_1&H.MAX_ULONG,t=(t^t>>H.BIGINT_27)*H.STAFFORD_2&H.MAX_ULONG,(t^t>>H.BIGINT_31)&H.MAX_ULONG}static upgradeSeedTo128bit(t){t<0&&(t+=H.POW2_60);const n=t^H.SILVER_RATIO_64,i=n+H.GOLDEN_RATIO_64&H.MAX_ULONG;return[H.mixStafford13(n),H.mixStafford13(i)]}static rotateLeft(t,n){return t<<n&H.MAX_ULONG|t>>H.BIGINT_64-n}setSeed(t){this.seed=H.upgradeSeedTo128bit(t)}fork(){return new H([this.next(),this.next()])}forkPositional(){return new ea(this.next(),this.next())}next(){const t=this.seed[0];let n=this.seed[1];const i=H.rotateLeft(t+n&H.MAX_ULONG,H.BIGINT_17)+t&H.MAX_ULONG;return n^=t,this.seed=[H.rotateLeft(t,H.BIGINT_49)^n^n<<H.BIGINT_21&H.MAX_ULONG,H.rotateLeft(n,H.BIGINT_28)],i}nextLong(){let t=this.next();return t>H.POW2_63&&(t-=H.POW2_60),t}consume(t){let n=this.seed[0],i=this.seed[1];for(let r=0;r<t;r+=1)i^=n,n=H.rotateLeft(n,H.BIGINT_49)^i^i<<H.BIGINT_21,i=H.rotateLeft(i,H.BIGINT_28);this.seed=[n,i]}nextBits(t){return this.next()>>BigInt(64-t)}nextInt(t){let n=this.next()&H.MAX_UINT;if(t){const i=BigInt(t);let r=n*i,s=r&H.MAX_UINT;if(s<i){const o=((~i&H.MAX_UINT)+H.BIGINT_1)%i;for(;s<o;)n=this.next()&H.MAX_UINT,r=n*i,s=r&H.MAX_UINT}const a=r>>H.BIGINT_32;return Number(a)}else{let i=Number(n);return i>=2147483648&&(i-=4294967296),i}}nextFloat(){return Number(this.nextBits(24))*H.FLOAT_MULTIPLIER}nextDouble(){return Number(this.nextBits(53))*H.DOUBLE_MULTIPLIER}parityConfigString(){return"seedLo: "+this.seed[0]+", seedHi: "+this.seed[1]}};let te=H;p(te,"SILVER_RATIO_64",BigInt("7640891576956012809")),p(te,"GOLDEN_RATIO_64",BigInt("-7046029254386353131")),p(te,"FLOAT_MULTIPLIER",1/Math.pow(2,24)),p(te,"DOUBLE_MULTIPLIER",11102230246251565e-32),p(te,"BIGINT_1",BigInt(1)),p(te,"BIGINT_17",BigInt(17)),p(te,"BIGINT_21",BigInt(21)),p(te,"BIGINT_27",BigInt(27)),p(te,"BIGINT_28",BigInt(28)),p(te,"BIGINT_30",BigInt(30)),p(te,"BIGINT_31",BigInt(31)),p(te,"BIGINT_32",BigInt(32)),p(te,"BIGINT_49",BigInt(49)),p(te,"BIGINT_64",BigInt(64)),p(te,"STAFFORD_1",BigInt("-4658895280553007687")),p(te,"STAFFORD_2",BigInt("-7723592293110705685")),p(te,"MAX_ULONG",BigInt("0xFFFFFFFFFFFFFFFF")),p(te,"POW2_60",BigInt("0x10000000000000000")),p(te,"POW2_63",BigInt("0x8000000000000000")),p(te,"MAX_UINT",BigInt(4294967295));class ea{constructor(t,n){this.seedLo=t,this.seedHi=n}at(t,n,i){const s=sr(t,n,i)^this.seedLo;return new te([s,this.seedHi])}fromHashOf(t){const n=hr.exports(t,{asBytes:!0}),i=di(n[0],n[1],n[2],n[3],n[4],n[5],n[6],n[7]),r=di(n[8],n[9],n[10],n[11],n[12],n[13],n[14],n[15]);return new te([i^this.seedLo,r^this.seedHi])}seedKey(){return[this.seedLo,this.seedHi]}}const Qe=class{constructor(t){p(this,"p");p(this,"xo");p(this,"yo");p(this,"zo");this.xo=t.nextDouble()*256,this.yo=t.nextDouble()*256,this.zo=t.nextDouble()*256,this.p=Array(256);for(let n=0;n<256;n+=1)this.p[n]=n;for(let n=0;n<256;n+=1){const i=t.nextInt(256-n),r=this.p[n];this.p[n]=this.p[n+i],this.p[n+i]=r}}sample2D(t,n){let i,r,s;const a=(t+n)*Qe.F2,o=Math.floor(t+a),u=o-(i=(o+(r=Math.floor(n+a)))*Qe.G2),c=t-u;let h,f;c>(s=n-(r-i))?(h=1,f=0):(h=0,f=1);const g=c-h+Qe.G2,d=s-f+Qe.G2,E=c-1+2*Qe.G2,b=s-1+2*Qe.G2,_=o&255,w=r&255,A=this.P(_+this.P(w))%12,N=this.P(_+h+this.P(w+f))%12,v=this.P(_+1+this.P(w+1))%12,R=this.getCornerNoise3D(A,c,s,0,.5),O=this.getCornerNoise3D(N,g,d,0,.5),k=this.getCornerNoise3D(v,E,b,0,.5);return 70*(R+O+k)}sample(t,n,i){const r=(t+n+i)*.3333333333333333,s=Math.floor(t+r),a=Math.floor(n+r),o=Math.floor(i+r),u=(s+a+o)*.16666666666666666,c=t-(s-u),h=n-(a-u),f=i-(o-u);let g,d,E,b,_,w;c>=h?h>=f?(g=1,d=0,E=0,b=1,_=1,w=0):c>=f?(g=1,d=0,E=0,b=1,_=0,w=1):(g=0,d=0,E=1,b=1,_=0,w=1):h<f?(g=0,d=0,E=1,b=0,_=1,w=1):c<f?(g=0,d=1,E=0,b=0,_=1,w=1):(g=0,d=1,E=0,b=1,_=1,w=0);const A=c-g+.16666666666666666,N=h-d+.16666666666666666,v=f-E+.16666666666666666,R=c-b+.3333333333333333,O=h-_+.3333333333333333,k=f-w+.3333333333333333,T=c-.5,C=h-.5,I=f-.5,M=s&255,x=a&255,J=o&255,F=this.P(M+this.P(x+this.P(J)))%12,ne=this.P(M+g+this.P(x+d+this.P(J+E)))%12,se=this.P(M+b+this.P(x+_+this.P(J+w)))%12,le=this.P(M+1+this.P(x+1+this.P(J+1)))%12,be=this.getCornerNoise3D(F,c,h,f,.6),ie=this.getCornerNoise3D(ne,A,N,v,.6),y=this.getCornerNoise3D(se,R,O,k,.6),S=this.getCornerNoise3D(le,T,C,I,.6);return 32*(be+ie+y+S)}P(t){return this.p[t&255]}getCornerNoise3D(t,n,i,r,s){let a,o=s-n*n-i*i-r*r;return o<0?a=0:(o*=o,a=o*o*Qe.gradDot(t,n,i,r)),a}static gradDot(t,n,i,r){const s=Qe.GRADIENT[t&15];return s[0]*n+s[1]*i+s[2]*r}};let pe=Qe;p(pe,"GRADIENT",[[1,1,0],[-1,1,0],[1,-1,0],[-1,-1,0],[1,0,1],[-1,0,1],[1,0,-1],[-1,0,-1],[0,1,1],[0,-1,1],[0,1,-1],[0,-1,-1],[1,1,0],[0,-1,1],[-1,1,0],[0,-1,-1]]),p(pe,"F2",.5*(Math.sqrt(3)-1)),p(pe,"G2",(3-Math.sqrt(3))/6);class fr{constructor(t){p(this,"p");p(this,"xo");p(this,"yo");p(this,"zo");this.xo=t.nextDouble()*256,this.yo=t.nextDouble()*256,this.zo=t.nextDouble()*256,this.p=Array(256);for(let n=0;n<256;n+=1)this.p[n]=n>127?n-256:n;for(let n=0;n<256;n+=1){const i=t.nextInt(256-n),r=this.p[n];this.p[n]=this.p[n+i],this.p[n+i]=r}}sample(t,n,i,r=0,s=0){const a=t+this.xo,o=n+this.yo,u=i+this.zo,c=Math.floor(a),h=Math.floor(o),f=Math.floor(u),g=a-c,d=o-h,E=u-f;let b=0;if(r!==0){const _=s>=0&&s<d?s:d;b=Math.floor(_/r+1e-7)*r}return this.sampleAndLerp(c,h,f,g,d-b,E,d)}sampleAndLerp(t,n,i,r,s,a,o){const u=this.P(t),c=this.P(t+1),h=this.P(u+n),f=this.P(u+n+1),g=this.P(c+n),d=this.P(c+n+1),E=pe.gradDot(this.P(h+i),r,s,a),b=pe.gradDot(this.P(g+i),r-1,s,a),_=pe.gradDot(this.P(f+i),r,s-1,a),w=pe.gradDot(this.P(d+i),r-1,s-1,a),A=pe.gradDot(this.P(h+i+1),r,s,a-1),N=pe.gradDot(this.P(g+i+1),r-1,s,a-1),v=pe.gradDot(this.P(f+i+1),r,s-1,a-1),R=pe.gradDot(this.P(d+i+1),r-1,s-1,a-1),O=fi(r),k=fi(o),T=fi(a);return Us(O,k,T,E,b,_,w,A,N,v,R)}P(t){return this.p[t&255]&255}}class Se{constructor(t,n,i){p(this,"noiseLevels");p(this,"amplitudes");p(this,"lowestFreqInputFactor");p(this,"lowestFreqValueFactor");p(this,"maxValue");if(t instanceof te){const r=t.forkPositional();this.noiseLevels=Array(i.length);for(let s=0;s<i.length;s++)if(i[s]!==0){const a=n+s;this.noiseLevels[s]=new fr(r.fromHashOf("octave_"+a))}}else{if(1-n<i.length)throw new Error("Positive octaves are not allowed when using LegacyRandom");this.noiseLevels=Array(i.length);for(let r=-n;r>=0;r-=1)r<i.length&&i[r]!==0?this.noiseLevels[r]=new fr(t):t.consume(262)}this.amplitudes=i,this.lowestFreqInputFactor=Math.pow(2,n),this.lowestFreqValueFactor=Math.pow(2,i.length-1)/(Math.pow(2,i.length)-1),this.maxValue=this.edgeValue(2)}sample(t,n,i,r=0,s=0,a=!1){let o=0,u=this.lowestFreqInputFactor,c=this.lowestFreqValueFactor;for(let h=0;h<this.noiseLevels.length;h+=1){const f=this.noiseLevels[h];f&&(o+=this.amplitudes[h]*c*f.sample(Se.wrap(t*u),a?-f.yo:Se.wrap(n*u),Se.wrap(i*u),r*u,s*u)),u*=2,c/=2}return o}getOctaveNoise(t){return this.noiseLevels[this.noiseLevels.length-1-t]}edgeValue(t){let n=0,i=this.lowestFreqValueFactor;for(let r=0;r<this.noiseLevels.length;r+=1)this.noiseLevels[r]&&(n+=this.amplitudes[r]*t*i),i/=2;return n}static wrap(t){return t-Math.floor(t/33554432+.5)*33554432}}class ta{constructor(t,n,i,r,s,a){p(this,"minLimitNoise");p(this,"maxLimitNoise");p(this,"mainNoise");p(this,"xzMultiplier");p(this,"yMultiplier");p(this,"maxValue");this.xzScale=n,this.yScale=i,this.xzFactor=r,this.yFactor=s,this.smearScaleMultiplier=a,this.minLimitNoise=new Se(t,-15,[1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0]),this.maxLimitNoise=new Se(t,-15,[1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0]),this.mainNoise=new Se(t,-7,[1,1,1,1,1,0,0,0]),this.xzMultiplier=684.412*n,this.yMultiplier=684.412*i,this.maxValue=this.minLimitNoise.edgeValue(this.yScale+2)}sample(t,n,i){const r=t*this.xzMultiplier,s=n*this.yMultiplier,a=i*this.xzMultiplier,o=r/this.xzFactor,u=s/this.yFactor,c=a/this.xzFactor,h=this.yMultiplier*this.smearScaleMultiplier,f=h/this.yFactor;let g,d=0,E=1;for(let w=0;w<8;w+=1){if(g=this.mainNoise.getOctaveNoise(w),g){const A=Se.wrap(o*E),N=Se.wrap(u*E),v=Se.wrap(c*E);d+=g.sample(A,N,v,f*E,u*E)/E}E/=2}d=(d/10+1)/2,E=1;let b=0,_=0;for(let w=0;w<16;w+=1){const A=Se.wrap(r*E),N=Se.wrap(s*E),v=Se.wrap(a*E),R=h*E;d<1&&(g=this.minLimitNoise.getOctaveNoise(w))&&(b+=g.sample(A,N,v,R,s*E)/E),d>0&&(g=this.maxLimitNoise.getOctaveNoise(w))&&(_+=g.sample(A,N,v,R,s*E)/E),E/=2}return ui(b/512,_/512,d)/128}}const Jn=class{constructor(t,{firstOctave:n,amplitudes:i}){p(this,"valueFactor");p(this,"first");p(this,"second");p(this,"maxValue");this.first=new Se(t,n,i),this.second=new Se(t,n,i);let r=1/0,s=-1/0;for(let o=0;o<i.length;o+=1)i[o]!==0&&(r=Math.min(r,o),s=Math.max(s,o));const a=.1*(1+1/(s-r+1));this.valueFactor=1/6/a,this.maxValue=(this.first.maxValue+this.second.maxValue)*this.valueFactor}sample(t,n,i){const r=t*Jn.INPUT_FACTOR,s=n*Jn.INPUT_FACTOR,a=i*Jn.INPUT_FACTOR;return(this.first.sample(t,n,i)+this.second.sample(r,s,a))*this.valueFactor}};let lt=Jn;p(lt,"INPUT_FACTOR",1.0181268882175227),l.NoiseParameters=void 0,(e=>{function t(i,r){return{firstOctave:i,amplitudes:r}}e.create=t;function n(i){var s,a,o;const r=(s=l.Json.readObject(i))!=null?s:{};return{firstOctave:(a=l.Json.readInt(r.firstOctave))!=null?a:0,amplitudes:(o=l.Json.readArray(r.amplitudes,u=>{var c;return(c=l.Json.readNumber(u))!=null?c:0}))!=null?o:[]}}e.fromJson=n})(l.NoiseParameters||(l.NoiseParameters={}));class oh{constructor(t,n){p(this,"noiseLevels");p(this,"highestFreqInputFactor");p(this,"highestFreqValueFactor");const i=n[n.length-1],s=-n[0]+i+1,a=new Set(n),o=new pe(t);this.noiseLevels=Array(s),i>=0&&i<s&&a.has(0)&&(this.noiseLevels[i]=o);for(let u=i+1;u<s;u+=1)u>=0&&a.has(i-u)?this.noiseLevels[u]=new pe(t):t.consume(262);if(i>0)throw new Error("Positive octaves are not allowed");this.highestFreqInputFactor=Math.pow(2,i),this.highestFreqValueFactor=1/(Math.pow(2,s)-1)}sample(t,n,i){let r=0,s=this.highestFreqInputFactor,a=this.highestFreqValueFactor;for(let o=0;o<this.noiseLevels.length;o+=1){const u=this.noiseLevels[o];u&&(r+=a*u.sample2D(t*s+(i?u.xo:0),n*s+(i?u.yo:0))),s/=2,a*=2}return r}}const Jt=[124/255,189/255,107/255],ch=Ee(6396257),lh=Ee(8431445),nn=Ee(4764952),Si=Ee(4159204),na=Ee(8431445),hh=Ee(2129968),uh=e=>{const t=e/15,n=t*.6+(t>0?.4:.3),i=Nt(t*t*.7-.5,0,1),r=Nt(t*t*.6-.7,0,1);return[n,i,r]},ia=e=>[e/8,1-e/32,e*64],xn={large_fern:()=>Jt,tall_grass:()=>Jt,grass_block:()=>Jt,fern:()=>Jt,grass:()=>Jt,potted_fern:()=>Jt,spruce_leaves:()=>ch,birch_leaves:()=>lh,oak_leaves:()=>nn,jungle_leaves:()=>nn,acacia_leaves:()=>nn,dark_oak_leaves:()=>nn,vine:()=>nn,mangrove_leaves:()=>nn,water:()=>Si,bubble_column:()=>Si,cauldron:()=>Si,water_cauldron:()=>Si,redstone_wire:e=>{var t;return uh(parseInt((t=e.power)!=null?t:"0"))},sugar_cane:()=>Jt,attached_melon_stem:()=>na,attached_pumpkin_stem:()=>na,melon_stem:e=>{var t;return ia(parseInt((t=e.age)!=null?t:"0"))},pumpkin_stem:e=>{var t;return ia(parseInt((t=e.age)!=null?t:"0"))},lily_pad:()=>hh};l.Cull=void 0,(e=>{function t(i,r,s){let{up:a,down:o,north:u,east:c,south:h,west:f}=i;switch(s){case 90:[u,c,h,f]=[c,h,f,u];break;case 180:[u,c,h,f]=[h,f,u,c];break;case 270:[u,c,h,f]=[f,u,c,h]}switch(r){case 90:[a,u,o,h]=[u,o,h,a];break;case 180:[a,u,o,h]=[o,h,a,u];break;case 270:[a,u,o,h]=[h,a,u,o]}return{up:a,down:o,north:u,east:c,south:h,west:f}}e.rotate=t;function n(){return Object.create(null)}e.none=n})(l.Cull||(l.Cull={}));const Ue=class{constructor(t,n,i,r,s){this.pos=t,this.color=n,this.texture=i,this.normal=r,this.blockPos=s}transform(t){return Ue.VEC[0]=this.pos.x,Ue.VEC[1]=this.pos.y,Ue.VEC[2]=this.pos.z,ih(Ue.VEC,Ue.VEC,t),this.pos=new W(Ue.VEC[0],Ue.VEC[1],Ue.VEC[2]),this}static fromPos(t){return new Ue(t,[0,0,0],[0,0],void 0,void 0)}};let Me=Ue;p(Me,"VEC",lr());class bi{constructor(t,n){this.v1=t,this.v2=n}vertices(){return[this.v1,this.v2]}forEach(t){return t(this.v1),t(this.v2),this}transform(t){return this.forEach(n=>n.transform(t)),this}setColor(t){return this.forEach(n=>n.color=t),this}toString(){return`Line(${this.v1.pos.toString()}, ${this.v2.pos.toString()})`}static fromPoints(t,n){return new bi(Me.fromPos(t),Me.fromPos(n))}}class Ne{constructor(t=[],n=[]){p(this,"posBuffer");p(this,"colorBuffer");p(this,"textureBuffer");p(this,"normalBuffer");p(this,"blockPosBuffer");p(this,"indexBuffer");p(this,"linePosBuffer");p(this,"lineColorBuffer");this.quads=t,this.lines=n}clear(){return this.quads=[],this.lines=[],this}isEmpty(){return this.quads.length===0&&this.lines.length===0}quadVertices(){return this.quads.length*4}quadIndices(){return this.quads.length*6}lineVertices(){return this.lines.length*2}merge(t){return this.quads=this.quads.concat(t.quads),this.lines=this.lines.concat(t.lines),this}addLine(t,n,i,r,s,a,o){const u=new bi(Me.fromPos(new W(t,n,i)),Me.fromPos(new W(r,s,a))).setColor(o);return this.lines.push(u),this}addLineCube(t,n,i,r,s,a,o){return this.addLine(t,n,i,t,n,a,o),this.addLine(r,n,i,r,n,a,o),this.addLine(t,n,i,r,n,i,o),this.addLine(t,n,a,r,n,a,o),this.addLine(t,n,i,t,s,i,o),this.addLine(r,n,i,r,s,i,o),this.addLine(t,n,a,t,s,a,o),this.addLine(r,n,a,r,s,a,o),this.addLine(t,s,i,t,s,a,o),this.addLine(r,s,i,r,s,a,o),this.addLine(t,s,i,r,s,i,o),this.addLine(t,s,a,r,s,a,o),this}transform(t){for(const n of this.quads)n.transform(t);return this}rebuild(t,n){const i=(s,a,o)=>{var u;if(s||(s=(u=t.createBuffer())!=null?u:void 0),!s)throw new Error("Cannot create new buffer");return t.bindBuffer(a,s),t.bufferData(a,o,t.DYNAMIC_DRAW),s},r=(s,a,o)=>{if(s.length===0){a&&t.deleteBuffer(a);return}const u=s.flatMap(c=>c.vertices().flatMap(h=>{const f=o(h);if(!f)throw new Error("Missing vertex component");return f}));return i(a,t.ARRAY_BUFFER,new Float32Array(u))};return n.pos&&(this.posBuffer=r(this.quads,this.posBuffer,s=>s.pos.components()),this.linePosBuffer=r(this.lines,this.linePosBuffer,s=>s.pos.components())),n.color&&(this.colorBuffer=r(this.quads,this.colorBuffer,s=>s.color),this.lineColorBuffer=r(this.lines,this.lineColorBuffer,s=>s.color)),n.texture&&(this.textureBuffer=r(this.quads,this.textureBuffer,s=>s.texture)),n.normal&&(this.normalBuffer=r(this.quads,this.normalBuffer,s=>{var a;return(a=s.normal)==null?void 0:a.components()})),n.blockPos&&(this.blockPosBuffer=r(this.quads,this.blockPosBuffer,s=>{var a;return(a=s.blockPos)==null?void 0:a.components()})),this.quads.length===0?(this.indexBuffer&&t.deleteBuffer(this.indexBuffer),this.indexBuffer=void 0):this.indexBuffer=i(this.indexBuffer,t.ELEMENT_ARRAY_BUFFER,new Uint16Array(this.quads.flatMap((s,a)=>[4*a,4*a+1,4*a+2,a*4,4*a+2,4*a+3],!0))),this}}class vi{constructor(t,n,i){this.id=t,this.variants=n,this.multipart=i,this.variants=n}getModelVariants(t){if(this.variants){const n=Object.keys(this.variants).filter(r=>this.matchesVariant(r,t));if(n.length===0)return[];const i=this.variants[n[0]];return[Array.isArray(i)?i[0]:i]}else if(this.multipart)return this.multipart.filter(i=>i.when?this.matchesCase(i.when,t):!0).map(i=>Array.isArray(i.apply)?i.apply[0]:i.apply);return[]}getMesh(t,n,i,r,s){var c,h,f,g,d;const a=this.getModelVariants(n),o=new Ne;for(const E of a){const b=l.Cull.rotate(s,(c=E.x)!=null?c:0,(h=E.y)!=null?h:0),_=r.getBlockModel(G.parse(E.model));if(!_)throw new Error(`Cannot find block model ${E.model}`);const w=(f=xn[t.path])==null?void 0:f.call(xn,n),A=_.getMesh(i,b,w);if(E.x||E.y){const N=ze();Ei(N),He(N,N,[8,8,8]),Ks(N,N,-or((g=E.y)!=null?g:0)),$s(N,N,-or((d=E.x)!=null?d:0)),He(N,N,[-8,-8,-8]),A.transform(N)}o.merge(A)}const u=ze();return Ei(u),wi(u,u,[.0625,.0625,.0625]),o.transform(u)}matchesVariant(t,n){return t.split(",").every(i=>{const[r,s]=i.split("=");return n[r]===s})}matchesCase(t,n){if(Array.isArray(t.OR))return t.OR.some(r=>this.matchesCase(r,n));const i=t;return Object.keys(i).every(r=>i[r].split("|").includes(n[r]))}static fromJson(t,n){return new vi(G.parse(t),n.variants,n.multipart)}}class Xe{constructor(t,n,i,r){this.v1=t,this.v2=n,this.v3=i,this.v4=r}vertices(){return[this.v1,this.v2,this.v3,this.v4]}forEach(t){return t(this.v1),t(this.v2),t(this.v3),t(this.v4),this}transform(t){return this.forEach(n=>n.transform(t)),this}normal(){const t=this.v2.pos.sub(this.v1.pos),n=this.v3.pos.sub(this.v1.pos);return t.cross(n).normalize()}reverse(){return[this.v1,this.v2,this.v3,this.v4]=[this.v4,this.v3,this.v2,this.v1],this}setColor(t){return this.forEach(n=>n.color=t),this}setTexture(t){return this.v1.texture=[t[0],t[1]],this.v2.texture=[t[2],t[3]],this.v3.texture=[t[4],t[5]],this.v4.texture=[t[6],t[7]],this}toString(){return`Quad(${this.v1.pos.toString()}, ${this.v2.pos.toString()}, ${this.v3.pos.toString()}, ${this.v4.pos.toString()})`}static fromPoints(t,n,i,r){return new Xe(Me.fromPos(t),Me.fromPos(n),Me.fromPos(i),Me.fromPos(r))}}const fh={0:[0,3,2,3,2,1,0,1],90:[2,3,2,1,0,1,0,3],180:[2,1,0,1,0,3,2,3],270:[0,1,0,3,2,3,2,1]},dh={x:[1,0,0],y:[0,1,0],z:[0,0,1]},rn=1.41421356237,gh={x:[1,rn,rn],y:[rn,1,rn],z:[rn,rn,1]},ln=class{constructor(t,n,i,r,s,a){p(this,"generationMarker",!1);this.id=t,this.parent=n,this.textures=i,this.elements=r,this.display=s,this.guiLight=a}getDisplayMesh(t,n,i){var o;const r=this.getMesh(n,l.Cull.none(),i),s=(o=this.display)==null?void 0:o[t],a=ze();return Ei(a),He(a,a,[8,8,8]),s!=null&&s.translation&&He(a,a,s.translation),s!=null&&s.rotation&&($s(a,a,s.rotation[0]*Math.PI/180),Ks(a,a,s.rotation[1]*Math.PI/180),Wl(a,a,-s.rotation[2]*Math.PI/180)),s!=null&&s.scale&&wi(a,a,s.scale),He(a,a,[-8,-8,-8]),r.transform(a),r}getMesh(t,n,i){var a;const r=new Ne,s=o=>i===void 0?[1,1,1]:o===void 0||o<0?[1,1,1]:typeof i=="function"?i(o):i;for(const o of(a=this.elements)!=null?a:[])r.merge(this.getElementMesh(o,t,n,s));return r}getElementMesh(t,n,i,r){var E,b,_,w,A,N,v,R,O,k,T,C;const s=new Ne,[a,o,u]=t.from,[c,h,f]=t.to,g=(I,M,x)=>{var z,Q,We,Ve,Pe,de,ge,_e,Tt;const J=Xe.fromPoints(new W(x[0],x[1],x[2]),new W(x[3],x[4],x[5]),new W(x[6],x[7],x[8]),new W(x[9],x[10],x[11])),F=r(I.tintindex);J.setColor(F);const[ne,se,le,be]=n.getTextureUV(this.getTexture(I.texture)),ie=(le-ne)/16,y=(be-se)/16,S=ie/16,L=y/16;M[0]=((Q=(z=I.uv)==null?void 0:z[0])!=null?Q:M[0])*ie+S,M[1]=((Ve=(We=I.uv)==null?void 0:We[1])!=null?Ve:M[1])*y+L,M[2]=((de=(Pe=I.uv)==null?void 0:Pe[2])!=null?de:M[2])*ie-S,M[3]=((_e=(ge=I.uv)==null?void 0:ge[3])!=null?_e:M[3])*y-L;const D=fh[(Tt=I.rotation)!=null?Tt:0];J.setTexture([ne+M[D[0]],se+M[D[1]],ne+M[D[2]],se+M[D[3]],ne+M[D[4]],se+M[D[5]],ne+M[D[6]],se+M[D[7]]]),s.quads.push(J)};((b=(E=t.faces)==null?void 0:E.up)==null?void 0:b.texture)&&(!t.faces.up.cullface||!i[t.faces.up.cullface])&&g(t.faces.up,[a,16-f,c,16-u],[a,h,f,c,h,f,c,h,u,a,h,u]),((w=(_=t.faces)==null?void 0:_.down)==null?void 0:w.texture)&&(!t.faces.down.cullface||!i[t.faces.down.cullface])&&g(t.faces.down,[16-f,16-c,16-u,16-a],[a,o,u,c,o,u,c,o,f,a,o,f]),((N=(A=t.faces)==null?void 0:A.south)==null?void 0:N.texture)&&(!t.faces.south.cullface||!i[t.faces.south.cullface])&&g(t.faces.south,[a,16-h,c,16-o],[a,o,f,c,o,f,c,h,f,a,h,f]),((R=(v=t.faces)==null?void 0:v.north)==null?void 0:R.texture)&&(!t.faces.north.cullface||!i[t.faces.north.cullface])&&g(t.faces.north,[16-c,16-h,16-a,16-o],[c,o,u,a,o,u,a,h,u,c,h,u]),((k=(O=t.faces)==null?void 0:O.east)==null?void 0:k.texture)&&(!t.faces.east.cullface||!i[t.faces.east.cullface])&&g(t.faces.east,[16-f,16-h,16-u,16-o],[c,o,f,c,o,u,c,h,u,c,h,f]),((C=(T=t.faces)==null?void 0:T.west)==null?void 0:C.texture)&&(!t.faces.west.cullface||!i[t.faces.west.cullface])&&g(t.faces.west,[u,16-h,f,16-o],[a,o,u,a,o,f,a,h,f,a,h,u]);const d=ze();if(Ei(d),t.rotation){const I=th(...t.rotation.origin);He(d,d,I),Ul(d,d,or(t.rotation.angle),dh[t.rotation.axis]),t.rotation.rescale&&wi(d,d,gh[t.rotation.axis]),nh(I,I),He(d,d,I)}return s.transform(d)}getTexture(t){var n,i;for(;t.startsWith("#");)t=(i=(n=this.textures)==null?void 0:n[t.slice(1)])!=null?i:"";return G.parse(t)}flatten(t){var i,r,s,a;if(!this.parent)return;if(this.parent.equals(ln.BUILTIN_GENERATED)){this.generationMarker=!0;return}const n=this.getParent(t);if(!n){console.warn(`parent ${this.parent} does not exist!`),this.parent=void 0;return}if(n.flatten(t),this.elements||(this.elements=n.elements),this.textures||(this.textures={}),Object.keys((i=n.textures)!=null?i:{}).forEach(o=>{this.textures[o]||(this.textures[o]=n.textures[o])}),this.display||(this.display={}),Object.keys((r=n.display)!=null?r:{}).forEach(o=>{var c;const u=o;this.display[u]?Object.keys((c=n.display[u])!=null?c:{}).forEach(h=>{const f=h;this.display[u][f]||(this.display[u][f]=n.display[u][f])}):this.display[u]=n.display[u]}),this.guiLight||(this.guiLight=n.guiLight),n.generationMarker&&(this.generationMarker=!0),this.generationMarker&&((a=(s=this.elements)==null?void 0:s.length)!=null?a:0)===0)for(let o=0;o<ln.GENERATED_LAYERS.length;o+=1){const u=ln.GENERATED_LAYERS[o];if(!Object.hasOwn(this.textures,u))break;this.elements||(this.elements=[]),this.elements.push({from:[0,0,0],to:[16,16,0],faces:{south:{texture:`#${u}`,tintindex:o}}})}this.parent=void 0}getParent(t){return this.parent?t.getBlockModel(this.parent):null}static fromJson(t,n){const i=n.parent===void 0?void 0:G.parse(n.parent);return new ln(G.parse(t),i,n.textures,n.elements,n.display)}};let Ut=ln;p(Ut,"BUILTIN_GENERATED",G.create("builtin/generated")),p(Ut,"GENERATED_LAYERS",["layer0","layer1","layer2","layer3","layer4"]);function ra(e,t,n,i){const r=new vi(e,{"":{model:"dummy"}},void 0),s={getBlockModel:()=>i};return i.flatten(s),r.getMesh(e,{},t,s,n)}function sa(e,t,n,i,r){const s=i.up?16:[14.2,12.5,10.5,9,7,5.3,3.7,1.9,16,16,16,16,16,16,16,16][t],a=G.create(e);return ra(a,n,i,new Ut(a,void 0,{still:`block/${e}_still`,flow:`block/${e}_flow`},[{from:[0,0,0],to:[16,s,16],faces:{up:{texture:"#still",tintindex:r,cullface:l.Direction.UP},down:{texture:"#still",tintindex:r,cullface:l.Direction.DOWN},north:{texture:"#flow",tintindex:r,cullface:l.Direction.NORTH},east:{texture:"#flow",tintindex:r,cullface:l.Direction.EAST},south:{texture:"#flow",tintindex:r,cullface:l.Direction.SOUTH},west:{texture:"#flow",tintindex:r,cullface:l.Direction.WEST}}}]))}function _h(e,t,n){const i=G.create("chest");return ra(i,n,{},new Ut(i,void 0,{0:"block/chest"},[{from:[1,0,1],to:[15,14,15],faces:{up:{texture:"#0"},down:{texture:"#0"},north:{texture:"#0"},east:{texture:"#0"},south:{texture:"#0"},west:{texture:"#0"}}}]))}const dr={"minecraft:water":(e,t,n)=>sa("water",parseInt(e.level),t,n,0),"minecraft:lava":(e,t,n)=>sa("lava",parseInt(e.level),t,n),"minecraft:chest":(e,t)=>_h(e.facing||"south",e.type||"single",t)},aa=new Set(Object.keys(dr));class oa{constructor(t,n,i,r=16){p(this,"chunks",[]);this.gl=t,this.structure=n,this.resources=i,this.chunkSize=r,this.updateStructureBuffers()}setStructure(t){this.structure=t,this.updateStructureBuffers()}updateStructureBuffers(t){var n;t?t.forEach(i=>{this.getChunk(i).clear()}):this.chunks.forEach(i=>i.forEach(r=>r.forEach(s=>{s.clear()})));for(const i of this.structure.getBlocks()){const r=i.state.getName(),s=i.state.getProperties(),a=(n=this.resources.getDefaultBlockProperties(r))!=null?n:{};Object.entries(a).forEach(([c,h])=>{s[c]||(s[c]=h)});const o=[Math.floor(i.pos[0]/this.chunkSize),Math.floor(i.pos[1]/this.chunkSize),Math.floor(i.pos[2]/this.chunkSize)];if(t&&!t.some(c=>rh(c,o)))continue;const u=this.getChunk(o);try{const c=this.resources.getBlockDefinition(r),h={up:this.needsCull(i,l.Direction.UP),down:this.needsCull(i,l.Direction.DOWN),west:this.needsCull(i,l.Direction.WEST),east:this.needsCull(i,l.Direction.EAST),north:this.needsCull(i,l.Direction.NORTH),south:this.needsCull(i,l.Direction.SOUTH)},f=new Ne;c&&f.merge(c.getMesh(r,s,this.resources,this.resources,h)),aa.has(r.toString())&&f.merge(dr[r.toString()](s,this.resources,h)),f.isEmpty()||(this.finishChunkMesh(f,i.pos),u.merge(f))}catch(c){console.error(`Error rendering block ${r}`,c)}}t?t.forEach(i=>{this.getChunk(i).rebuild(this.gl,{pos:!0,color:!0,texture:!0,normal:!0,blockPos:!0})}):this.chunks.forEach(i=>i.forEach(r=>r.forEach(s=>{s.rebuild(this.gl,{pos:!0,color:!0,texture:!0,normal:!0,blockPos:!0})})))}getMeshes(){return this.chunks.flatMap(t=>t.flatMap(n=>n.flatMap(i=>i!=null?i:[])))}needsCull(t,n){var r,s;const i=(r=this.structure.getBlock(l.BlockPos.towards(t.pos,n)))==null?void 0:r.state;return i?(s=this.resources.getBlockFlags(i.getName()))!=null&&s.opaque?!(n===l.Direction.UP&&t.state.isFluid()):t.state.isFluid()&&i.isFluid():!1}finishChunkMesh(t,n){const i=ze();He(i,i,n),t.transform(i);for(const r of t.quads){const s=r.normal();r.forEach(a=>a.normal=s),r.forEach(a=>a.blockPos=new W(n[0],n[1],n[2]))}}getChunk(t){const n=Math.abs(t[0])*2+(t[0]<0?1:0),i=Math.abs(t[1])*2+(t[1]<0?1:0),r=Math.abs(t[2])*2+(t[2]<0?1:0);return this.chunks[n]||(this.chunks[n]=[]),this.chunks[n][i]||(this.chunks[n][i]=[]),this.chunks[n][i][r]||(this.chunks[n][i][r]=new Ne),this.chunks[n][i][r]}}const ca=new Map;function la(e){if(e.id.namespace!==G.DEFAULT_NAMESPACE)return[1,1,1];const t=ca.get(e.id.path);return t?t(e):[1,1,1]}function ht(e,t){for(const n of e)ca.set(n,t)}ht(["leather_helmet","leather_chestplate","leather_leggings","leather_boots","leather_horse_armor"],({tag:e})=>{const t=e.getCompound("display"),n=Ee(t.hasNumber("color")?t.getNumber("color"):10511680);return i=>i>0?[1,1,1]:n});const mh=[124/255,189/255,107/255];ht(["tall_grass","large_fern"],()=>mh),ht(["firework_star"],({tag:e})=>{const t=(()=>{const i=e.getCompound("Explosion").get("Colors");if(!(i!=null&&i.isIntArray())||i.length===0)return Ee(9079434);if(i.length===1)return Ee(i.get(0).getAsNumber());let[r,s,a]=[0,0,0];for(const o of i.getItems())r+=(o.getAsNumber()&16711680)>>16,s+=(o.getAsNumber()&65280)>>8,a+=(o.getAsNumber()&255)>>0;return r/=i.length,s/=i.length,a/=i.length,[r,s,a]})();return n=>n!==1?[1,1,1]:t}),ht(["potion","splash_potion","lingering_potion"],({tag:e})=>{const t=l.Potion.getColor(e);return n=>n>0?[1,1,1]:t});const Eh=[["allay",56063,44543],["axolotl",16499171,10890612],["bat",4996656,986895],["bee",15582019,4400155],["blaze",16167425,16775294],["cat",15714446,9794134],["camel",16565097,13341495],["cave_spider",803406,11013646],["chicken",10592673,16711680],["cod",12691306,15058059],["cow",4470310,10592673],["creeper",894731,0],["dolphin",2243405,16382457],["donkey",5457209,8811878],["drowned",9433559,7969893],["elder_guardian",13552826,7632531],["ender_dragon",1842204,14711290],["enderman",1447446,0],["endermite",1447446,7237230],["evoker",9804699,1973274],["fox",14005919,13396256],["frog",13661252,16762748],["ghast",16382457,12369084],["glow_squid",611926,8778172],["goat",10851452,5589310],["guardian",5931634,15826224],["hoglin",13004373,6251620],["horse",12623485,15656192],["husk",7958625,15125652],["iron_golem",14405058,7643954],["llama",12623485,10051392],["magma_cube",3407872,16579584],["mooshroom",10489616,12040119],["mule",1769984,5321501],["ocelot",15720061,5653556],["panda",15198183,1776418],["parrot",894731,16711680],["phantom",4411786,8978176],["pig",15771042,14377823],["piglin",10051392,16380836],["piglin_brute",5843472,16380836],["pillager",5451574,9804699],["polar_bear",15658718,14014157],["pufferfish",16167425,3654642],["rabbit",10051392,7555121],["ravager",7697520,5984329],["salmon",10489616,951412],["sheep",15198183,16758197],["shulker",9725844,5060690],["silverfish",7237230,3158064],["skeleton",12698049,4802889],["skeleton_horse",6842447,15066584],["slime",5349438,8306542],["snow_golem",14283506,8496292],["spider",3419431,11013646],["squid",2243405,7375001],["stray",6387319,14543594],["strider",10236982,5065037],["tadpole",7164733,1444352],["trader_llama",15377456,4547222],["tropical_fish",15690005,16775663],["turtle",15198183,44975],["vex",8032420,15265265],["villager",5651507,12422002],["vindicator",9804699,2580065],["wandering_trader",4547222,15377456],["warden",1001033,3790560],["witch",3407872,5349438],["wither",1315860,5075616],["wither_skeleton",1315860,4672845],["wolf",14144467,13545366],["zoglin",13004373,15132390],["zombie",44975,7969893],["zombie_horse",3232308,9945732],["zombie_villager",5651507,7969893],["zombified_piglin",15373203,5009705]];for(const e of Eh)ht([`${e[0]}_spawn_egg`],()=>t=>Ee(t===0?e[1]:e[2]));for(const e of["grass_block","grass","fern","vine","oak_leaves","spruce_leaves","birch_leaves","jungle_leaves","acacia_leaves","dark_oak_leaves","lily_pad"]){const t=xn[e]({});ht([e],()=>t)}ht(["mangrove_leaves"],()=>Ee(9619016)),ht(["tipped_arrow"],({tag:e})=>{const t=l.Potion.getColor(e);return n=>n===0?t:[1,1,1]}),ht(["filled_map"],({tag:e})=>{const t=e.getCompound("display"),n=Ee(t.hasNumber("MapColor")?4278190080|t.getNumber("MapColor")&16777215:-12173266);return i=>i===0?[1,1,1]:n});class zn{constructor(t,n,i){p(this,"gl");p(this,"program");this.gl=t,this.program=this.initShaderProgram(n,i)}getProgram(){return this.program}initShaderProgram(t,n){const i=this.loadShader(this.gl.VERTEX_SHADER,t),r=this.loadShader(this.gl.FRAGMENT_SHADER,n),s=this.gl.createProgram();if(this.gl.attachShader(s,i),this.gl.attachShader(s,r),this.gl.linkProgram(s),!this.gl.getProgramParameter(s,this.gl.LINK_STATUS))throw new Error(`Unable to link shader program: ${this.gl.getProgramInfoLog(s)}`);return s}loadShader(t,n){const i=this.gl.createShader(t);if(this.gl.shaderSource(i,n),this.gl.compileShader(i),!this.gl.getShaderParameter(i,this.gl.COMPILE_STATUS)){const r=new Error(`Compiling ${t===this.gl.VERTEX_SHADER?"vertex":"fragment"} shader: ${this.gl.getShaderInfoLog(i)}`);throw this.gl.deleteShader(i),r}return i}}const wh=`
  attribute vec4 vertPos;
  attribute vec2 texCoord;
  attribute vec3 vertColor;
  attribute vec3 normal;

  uniform mat4 mView;
  uniform mat4 mProj;

  varying highp vec2 vTexCoord;
  varying highp vec3 vTintColor;
  varying highp float vLighting;

  void main(void) {
    gl_Position = mProj * mView * vertPos;
    vTexCoord = texCoord;
    vTintColor = vertColor;
    vLighting = normal.y * 0.2 + abs(normal.z) * 0.1 + 0.8;
  }
`,ph=`
  precision highp float;
  varying highp vec2 vTexCoord;
  varying highp vec3 vTintColor;
  varying highp float vLighting;

  uniform sampler2D sampler;

  void main(void) {
		vec4 texColor = texture2D(sampler, vTexCoord);
		if(texColor.a < 0.01) discard;
		gl_FragColor = vec4(texColor.xyz * vTintColor * vLighting, texColor.a);
  }
`;class Ai{constructor(t){p(this,"shaderProgram");p(this,"projMatrix");p(this,"activeShader");this.gl=t,this.shaderProgram=new zn(t,wh,ph).getProgram(),this.activeShader=this.shaderProgram,this.projMatrix=this.getPerspective(),this.initialize()}setViewport(t,n,i,r){this.gl.viewport(t,n,i,r),this.projMatrix=this.getPerspective()}getPerspective(){const t=70*Math.PI/180,n=this.gl.canvas.clientWidth/this.gl.canvas.clientHeight,i=ze();return Yl(i,t,n,.1,500),i}initialize(){this.gl.enable(this.gl.DEPTH_TEST),this.gl.depthFunc(this.gl.LEQUAL),this.gl.enable(this.gl.BLEND),this.gl.blendFunc(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA),this.gl.enable(this.gl.CULL_FACE),this.gl.cullFace(this.gl.BACK)}setShader(t){this.gl.useProgram(t),this.activeShader=t}setVertexAttr(t,n,i){if(i===void 0)throw new Error(`Expected buffer for ${t}`);const r=this.gl.getAttribLocation(this.activeShader,t);this.gl.bindBuffer(this.gl.ARRAY_BUFFER,i),this.gl.vertexAttribPointer(r,n,this.gl.FLOAT,!1,0,0),this.gl.enableVertexAttribArray(r)}setUniform(t,n){const i=this.gl.getUniformLocation(this.activeShader,t);this.gl.uniformMatrix4fv(i,!1,n)}setTexture(t){this.gl.activeTexture(this.gl.TEXTURE0),this.gl.bindTexture(this.gl.TEXTURE_2D,t)}createAtlasTexture(t){const n=this.gl.createTexture();return this.gl.bindTexture(this.gl.TEXTURE_2D,n),this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.RGBA,this.gl.RGBA,this.gl.UNSIGNED_BYTE,t),this.gl.generateMipmap(this.gl.TEXTURE_2D),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,this.gl.NEAREST),n}prepareDraw(t){this.setUniform("mView",t),this.setUniform("mProj",this.projMatrix)}drawMesh(t,n){if(t.quadVertices()>0){if(n.pos&&this.setVertexAttr("vertPos",3,t.posBuffer),n.color&&this.setVertexAttr("vertColor",3,t.colorBuffer),n.texture&&this.setVertexAttr("texCoord",2,t.textureBuffer),n.normal&&this.setVertexAttr("normal",3,t.normalBuffer),n.blockPos&&this.setVertexAttr("blockPos",3,t.blockPosBuffer),!t.indexBuffer)throw new Error("Expected index buffer");this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,t.indexBuffer),this.gl.drawElements(this.gl.TRIANGLES,t.quadIndices(),this.gl.UNSIGNED_SHORT,0)}t.lineVertices()>0&&(n.pos&&this.setVertexAttr("vertPos",3,t.linePosBuffer),n.color&&this.setVertexAttr("vertColor",3,t.lineColorBuffer),this.gl.drawArrays(this.gl.LINES,0,t.lineVertices()))}}class Sh extends Ai{constructor(n,i,r,s){super(n);p(this,"item");p(this,"mesh");p(this,"tint");p(this,"atlasTexture");this.resources=r,this.item=i instanceof ve?i:new ve(i,1),this.mesh=this.getItemMesh(),this.tint=s==null?void 0:s.tint,this.atlasTexture=this.createAtlasTexture(this.resources.getTextureAtlas())}setItem(n){this.item=n instanceof ve?n:new ve(n,1),this.mesh=this.getItemMesh()}getItemMesh(){const n=this.resources.getBlockModel(this.item.id.withPrefix("item/"));if(!n)throw new Error(`Item model for ${this.item.toString()} does not exist`);let i=this.tint;!i&&this.item.id.namespace===G.DEFAULT_NAMESPACE&&(i=la(this.item));const r=n.getDisplayMesh("gui",this.resources,i);return r.quads.forEach(s=>{const a=s.normal();s.forEach(o=>o.normal=a)}),r.rebuild(this.gl,{pos:!0,color:!0,texture:!0,normal:!0}),r}getPerspective(){const n=ze();return $l(n,0,16,0,16,.1,500),n}drawItem(){const n=ze();He(n,n,[0,0,-32]),this.setShader(this.shaderProgram),this.setTexture(this.atlasTexture),this.prepareDraw(n),this.drawMesh(this.mesh,{pos:!0,color:!0,texture:!0,normal:!0})}}const bh=`
  attribute vec4 vertPos;
  attribute vec3 blockPos;

  uniform mat4 mView;
  uniform mat4 mProj;

  varying highp vec3 vColor;

  void main(void) {
    gl_Position = mProj * mView * vertPos;
    vColor = blockPos / 256.0;
  }
`,vh=`
  precision highp float;
  varying highp vec3 vColor;

  void main(void) {
    gl_FragColor = vec4(vColor, 1.0);
  }
`,Ah=`
  attribute vec4 vertPos;
  attribute vec3 vertColor;

  uniform mat4 mView;
  uniform mat4 mProj;

  varying highp vec3 vColor;

  void main(void) {
    gl_Position = mProj * mView * vertPos;
    vColor = vertColor;
  }
`,Nh=`
  precision highp float;
  varying highp vec3 vColor;

  void main(void) {
    gl_FragColor = vec4(vColor, 1.0);
  }
`;class yh extends Ai{constructor(n,i,r,s){var o,u;super(n);p(this,"gridShaderProgram");p(this,"colorShaderProgram");p(this,"gridMesh",new Ne);p(this,"outlineMesh",new Ne);p(this,"invisibleBlocksMesh",new Ne);p(this,"atlasTexture");p(this,"useInvisibleBlocks");p(this,"chunkBuilder");this.structure=i,this.resources=r;const a=(o=s==null?void 0:s.chunkSize)!=null?o:16;this.chunkBuilder=new oa(n,i,r,a),s!=null&&s.facesPerBuffer&&console.warn("[deepslate renderer warning]: facesPerBuffer option has been removed in favor of chunkSize"),this.useInvisibleBlocks=(u=s==null?void 0:s.useInvisibleBlockBuffer)!=null?u:!0,this.gridShaderProgram=new zn(n,Ah,Nh).getProgram(),this.colorShaderProgram=new zn(n,bh,vh).getProgram(),this.gridMesh=this.getGridMesh(),this.outlineMesh=this.getOutlineMesh(),this.invisibleBlocksMesh=this.getInvisibleBlocksMesh(),this.atlasTexture=this.createAtlasTexture(this.resources.getTextureAtlas())}setStructure(n){this.structure=n,this.chunkBuilder.setStructure(n),this.gridMesh=this.getGridMesh(),this.invisibleBlocksMesh=this.getInvisibleBlocksMesh()}updateStructureBuffers(n){this.chunkBuilder.updateStructureBuffers(n)}getGridMesh(){const[n,i,r]=this.structure.getSize(),s=new Ne;s.addLine(0,0,0,n,0,0,[1,0,0]),s.addLine(0,0,0,0,0,r,[0,0,1]);const a=[.8,.8,.8];s.addLine(0,0,0,0,i,0,a),s.addLine(n,0,0,n,i,0,a),s.addLine(0,0,r,0,i,r,a),s.addLine(n,0,r,n,i,r,a),s.addLine(0,i,0,0,i,r,a),s.addLine(n,i,0,n,i,r,a),s.addLine(0,i,0,n,i,0,a),s.addLine(0,i,r,n,i,r,a);for(let o=1;o<=n;o+=1)s.addLine(o,0,0,o,0,r,a);for(let o=1;o<=r;o+=1)s.addLine(0,0,o,n,0,o,a);return s.rebuild(this.gl,{pos:!0,color:!0})}getOutlineMesh(){return new Ne().addLineCube(0,0,0,1,1,1,[1,1,1]).rebuild(this.gl,{pos:!0,color:!0})}getInvisibleBlocksMesh(){const n=new Ne;if(!this.useInvisibleBlocks)return n;const i=this.structure.getSize();for(let r=0;r<i[0];r+=1)for(let s=0;s<i[1];s+=1)for(let a=0;a<i[2];a+=1){const o=this.structure.getBlock([r,s,a]);o!==void 0&&(o===null?n.addLineCube(r+.4375,s+.4375,a+.4375,r+.5625,s+.5625,a+.5625,[1,.25,.25]):o.state.is($.AIR)?n.addLineCube(r+.375,s+.375,a+.375,r+.625,s+.625,a+.625,[.5,.5,1]):o.state.is(new $("cave_air"))&&n.addLineCube(r+.375,s+.375,a+.375,r+.625,s+.625,a+.625,[.5,1,.5]))}return n.rebuild(this.gl,{pos:!0,color:!0})}drawGrid(n){this.setShader(this.gridShaderProgram),this.prepareDraw(n),this.drawMesh(this.gridMesh,{pos:!0,color:!0})}drawInvisibleBlocks(n){!this.useInvisibleBlocks||(this.setShader(this.gridShaderProgram),this.prepareDraw(n),this.drawMesh(this.invisibleBlocksMesh,{pos:!0,color:!0}))}drawStructure(n){this.setShader(this.shaderProgram),this.setTexture(this.atlasTexture),this.prepareDraw(n),this.chunkBuilder.getMeshes().forEach(i=>{this.drawMesh(i,{pos:!0,color:!0,texture:!0,normal:!0})})}drawColoredStructure(n){this.setShader(this.colorShaderProgram),this.prepareDraw(n),this.chunkBuilder.getMeshes().forEach(i=>{this.drawMesh(i,{pos:!0,color:!0,normal:!0,blockPos:!0})})}drawOutline(n,i){this.setShader(this.gridShaderProgram);const r=ze();zl(r,n),He(r,r,i),this.prepareDraw(r),this.drawMesh(this.outlineMesh,{pos:!0,color:!0})}}class Hn{constructor(t,n){p(this,"part");if(this.img=t,this.idMap=n,!ar(t.width)||!ar(t.height))throw new Error(`Expected texture atlas dimensions to be powers of two, got ${t.width}x${t.height}.`);this.part=16/t.width}getTextureAtlas(){return this.img}getTextureUV(t){var n;return(n=this.idMap[t.toString()])!=null?n:[0,0,this.part,this.part]}static async fromBlobs(t){const n=Math.sqrt(Object.keys(t).length+1),i=Zs(n),r=i*16,s=1/i,a=document.createElement("canvas");a.width=r,a.height=r;const o=a.getContext("2d");this.drawInvalidTexture(o);const u={};let c=1;return await Promise.all(Object.keys(t).map(async h=>{const f=c%i,g=Math.floor(c/i);c+=1,u[h]=[s*f,s*g,s*f+s,s*g+s];const d=await createImageBitmap(t[h]);o.drawImage(d,0,0,16,16,16*f,16*g,16,16)})),new Hn(o.getImageData(0,0,r,r),u)}static empty(){const t=document.createElement("canvas");t.width=16,t.height=16;const n=t.getContext("2d");return Hn.drawInvalidTexture(n),new Hn(n.getImageData(0,0,16,16),{})}static drawInvalidTexture(t){t.fillStyle="black",t.fillRect(0,0,16,16),t.fillStyle="magenta",t.fillRect(0,0,8,8),t.fillRect(8,8,8,8)}}const kh=`
  attribute vec4 vertPos;
  attribute vec3 vertColor;

  uniform mat4 mView;
  uniform mat4 mProj;

  varying highp vec3 vColor;

  void main(void) {
    gl_Position = mProj * mView * vertPos;
    vColor = vertColor;
  }
`,Rh=`
  precision highp float;
  varying highp vec3 vColor;

  void main(void) {
    gl_FragColor = vec4(vColor, 1.0);
  }
`;class Th extends Ai{constructor(n){super(n);p(this,"voxelShaderProgram");p(this,"voxels",[]);p(this,"quads",[]);p(this,"meshes",[]);this.voxelShaderProgram=new zn(n,kh,Rh).getProgram()}setVoxels(n){this.voxels=n,this.quads=this.getQuads(),this.meshes=this.getMeshes()}getQuads(){var r,s,a,o,u,c,h,f,g,d,E,b;const n=new Map;for(const _ of this.voxels)Ii(n,_.x,new Map,w=>{Ii(w,_.y,new Set,A=>{A.add(_.z)})});const i=[];for(const _ of this.voxels)(s=(r=n.get(_.x+1))==null?void 0:r.get(_.y))!=null&&s.has(_.z)||i.push(Xe.fromPoints(new W(_.x+1,_.y,_.z),new W(_.x+1,_.y+1,_.z),new W(_.x+1,_.y+1,_.z+1),new W(_.x+1,_.y,_.z+1)).setColor(_.color)),(o=(a=n.get(_.x-1))==null?void 0:a.get(_.y))!=null&&o.has(_.z)||i.push(Xe.fromPoints(new W(_.x,_.y,_.z+1),new W(_.x,_.y+1,_.z+1),new W(_.x,_.y+1,_.z),new W(_.x,_.y,_.z)).setColor(_.color)),(c=(u=n.get(_.x))==null?void 0:u.get(_.y+1))!=null&&c.has(_.z)||i.push(Xe.fromPoints(new W(_.x,_.y+1,_.z+1),new W(_.x+1,_.y+1,_.z+1),new W(_.x+1,_.y+1,_.z),new W(_.x,_.y+1,_.z)).setColor(_.color)),(f=(h=n.get(_.x))==null?void 0:h.get(_.y-1))!=null&&f.has(_.z)||i.push(Xe.fromPoints(new W(_.x,_.y,_.z),new W(_.x+1,_.y,_.z),new W(_.x+1,_.y,_.z+1),new W(_.x,_.y,_.z+1)).setColor(_.color)),(d=(g=n.get(_.x))==null?void 0:g.get(_.y))!=null&&d.has(_.z+1)||i.push(Xe.fromPoints(new W(_.x,_.y,_.z+1),new W(_.x+1,_.y,_.z+1),new W(_.x+1,_.y+1,_.z+1),new W(_.x,_.y+1,_.z+1)).setColor(_.color)),(b=(E=n.get(_.x))==null?void 0:E.get(_.y))!=null&&b.has(_.z-1)||i.push(Xe.fromPoints(new W(_.x,_.y+1,_.z),new W(_.x+1,_.y+1,_.z),new W(_.x+1,_.y,_.z),new W(_.x,_.y,_.z)).setColor(_.color));return console.debug(`Converted ${this.voxels.length} voxels into ${i.length} quads!`),i}getMeshes(){const n=[];let i=new Ne;for(const r of this.quads){const s=r.normal(),a=(s.y*.25+Math.abs(s.z)*.125+.75)/256;r.forEach(o=>o.color=[o.color[0]*a,o.color[1]*a,o.color[2]*a]),i.quads.push(r),i.quadVertices()>65e3&&(n.push(i),i=new Ne)}i.isEmpty()||n.push(i);for(const r of n)r.rebuild(this.gl,{pos:!0,color:!0});return n}draw(n){if(console.debug(`Drawing ${this.meshes.length} meshes...`),this.setShader(this.voxelShaderProgram),this.prepareDraw(n),this.meshes.length===0){this.gl.clearColor(0,0,0,0),this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT);return}for(const i of this.meshes)this.drawMesh(i,{pos:!0,color:!0})}}l.NoiseRouter=void 0,(e=>{const t=o=>new V.HolderHolder(l.Holder.parser(l.WorldgenRegistries.DENSITY_FUNCTION,V.fromJson)(o));function n(o){var c;const u=(c=l.Json.readObject(o))!=null?c:{};return{barrier:t(u.barrier),fluidLevelFloodedness:t(u.fluid_level_floodedness),fluidLevelSpread:t(u.fluid_level_spread),lava:t(u.lava),temperature:t(u.temperature),vegetation:t(u.vegetation),continents:t(u.continents),erosion:t(u.erosion),depth:t(u.depth),ridges:t(u.ridges),initialDensityWithoutJaggedness:t(u.initial_density_without_jaggedness),finalDensity:t(u.final_density),veinToggle:t(u.vein_toggle),veinRidged:t(u.vein_ridged),veinGap:t(u.vein_gap)}}e.fromJson=n;function i(o){return{barrier:V.Constant.ZERO,fluidLevelFloodedness:V.Constant.ZERO,fluidLevelSpread:V.Constant.ZERO,lava:V.Constant.ZERO,temperature:V.Constant.ZERO,vegetation:V.Constant.ZERO,continents:V.Constant.ZERO,erosion:V.Constant.ZERO,depth:V.Constant.ZERO,ridges:V.Constant.ZERO,initialDensityWithoutJaggedness:V.Constant.ZERO,finalDensity:V.Constant.ZERO,veinToggle:V.Constant.ZERO,veinRidged:V.Constant.ZERO,veinGap:V.Constant.ZERO,...o}}e.create=i;function r(o,u){return{barrier:o.barrier.mapAll(u),fluidLevelFloodedness:o.fluidLevelFloodedness.mapAll(u),fluidLevelSpread:o.fluidLevelSpread.mapAll(u),lava:o.lava.mapAll(u),temperature:o.temperature.mapAll(u),vegetation:o.vegetation.mapAll(u),continents:o.continents.mapAll(u),erosion:o.erosion.mapAll(u),depth:o.depth.mapAll(u),ridges:o.ridges.mapAll(u),initialDensityWithoutJaggedness:o.initialDensityWithoutJaggedness.mapAll(u),finalDensity:o.finalDensity.mapAll(u),veinToggle:o.veinToggle.mapAll(u),veinRidged:o.veinRidged.mapAll(u),veinGap:o.veinGap.mapAll(u)}}e.mapAll=r;const s=new Map;function a(o,u){var d;const c=(d=u.key())==null?void 0:d.toString();if(!c)throw new Error("Cannot instantiate noise from direct holder");const h=o.seedKey(),f=s.get(c);if(f&&f[0]===h[0]&&f[1]===h[1])return f[2];const g=new lt(o.fromHashOf(c),u.value());return s.set(c,[h[0],h[1],g]),g}e.instantiate=a})(l.NoiseRouter||(l.NoiseRouter={})),l.NoiseSettings=void 0,(e=>{function t(o){var c,h,f,g,d;const u=(c=l.Json.readObject(o))!=null?c:{};return{minY:(h=l.Json.readInt(u.min_y))!=null?h:0,height:(f=l.Json.readInt(u.height))!=null?f:256,xzSize:(g=l.Json.readInt(u.size_horizontal))!=null?g:1,ySize:(d=l.Json.readInt(u.size_vertical))!=null?d:1}}e.fromJson=t;function n(o){return{minY:0,height:256,xzSize:1,ySize:1,...o}}e.create=n;function i(o){return o.ySize<<2}e.cellHeight=i;function r(o){return o.xzSize<<2}e.cellWidth=r;function s(o){return o.height/i(o)}e.cellCountY=s;function a(o){return Math.floor(o.minY/i(o))}e.minCellY=a})(l.NoiseSettings||(l.NoiseSettings={})),l.NoiseSlideSettings=void 0,(e=>{function t(i){var s,a,o,u;const r=(s=l.Json.readObject(i))!=null?s:{};return{target:(a=l.Json.readNumber(r.target))!=null?a:0,size:(o=l.Json.readInt(r.size))!=null?o:0,offset:(u=l.Json.readInt(r.offset))!=null?u:0}}e.fromJson=t;function n(i,r,s){if(i.size<=0)return r;const a=(s-i.offset)/i.size;return ui(i.target,r,a)}e.apply=n})(l.NoiseSlideSettings||(l.NoiseSlideSettings={})),l.VerticalAnchor=void 0,(e=>{function t(s){var o,u,c,h;const a=(o=l.Json.readObject(s))!=null?o:{};return a.absolute!==void 0?n((u=l.Json.readNumber(a.absolute))!=null?u:0):a.above_bottom!==void 0?i((c=l.Json.readNumber(a.above_bottom))!=null?c:0):a.below_top!==void 0?r((h=l.Json.readNumber(a.below_top))!=null?h:0):()=>0}e.fromJson=t;function n(s){return()=>s}e.absolute=n;function i(s){return a=>a.minY+s}e.aboveBottom=i;function r(s){return a=>a.minY+a.height-1-s}e.belowTop=r})(l.VerticalAnchor||(l.VerticalAnchor={}));class ha{constructor(t,n,i){p(this,"surfaceNoise");p(this,"surfaceSecondaryNoise");p(this,"random");p(this,"positionalRandoms");this.rule=t,this.defaultBlock=n,this.random=te.create(i).forkPositional(),this.surfaceNoise=l.NoiseRouter.instantiate(this.random,l.WorldgenRegistries.SURFACE_NOISE),this.surfaceSecondaryNoise=l.NoiseRouter.instantiate(this.random,l.WorldgenRegistries.SURFACE_SECONDARY_NOISE),this.positionalRandoms=new Map}buildSurface(t,n,i,r){const s=l.ChunkPos.minBlockX(t.pos),a=l.ChunkPos.minBlockZ(t.pos),o=new ua(this,t,n,i,r),u=this.rule(o);for(let c=0;c<16;c+=1){const h=s+c;for(let f=0;f<1;f+=1){const g=a+f;o.updateXZ(h,g);let d=0,E=Number.MIN_SAFE_INTEGER,b=Number.MAX_SAFE_INTEGER;for(let _=t.maxY;_>=t.minY;_-=1){const w=l.BlockPos.create(h,_,g),A=t.getBlockState(w);if(A.equals($.AIR)){d=0,E=Number.MIN_SAFE_INTEGER;continue}if(A.isFluid()){E===Number.MIN_SAFE_INTEGER&&(E=_+1);continue}if(b>=_){b=Number.MIN_SAFE_INTEGER;for(let R=_-1;R>=t.minY;R-=1){const O=t.getBlockState(l.BlockPos.create(h,R,g));if(O.equals($.AIR)||O.isFluid()){b=R+1;break}}}d+=1;const N=_-b+1;if(!A.equals(this.defaultBlock))continue;o.updateY(d,N,E,_);const v=u(h,_,g);v&&t.setBlockState(w,v)}}}}getSurfaceDepth(t,n){const i=this.surfaceNoise.sample(t,0,n),r=this.random.at(t,0,n).nextDouble()*.25;return i*2.75+3+r}getSurfaceSecondary(t,n){return this.surfaceSecondaryNoise.sample(t,0,n)}getRandom(t){return Ot(this.positionalRandoms,t,()=>this.random.fromHashOf(t))}}class ua{constructor(t,n,i,r,s){p(this,"blockX",0);p(this,"blockY",0);p(this,"blockZ",0);p(this,"stoneDepthAbove",0);p(this,"stoneDepthBelow",0);p(this,"surfaceDepth",0);p(this,"waterHeight",0);p(this,"biome",()=>"");p(this,"surfaceSecondary",()=>0);p(this,"minSurfaceLevel",()=>0);this.system=t,this.chunk=n,this.noiseChunk=i,this.context=r,this.getBiome=s}updateXZ(t,n){this.blockX=t,this.blockZ=n,this.surfaceDepth=this.system.getSurfaceDepth(t,n),this.surfaceSecondary=fn(()=>this.system.getSurfaceSecondary(t,n)),this.minSurfaceLevel=fn(()=>this.calculateMinSurfaceLevel(t,n))}updateY(t,n,i,r){this.blockY=r,this.stoneDepthAbove=t,this.stoneDepthBelow=n,this.waterHeight=i,this.biome=fn(()=>this.getBiome(l.BlockPos.create(this.blockX,this.blockY,this.blockZ)))}calculateMinSurfaceLevel(t,n){const i=t>>4,r=n>>4,s=this.noiseChunk.getPreliminarySurfaceLevel(i<<4,r<<4),a=this.noiseChunk.getPreliminarySurfaceLevel(i+1<<4,r<<4),o=this.noiseChunk.getPreliminarySurfaceLevel(i<<4,r+1<<4),u=this.noiseChunk.getPreliminarySurfaceLevel(i+1<<4,r+1<<4);return Math.floor(hi((t&15)/16,(n&15)/16,s,a,o,u))+this.surfaceDepth-8}}l.SurfaceRule=void 0,(e=>{e.NOOP=()=>()=>{};function t(s){var u,c,h;const a=(u=l.Json.readObject(s))!=null?u:{};switch((c=l.Json.readString(a.type))==null?void 0:c.replace(/^minecraft:/,"")){case"block":return n($.fromJson(a.result_state));case"sequence":return i((h=l.Json.readArray(a.sequence,e.fromJson))!=null?h:[]);case"condition":return r(l.SurfaceCondition.fromJson(a.if_true),e.fromJson(a.then_run))}return e.NOOP}e.fromJson=t;function n(s){return()=>()=>s}e.block=n;function i(s){return a=>{const o=s.map(u=>u(a));return(u,c,h)=>{for(const f of o){const g=f(u,c,h);if(g)return g}}}}e.sequence=i;function r(s,a){return o=>(u,c,h)=>{if(s(o))return a(o)(u,c,h)}}e.condition=r})(l.SurfaceRule||(l.SurfaceRule={})),l.SurfaceCondition=void 0,(e=>{e.FALSE=()=>!1,e.TRUE=()=>!0;function t(c){var g,d,E,b,_,w,A,N,v,R,O,k;const h=(g=l.Json.readObject(c))!=null?g:{};switch((d=l.Json.readString(h.type))==null?void 0:d.replace(/^minecraft:/,"")){case"above_preliminary_surface":return n();case"biome":return i((E=l.Json.readArray(h.biome_is,T=>{var C;return(C=l.Json.readString(T))!=null?C:""}))!=null?E:[]);case"not":return r(e.fromJson(h.invert));case"stone_depth":return s((b=l.Json.readInt(h.offset))!=null?b:0,(_=l.Json.readBoolean(h.add_surface_depth))!=null?_:!1,(w=l.Json.readInt(h.secondary_depth_range))!=null?w:0,l.Json.readString(h.surface_type)==="ceiling");case"vertical_gradient":return a((A=l.Json.readString(h.random_name))!=null?A:"",l.VerticalAnchor.fromJson(h.true_at_and_below),l.VerticalAnchor.fromJson(h.false_at_and_above));case"water":return o((N=l.Json.readInt(h.offset))!=null?N:0,(v=l.Json.readInt(h.surface_depth_multiplier))!=null?v:0,(R=l.Json.readBoolean(h.add_surface_depth))!=null?R:!1);case"y_above":return u(l.VerticalAnchor.fromJson(h.anchor),(O=l.Json.readInt(h.surface_depth_multiplier))!=null?O:0,(k=l.Json.readBoolean(h.add_surface_depth))!=null?k:!1)}return e.FALSE}e.fromJson=t;function n(){return c=>c.blockY>=c.minSurfaceLevel()}e.abovePreliminarySurface=n;function i(c){const h=new Set(c);return f=>h.has(f.biome())}e.biome=i;function r(c){return h=>!c(h)}e.not=r;function s(c,h,f,g){return d=>{const E=g?d.stoneDepthBelow:d.stoneDepthAbove,b=h?d.surfaceDepth:0,_=f===0?0:Gn(d.surfaceSecondary(),-1,1,0,f);return E<=1+c+b+_}}e.stoneDepth=s;function a(c,h,f){return g=>{const d=h(g.context),E=f(g.context);if(g.blockY<=d)return!0;if(g.blockY>=E)return!1;const b=g.system.getRandom(c),_=Gn(g.blockY,d,E,1,0);return b.nextFloat()<_}}e.verticalGradient=a;function o(c,h,f){return g=>{if(g.waterHeight===Number.MIN_SAFE_INTEGER)return!0;const d=f?g.stoneDepthAbove:0;return g.blockY+d>=g.waterHeight+c+g.surfaceDepth*h}}e.water=o;function u(c,h,f){return g=>{const d=f?g.stoneDepthAbove:0;return g.blockY+d>=c(g.context)+g.surfaceDepth*h}}e.yAbove=u})(l.SurfaceCondition||(l.SurfaceCondition={})),l.NoiseGeneratorSettings=void 0,(e=>{function t(i){var s,a,o,u,c,h;const r=(s=l.Json.readObject(i))!=null?s:{};return{surfaceRule:l.SurfaceRule.fromJson(r.surface_rule),noise:l.NoiseSettings.fromJson(r.noise),defaultBlock:$.fromJson(r.default_block),defaultFluid:$.fromJson(r.default_fluid),noiseRouter:l.NoiseRouter.fromJson(r.noise_router),seaLevel:(a=l.Json.readInt(r.sea_level))!=null?a:0,disableMobGeneration:(o=l.Json.readBoolean(r.disable_mob_generation))!=null?o:!1,aquifersEnabled:(u=l.Json.readBoolean(r.aquifers_enabled))!=null?u:!1,oreVeinsEnabled:(c=l.Json.readBoolean(r.ore_veins_enabled))!=null?c:!1,legacyRandomSource:(h=l.Json.readBoolean(r.legacy_random_source))!=null?h:!1}}e.fromJson=t;function n(i){return{surfaceRule:l.SurfaceRule.NOOP,noise:l.NoiseSettings.create({}),defaultBlock:$.STONE,defaultFluid:$.WATER,noiseRouter:l.NoiseRouter.create({}),seaLevel:0,disableMobGeneration:!1,aquifersEnabled:!1,oreVeinsEnabled:!1,legacyRandomSource:!1,...i}}e.create=n})(l.NoiseGeneratorSettings||(l.NoiseGeneratorSettings={})),l.WorldgenRegistries=void 0,(e=>{e.NOISE=oe.createAndRegister("worldgen/noise",l.NoiseParameters.fromJson),e.DENSITY_FUNCTION=oe.createAndRegister("worldgen/density_function",n=>V.fromJson(n)),e.NOISE_SETTINGS=oe.createAndRegister("worldgen/noise_settings",l.NoiseGeneratorSettings.fromJson),e.BIOME=oe.createAndRegister("worldgen/biome"),e.SURFACE_NOISE=t("surface",-6,[1,1,1]),e.SURFACE_SECONDARY_NOISE=t("surface_secondary",-6,[1,1,0,1]);function t(n,i,r){return e.NOISE.register(G.create(n),l.NoiseParameters.create(i,r),!0)}})(l.WorldgenRegistries||(l.WorldgenRegistries={}));class V{minValue(){return-this.maxValue()}mapAll(t){return t.map(this)}}(e=>{function t(ie,y,S){return{x:ie,y,z:S}}e.context=t;class n extends e{constructor(y){super(),this.input=y}compute(y){return this.transform(y,this.input.compute(y))}}const i=l.Holder.parser(l.WorldgenRegistries.NOISE,l.NoiseParameters.fromJson);function r(ie,y=r){var D,z,Q,We,Ve,Pe,de,ge,_e,Tt,hn,un,Wn,Vn,_r,mr,Er,ga,_a,ma;if(typeof ie=="string")return new a(l.Holder.reference(l.WorldgenRegistries.DENSITY_FUNCTION,G.parse(ie)));if(typeof ie=="number")return new s(ie);const S=(D=l.Json.readObject(ie))!=null?D:{},L=(z=l.Json.readString(S.type))==null?void 0:z.replace(/^minecraft:/,"");switch(L){case"blend_alpha":return new o(1,0,1);case"blend_offset":return new o(0,-1/0,1/0);case"beardifier":return new o(0,-1/0,1/0);case"old_blended_noise":return new u((Q=l.Json.readNumber(S.xz_scale))!=null?Q:1,(We=l.Json.readNumber(S.y_scale))!=null?We:1,(Ve=l.Json.readNumber(S.xz_factor))!=null?Ve:80,(Pe=l.Json.readNumber(S.y_factor))!=null?Pe:160,(de=l.Json.readNumber(S.smear_scale_multiplier))!=null?de:8);case"flat_cache":return new h(y(S.argument));case"interpolated":return new E(y(S.argument));case"cache_2d":return new g(y(S.argument));case"cache_once":return new d(y(S.argument));case"cache_all_in_cell":return new f(y(S.argument));case"noise":return new b((ge=l.Json.readNumber(S.xz_scale))!=null?ge:1,(_e=l.Json.readNumber(S.y_scale))!=null?_e:1,i(S.noise));case"end_islands":return new _;case"weird_scaled_sampler":return new A(y(S.input),l.Json.readEnum(S.rarity_value_mapper,w),i(S.noise));case"shifted_noise":return new N(y(S.shift_x),y(S.shift_y),y(S.shift_z),(Tt=l.Json.readNumber(S.xz_scale))!=null?Tt:1,(hn=l.Json.readNumber(S.y_scale))!=null?hn:1,i(S.noise));case"range_choice":return new v(y(S.input),(un=l.Json.readNumber(S.min_inclusive))!=null?un:0,(Wn=l.Json.readNumber(S.max_exclusive))!=null?Wn:1,y(S.when_in_range),y(S.when_out_of_range));case"shift_a":return new O(i(S.argument));case"shift_b":return new k(i(S.argument));case"shift":return new T(i(S.argument));case"blend_density":return new C(y(S.argument));case"clamp":return new I(y(S.input),(Vn=l.Json.readNumber(S.min))!=null?Vn:0,(_r=l.Json.readNumber(S.max))!=null?_r:1);case"abs":case"square":case"cube":case"half_negative":case"quarter_negative":case"squeeze":return new M(L,y(S.argument));case"add":case"mul":case"min":case"max":return new J(l.Json.readEnum(L,x),y(S.argument1),y(S.argument2));case"spline":return new F(l.CubicSpline.fromJson(S.spline,y));case"constant":return new s((mr=l.Json.readNumber(S.argument))!=null?mr:0);case"y_clamped_gradient":return new ne((Er=l.Json.readInt(S.from_y))!=null?Er:-4064,(ga=l.Json.readInt(S.to_y))!=null?ga:4062,(_a=l.Json.readNumber(S.from_value))!=null?_a:-4064,(ma=l.Json.readNumber(S.to_value))!=null?ma:4062)}return s.ZERO}e.fromJson=r;const se=class extends e{constructor(y){super(),this.value=y}compute(){return this.value}minValue(){return this.value}maxValue(){return this.value}};let s=se;p(s,"ZERO",new se(0)),p(s,"ONE",new se(1)),e.Constant=s;class a extends e{constructor(y){super(),this.holder=y}compute(y){return this.holder.value().compute(y)}minValue(){return this.holder.value().minValue()}maxValue(){return this.holder.value().maxValue()}}e.HolderHolder=a;class o extends e.Constant{constructor(y,S,L){super(y),this.min=S,this.max=L}minValue(){return this.min}maxValue(){return this.max}}e.ConstantMinMax=o;class u extends e{constructor(y,S,L,D,z,Q){super(),this.xzScale=y,this.yScale=S,this.xzFactor=L,this.yFactor=D,this.smearScaleMultiplier=z,this.blendedNoise=Q}compute(y){var S,L;return(L=(S=this.blendedNoise)==null?void 0:S.sample(y.x,y.y,y.z))!=null?L:0}maxValue(){var y,S;return(S=(y=this.blendedNoise)==null?void 0:y.maxValue)!=null?S:0}}e.OldBlendedNoise=u;class c extends e{constructor(y){super(),this.wrapped=y}minValue(){return this.wrapped.minValue()}maxValue(){return this.wrapped.maxValue()}}class h extends c{constructor(S){super(S);p(this,"lastQuartX");p(this,"lastQuartZ");p(this,"lastValue",0)}compute(S){const L=S.x>>2,D=S.z>>2;return(this.lastQuartX!==L||this.lastQuartZ!==D)&&(this.lastValue=this.wrapped.compute(e.context(L<<2,0,D<<2)),this.lastQuartX=L,this.lastQuartZ=D),this.lastValue}mapAll(S){return S.map(new h(this.wrapped.mapAll(S)))}}e.FlatCache=h;class f extends c{constructor(y){super(y)}compute(y){return this.wrapped.compute(y)}mapAll(y){return y.map(new f(this.wrapped.mapAll(y)))}}e.CacheAllInCell=f;class g extends c{constructor(S){super(S);p(this,"lastBlockX");p(this,"lastBlockZ");p(this,"lastValue",0)}compute(S){const L=S.x,D=S.z;return(this.lastBlockX!==L||this.lastBlockZ!==D)&&(this.lastValue=this.wrapped.compute(S),this.lastBlockX=L,this.lastBlockZ=D),this.lastValue}mapAll(S){return S.map(new g(this.wrapped.mapAll(S)))}}e.Cache2D=g;class d extends c{constructor(S){super(S);p(this,"lastBlockX");p(this,"lastBlockY");p(this,"lastBlockZ");p(this,"lastValue",0)}compute(S){const L=S.x,D=S.y,z=S.z;return(this.lastBlockX!==L||this.lastBlockY!==D||this.lastBlockZ!==z)&&(this.lastValue=this.wrapped.compute(S),this.lastBlockX=L,this.lastBlockY=D,this.lastBlockZ=z),this.lastValue}mapAll(S){return S.map(new d(this.wrapped.mapAll(S)))}}e.CacheOnce=d;class E extends c{constructor(S,L=4,D=4){super(S);p(this,"values");this.cellWidth=L,this.cellHeight=D,this.values=new Map}compute({x:S,y:L,z:D}){const z=this.cellWidth,Q=this.cellHeight,We=(S%z+z)%z/z,Ve=(L%Q+Q)%Q/Q,Pe=(D%z+z)%z/z,de=Math.floor(S/z)*z,ge=Math.floor(L/Q)*Q,_e=Math.floor(D/z)*z;return Ws(We,Ve,Pe,()=>this.computeCorner(de,ge,_e),()=>this.computeCorner(de+z,ge,_e),()=>this.computeCorner(de,ge+Q,_e),()=>this.computeCorner(de+z,ge+Q,_e),()=>this.computeCorner(de,ge,_e+z),()=>this.computeCorner(de+z,ge,_e+z),()=>this.computeCorner(de,ge+Q,_e+z),()=>this.computeCorner(de+z,ge+Q,_e+z))}computeCorner(S,L,D){return Ot(this.values,`${S} ${L} ${D}`,()=>this.wrapped.compute(e.context(S,L,D)))}mapAll(S){return S.map(new E(this.wrapped.mapAll(S)))}withCellSize(S,L){return new E(this.wrapped,S,L)}}e.Interpolated=E;class b extends e{constructor(y,S,L,D){super(),this.xzScale=y,this.yScale=S,this.noiseData=L,this.noise=D}compute(y){var S,L;return(L=(S=this.noise)==null?void 0:S.sample(y.x*this.xzScale,y.y*this.yScale,y.z*this.xzScale))!=null?L:0}maxValue(){var y,S;return(S=(y=this.noise)==null?void 0:y.maxValue)!=null?S:2}}e.Noise=b;class _ extends e{constructor(S){super();p(this,"islandNoise");const L=new ce(S!=null?S:BigInt(0));L.consume(17292),this.islandNoise=new pe(L)}getHeightValue(S,L){const D=Math.floor(S/2),z=Math.floor(L/2),Q=S%2,We=L%2;let Ve=Nt(100-Math.sqrt(S*S+L*L),-100,80);for(let Pe=-12;Pe<=12;Pe+=1)for(let de=-12;de<=12;de+=1){const ge=D+Pe,_e=z+de;if(ge*ge+_e*_e<=4096||this.islandNoise.sample2D(ge,_e)>=-.9)continue;const Tt=(Math.abs(ge)*3439+Math.abs(_e)*147)%13+9,hn=Q+Pe*2,un=We+de*2,Wn=100-Math.sqrt(hn*hn+un*un)*Tt,Vn=Nt(Wn,-100,80);Ve=Math.max(Ve,Vn)}return Ve}compute({x:S,y:L,z:D}){return(this.getHeightValue(Math.floor(S/8),Math.floor(D/8))-8)/128}minValue(){return-.84375}maxValue(){return .5625}}e.EndIslands=_;const w=["type_1","type_2"],le=class extends n{constructor(S,L,D,z){super(S);p(this,"mapper");this.rarityValueMapper=L,this.noiseData=D,this.noise=z,this.mapper=le.ValueMapper[this.rarityValueMapper]}transform(S,L){if(!this.noise)return 0;const D=this.mapper(L);return D*Math.abs(this.noise.sample(S.x/D,S.y/D,S.z/D))}mapAll(S){return S.map(new le(this.input.mapAll(S),this.rarityValueMapper,this.noiseData,this.noise))}minValue(){return 0}maxValue(){return this.rarityValueMapper==="type_1"?2:3}static rarityValueMapper1(S){return S<-.5?.75:S<0?1:S<.5?1.5:2}static rarityValueMapper2(S){return S<-.75?.5:S<-.5?.75:S<.5?1:S<.75?2:3}};let A=le;p(A,"ValueMapper",{type_1:le.rarityValueMapper1,type_2:le.rarityValueMapper2}),e.WeirdScaledSampler=A;class N extends b{constructor(y,S,L,D,z,Q,We){super(D,z,Q,We),this.shiftX=y,this.shiftY=S,this.shiftZ=L}compute(y){var z,Q;const S=y.x*this.xzScale+this.shiftX.compute(y),L=y.y*this.yScale+this.shiftY.compute(y),D=y.z*this.xzScale+this.shiftZ.compute(y);return(Q=(z=this.noise)==null?void 0:z.sample(S,L,D))!=null?Q:0}mapAll(y){return y.map(new N(this.shiftX.mapAll(y),this.shiftY.mapAll(y),this.shiftZ.mapAll(y),this.xzScale,this.yScale,this.noiseData,this.noise))}}e.ShiftedNoise=N;class v extends e{constructor(y,S,L,D,z){super(),this.input=y,this.minInclusive=S,this.maxExclusive=L,this.whenInRange=D,this.whenOutOfRange=z}compute(y){const S=this.input.compute(y);return this.minInclusive<=S&&S<this.maxExclusive?this.whenInRange.compute(y):this.whenOutOfRange.compute(y)}mapAll(y){return y.map(new v(this.input.mapAll(y),this.minInclusive,this.maxExclusive,this.whenInRange.mapAll(y),this.whenOutOfRange.mapAll(y)))}minValue(){return Math.min(this.whenInRange.minValue(),this.whenOutOfRange.minValue())}maxValue(){return Math.max(this.whenInRange.maxValue(),this.whenOutOfRange.maxValue())}}e.RangeChoice=v;class R extends e{constructor(y,S){super(),this.noiseData=y,this.offsetNoise=S}compute(y){var S,L;return(L=(S=this.offsetNoise)==null?void 0:S.sample(y.x*.25,y.y*.25,y.z*.25))!=null?L:0}maxValue(){var y,S;return((S=(y=this.offsetNoise)==null?void 0:y.maxValue)!=null?S:2)*4}}e.ShiftNoise=R;class O extends R{constructor(y,S){super(y,S)}compute(y){return super.compute(e.context(y.x,0,y.z))}withNewNoise(y){return new O(this.noiseData,y)}}e.ShiftA=O;class k extends R{constructor(y,S){super(y,S)}compute(y){return super.compute(e.context(y.z,y.x,0))}withNewNoise(y){return new k(this.noiseData,y)}}e.ShiftB=k;class T extends R{constructor(y,S){super(y,S)}withNewNoise(y){return new T(this.noiseData,y)}}e.Shift=T;class C extends n{constructor(y){super(y)}transform(y,S){return S}mapAll(y){return y.map(new C(this.input.mapAll(y)))}minValue(){return-1/0}maxValue(){return 1/0}}e.BlendDensity=C;class I extends n{constructor(y,S,L){super(y),this.min=S,this.max=L}transform(y,S){return Nt(S,this.min,this.max)}mapAll(y){return y.map(new I(this.input.mapAll(y),this.min,this.max))}minValue(){return this.min}maxValue(){return this.max}}e.Clamp=I;const be=class extends n{constructor(S,L,D,z){super(L);p(this,"transformer");this.type=S,this.min=D,this.max=z,this.transformer=be.MappedTypes[this.type]}transform(S,L){return this.transformer(L)}mapAll(S){return S.map(new be(this.type,this.input.mapAll(S)))}minValue(){var S;return(S=this.min)!=null?S:-1/0}maxValue(){var S;return(S=this.max)!=null?S:1/0}withMinMax(){const S=this.input.minValue();let L=this.transformer(S),D=this.transformer(this.input.maxValue());return(this.type==="abs"||this.type==="square")&&(D=Math.max(L,D),L=Math.max(0,S)),new be(this.type,this.input,L,D)}};let M=be;p(M,"MappedTypes",{abs:S=>Math.abs(S),square:S=>S*S,cube:S=>S*S*S,half_negative:S=>S>0?S:S*.5,quarter_negative:S=>S>0?S:S*.25,squeeze:S=>{const L=Nt(S,-1,1);return L/2-L*L*L/24}}),e.Mapped=M;const x=["add","mul","min","max"];class J extends e{constructor(y,S,L,D,z){super(),this.type=y,this.argument1=S,this.argument2=L,this.min=D,this.max=z}compute(y){const S=this.argument1.compute(y);switch(this.type){case"add":return S+this.argument2.compute(y);case"mul":return S===0?0:S*this.argument2.compute(y);case"min":return S<this.argument2.minValue()?S:Math.min(S,this.argument2.compute(y));case"max":return S>this.argument2.maxValue()?S:Math.max(S,this.argument2.compute(y))}}mapAll(y){return y.map(new J(this.type,this.argument1.mapAll(y),this.argument2.mapAll(y)))}minValue(){var y;return(y=this.min)!=null?y:-1/0}maxValue(){var y;return(y=this.max)!=null?y:1/0}withMinMax(){const y=this.argument1.minValue(),S=this.argument2.minValue(),L=this.argument1.maxValue(),D=this.argument2.maxValue();(this.type==="min"||this.type==="max")&&(y>=D||S>=L)&&console.warn(`Creating a ${this.type} function between two non-overlapping inputs`);let z,Q;switch(this.type){case"add":z=y+S,Q=L+D;break;case"mul":z=y>0&&S>0?y*S||0:L<0&&D<0?L*D||0:Math.min(y*D||0,S*L||0),Q=y>0&&S>0?L*D||0:L<0&&D<0?y*S||0:Math.max(y*S||0,L*D||0);break;case"min":z=Math.min(y,S),Q=Math.min(L,D);break;case"max":z=Math.max(y,S),Q=Math.max(L,D);break}return new J(this.type,this.argument1,this.argument2,z,Q)}}e.Ap2=J;class F extends e{constructor(y){super(),this.spline=y}compute(y){return this.spline.compute(y)}mapAll(y){const S=this.spline.mapAll(L=>L instanceof e?L.mapAll(y):L);return S.calculateMinMax(),y.map(new F(S))}minValue(){return this.spline.min()}maxValue(){return this.spline.max()}}e.Spline=F;class ne extends e{constructor(y,S,L,D){super(),this.fromY=y,this.toY=S,this.fromValue=L,this.toValue=D}compute(y){return rr(y.y,this.fromY,this.toY,this.fromValue,this.toValue)}minValue(){return Math.min(this.fromValue,this.toValue)}maxValue(){return Math.max(this.fromValue,this.toValue)}}e.YClampedGradient=ne})(V||(V={}));class Fn{constructor(t,n){this.level=t,this.type=n}at(t){return t<this.level?this.type:$.AIR}}l.Aquifer=void 0,(e=>{function t(n){return{compute({x:i,y:r,z:s},a){if(!(a>0))return n(i,r,s).at(r)}}}e.createDisabled=t})(l.Aquifer||(l.Aquifer={}));const Be=class{constructor(t,n,i,r,s,a,o){p(this,"minGridX");p(this,"minGridY");p(this,"minGridZ");p(this,"gridSizeX");p(this,"gridSizeZ");p(this,"gridSize");p(this,"aquiferCache");p(this,"aquiferLocationCache");this.noiseChunk=t,this.router=i,this.random=r,this.globalFluidPicker=o,this.minGridX=this.gridX(l.ChunkPos.minBlockX(n))-1,this.gridSizeX=this.gridX(l.ChunkPos.maxBlockX(n))+1-this.minGridX+1,this.minGridY=this.gridY(s)-1,this.minGridZ=this.gridZ(l.ChunkPos.minBlockZ(n))-1,this.gridSizeZ=this.gridZ(l.ChunkPos.maxBlockZ(n))+1-this.minGridZ+1;const u=this.gridY(s+a)+1-this.minGridY+1;this.gridSize=this.gridSizeX*u*this.gridSizeZ,this.aquiferCache=Array(this.gridSize).fill(void 0),this.aquiferLocationCache=Array(this.gridSize).fill(l.BlockPos.ZERO)}compute({x:t,y:n,z:i},r){if(r<=0){if(this.globalFluidPicker(t,n,i).at(n).is($.LAVA))return $.LAVA;{const s=this.gridX(t-5),a=this.gridY(n+1),o=this.gridZ(i-5);let u=Number.MAX_SAFE_INTEGER,c=Number.MAX_SAFE_INTEGER,h=Number.MAX_SAFE_INTEGER,f=l.BlockPos.ZERO,g=l.BlockPos.ZERO,d=l.BlockPos.ZERO;for(let R=0;R<=1;R+=1)for(let O=-1;O<=1;O+=1)for(let k=0;k<=1;k+=1){const T=this.getLocation(s+R,a+O,o+k),C=l.BlockPos.magnitude(T);u>=C?(d=g,g=f,f=T,h=c,c=u,u=C):c>=C?(d=g,g=T,h=c,c=C):h>=C&&(d=T,h=C)}const E=this.getStatus(f),b=this.getStatus(g),_=this.getStatus(d),w=Be.similarity(u,c),A=Be.similarity(u,h),N=Be.similarity(c,h);let v;if(E.at(n).is($.WATER)&&this.globalFluidPicker(t,n-1,i).at(n-1).is($.LAVA))v=1;else if(w>-1){const R=fn(()=>this.router.barrier.compute(V.context(t,n*.5,i))),O=this.calculatePressure(n,E,b,R),k=this.calculatePressure(n,E,_,R),T=this.calculatePressure(n,b,_,R),C=Math.max(O,k*Math.max(0,A),T*Math.max(N));v=Math.max(0,2*Math.max(0,w)*C)}else v=0;if(r+v<=0)return E.at(n)}}}static similarity(t,n){return 1-Math.abs(n-t)/25}calculatePressure(t,n,i,r){const s=n.at(t),a=i.at(t);if(s.is($.LAVA)&&a.is($.WATER)||s.is($.WATER)&&a.is($.LAVA))return 1;const o=Math.abs(n.level-i.level);if(o===0)return 0;const u=(n.level+i.level)/2,c=t+.5-u,h=o/2-Math.abs(c),f=c>0?h>0?h/1.5:h/2.5:h>-3?(h+3)/3:(h+3)/10;return f<-2||f>2?f:f+r()}getStatus(t){const[n,i,r]=t,s=this.getIndex(this.gridX(n),this.gridY(i),this.gridZ(r)),a=this.aquiferCache[s];if(a!==void 0)return a;const o=this.computeStatus(n,i,r);return this.aquiferCache[s]=o,o}computeStatus(t,n,i){const r=this.globalFluidPicker(t,n,i);let s=Number.MAX_SAFE_INTEGER,a=!1;for(const[E,b]of Be.SURFACE_SAMPLING){const _=t+(b<<4),w=i+(b<<4),A=this.noiseChunk.getPreliminarySurfaceLevel(_,w);s=Math.min(s,A);const N=E===0&&b===0;if(N&&n-12>A+8)return r;if(N||n+12>A+8){const v=this.globalFluidPicker(_,A+8,w);if(!v.at(A+8).is($.AIR)){if(N)return v;a=!0}}}const o=a?rr(s+8-n,0,64,1,0):0,u=Nt(this.router.fluidLevelFloodedness.compute(V.context(t,n*.67,i)),-1,1);if(u>Gn(o,1,0,-.3,.8))return r;if(u<=Gn(o,1,0,-.8,.4))return new Fn(Number.MIN_SAFE_INTEGER,r.type);const c=Math.floor(n/40),h=this.router.fluidLevelSpread.compute(V.context(Math.floor(t/16),c,Math.floor(i/16))),f=c*40+20+Math.floor(h/3)*3,g=Math.min(s,f),d=this.getFluidType(t,n,i,r.type,f);return new Fn(g,d)}getFluidType(t,n,i,r,s){if(s<=-10){const a=this.router.lava.compute(V.context(Math.floor(t/64),Math.floor(n/40),Math.floor(i/64)));if(Math.abs(a)>.3)return $.LAVA}return r}getLocation(t,n,i){const r=this.getIndex(t,n,i),s=this.aquiferLocationCache[r];if(l.BlockPos.equals(s,l.BlockPos.ZERO))return s;const a=this.random.at(t,n,i),o=l.BlockPos.create(t*Be.X_SPACING+a.nextInt(10),n*Be.Y_SPACING+a.nextInt(9),i*Be.Z_SPACING+a.nextInt(10));return this.aquiferLocationCache[r]=o,o}getIndex(t,n,i){const r=t-this.minGridX,s=n-this.minGridY,a=i-this.minGridZ,o=(s*this.gridSizeZ+a)*this.gridSizeX+r;if(o<0||o>=this.gridSize)throw new Error(`Invalid aquifer index at ${t} ${n} ${i}: 0 <= ${o} < ${this.gridSize}`);return o}gridX(t){return Math.floor(t/Be.X_SPACING)}gridY(t){return Math.floor(t/Be.Y_SPACING)}gridZ(t){return Math.floor(t/Be.Z_SPACING)}};let Wt=Be;p(Wt,"X_SPACING",16),p(Wt,"Y_SPACING",12),p(Wt,"Z_SPACING",16),p(Wt,"SURFACE_SAMPLING",[[-2,-1],[-1,-1],[0,-1],[1,-1],[-3,0],[-2,0],[-1,0],[0,0],[1,0],[-2,1],[-1,1],[0,1],[1,1]]);class Ni{constructor(t,n){p(this,"n");if(this.shift=t,this.biomes=n,n.length===0)throw new Error("Cannot create checkerboard biome source without biomes");this.n=n.length}getBiome(t,n,i){const r=(((t>>this.shift)+(i>>this.shift))%this.n+this.n)%this.n;return G.parse(this.biomes[r].toString())}static fromJson(t){var s,a,o;const n=(s=l.Json.readObject(t))!=null?s:{},i=(a=l.Json.readInt(n.scale))!=null?a:2;let r;return typeof n.biomes=="string"?r=[G.parse(n.biomes)]:r=(o=l.Json.readArray(n.biomes,u=>{var c;return G.parse((c=l.Json.readString(u))!=null?c:"")}))!=null?o:[],new Ni(i+2,r)}}class sn{constructor(t){this.biome=t}getBiome(){return this.biome}static fromJson(t){var r,s;const n=(r=l.Json.readObject(t))!=null?r:{},i=G.parse((s=l.Json.readString(n.biome))!=null?s:"plains");return new sn(i)}}l.Climate=void 0,(e=>{function n(b,_,w,A,N,v){return new o(b,_,w,A,N,v)}e.target=n;function i(b,_,w,A,N,v,R){return new a(r(b),r(_),r(w),r(A),r(N),r(v),R)}e.parameters=i;function r(b,_){return typeof b=="number"?new s(b,_!=null?_:b):b}e.param=r;class s{constructor(_,w){this.min=_,this.max=w}distance(_){const w=(typeof _=="number"?_:_.min)-this.max,A=this.min-(typeof _=="number"?_:_.max);return w>0?w:Math.max(A,0)}union(_){return new s(Math.min(this.min,_.min),Math.max(this.max,_.max))}static fromJson(_){var N;if(typeof _=="number")return new s(_,_);const[w,A]=(N=l.Json.readArray(_,v=>l.Json.readNumber(v)))!=null?N:[];return new s(w!=null?w:0,A!=null?A:0)}}e.Param=s;class a{constructor(_,w,A,N,v,R,O){this.temperature=_,this.humidity=w,this.continentalness=A,this.erosion=N,this.depth=v,this.weirdness=R,this.offset=O}fittness(_){return at(this.temperature.distance(_.temperature))+at(this.humidity.distance(_.humidity))+at(this.continentalness.distance(_.continentalness))+at(this.erosion.distance(_.erosion))+at(this.depth.distance(_.depth))+at(this.weirdness.distance(_.weirdness))+at(this.offset-_.offset)}space(){return[this.temperature,this.humidity,this.continentalness,this.erosion,this.depth,this.weirdness,new s(this.offset,this.offset)]}static fromJson(_){var A,N;const w=(A=l.Json.readObject(_))!=null?A:{};return new a(s.fromJson(w.temperature),s.fromJson(w.humidity),s.fromJson(w.continentalness),s.fromJson(w.erosion),s.fromJson(w.depth),s.fromJson(w.weirdness),(N=l.Json.readNumber(w.offset))!=null?N:0)}}e.ParamPoint=a;class o{constructor(_,w,A,N,v,R){this.temperature=_,this.humidity=w,this.continentalness=A,this.erosion=N,this.depth=v,this.weirdness=R}get offset(){return 0}toArray(){return[this.temperature,this.humidity,this.continentalness,this.erosion,this.depth,this.weirdness,this.offset]}}e.TargetPoint=o;class u{constructor(_){p(this,"index");this.things=_,this.index=new h(_)}find(_){return this.index.search(_,(w,A)=>w.distance(A))}}e.Parameters=u;class c{constructor(_,w,A,N,v,R){this.temperature=_,this.humidity=w,this.continentalness=A,this.erosion=N,this.depth=v,this.weirdness=R}static fromRouter(_){return new e.Sampler(_.temperature,_.vegetation,_.continents,_.erosion,_.depth,_.ridges)}sample(_,w,A){const N=V.context(_<<2,w<<2,A<<2);return e.target(this.temperature.compute(N),this.humidity.compute(N),this.continentalness.compute(N),this.erosion.compute(N),this.depth.compute(N),this.weirdness.compute(N))}}e.Sampler=c;const E=class{constructor(_){p(this,"root");p(this,"last_leaf",null);if(_.length===0)throw new Error("At least one point is required to build search tree");this.root=E.build(_.map(([w,A])=>new d(w,A)))}static build(_){if(_.length===1)return _[0];if(_.length<=E.CHILDREN_PER_NODE){const v=_.map(R=>{let O=0;for(let k=0;k<7;k+=1){const T=R.space[k];O+=Math.abs((T.min+T.max)/2)}return{key:O,node:R}}).sort((R,O)=>R.key-O.key).map(({node:R})=>R);return new g(v)}let w=1/0,A=-1,N=[];for(let v=0;v<7;++v){_=E.sort(_,v,!1),N=E.bucketize(_);let R=0;for(const O of N)R+=E.area(O.space);w>R&&(w=R,A=v)}return _=E.sort(_,A,!1),N=E.bucketize(_),N=E.sort(N,A,!0),new g(N.map(v=>E.build(v.children)))}static sort(_,w,A){return _.map(N=>{const v=N.space[w],R=(v.min+v.max)/2;return{key:A?Math.abs(R):R,node:N}}).sort((N,v)=>N.key-v.key).map(({node:N})=>N)}static bucketize(_){const w=[];let A=[];const N=Math.pow(10,Math.floor(Math.log(_.length-.01)/Math.log(10)));for(const v of _)A.push(v),!(A.length<N)&&(w.push(new g(A)),A=[]);return A.length!==0&&w.push(new g(A)),w}static area(_){let w=0;for(const A of _)w+=Math.abs(A.max-A.min);return w}search(_,w){const A=this.root.search(_.toArray(),this.last_leaf,w);return this.last_leaf=A,A==null?void 0:A.thing()}};let h=E;p(h,"CHILDREN_PER_NODE",10),e.RTree=h;class f{constructor(_){this.space=_}distance(_){let w=0;for(let A=0;A<7;A+=1)w+=at(this.space[A].distance(_[A]));return w}}e.RNode=f;class g extends f{constructor(_){super(g.buildSpace(_)),this.children=_}static buildSpace(_){let w=[...Array(7)].map(()=>new s(1/0,-1/0));for(const A of _)w=[...Array(7)].map((N,v)=>w[v].union(A.space[v]));return w}search(_,w,A){let N=w?A(w,_):1/0,v=w;for(const R of this.children){const O=A(R,_);if(N<=O)continue;const k=R.search(_,v,A);if(k===null)continue;const T=R==k?O:A(k,_);if(T===0)return k;N<=T||(N=T,v=k)}return v}}e.RSubTree=g;class d extends f{constructor(_,w){super(_.space()),this.thing=w}search(){return this}}e.RLeaf=d})(l.Climate||(l.Climate={}));class yi{constructor(t){p(this,"parameters");this.parameters=new l.Climate.Parameters(t)}getBiome(t,n,i,r){var a;const s=r.sample(t,n,i);return(a=this.parameters.find(s))!=null?a:G.create("plains")}static fromJson(t){var s,a;const n=(s=l.Json.readObject(t))!=null?s:{},r=((a=l.Json.readArray(n.biomes,o=>{var u;return(c=>{var h;return{biome:G.parse((h=l.Json.readString(c.biome))!=null?h:"plains"),parameters:l.Climate.ParamPoint.fromJson(c.parameters)}})((u=l.Json.readObject(o))!=null?u:{})}))!=null?a:[]).map(o=>[o.parameters,()=>o.biome]);return new yi(r)}}const Rt=class{getBiome(t,n,i,r){const s=t<<2,a=n<<2,o=i<<2,u=s>>4,c=o>>4;if(u*u+c*c<=4096)return Rt.END;const h=V.context((u*2+1)*8,a,(c*2+1)*8),f=r.erosion.compute(h);return f>.25?Rt.HIGHLANDS:f>=-.0625?Rt.MIDLANDS:f>=-.21875?Rt.BARRENS:Rt.ISLANDS}static fromJson(t){return new Rt}};let yt=Rt;p(yt,"END",G.create("the_end")),p(yt,"HIGHLANDS",G.create("end_highlands")),p(yt,"MIDLANDS",G.create("end_midlands")),p(yt,"ISLANDS",G.create("small_end_islands")),p(yt,"BARRENS",G.create("end_barrens")),l.BiomeSource=void 0,(e=>{function t(i){var a,o;const r=(a=l.Json.readObject(i))!=null?a:{};switch((o=l.Json.readString(r.type))==null?void 0:o.replace(/^minecraft:/,"")){case"fixed":return sn.fromJson(i);case"checkerboard":return Ni.fromJson(i);case"multi_noise":return yi.fromJson(i);case"the_end":return yt.fromJson(i);default:return new sn(G.create("plains"))}}e.fromJson=t;function n(i,r,s,a,o,u,c,h,f=1,g=!1){if(i instanceof sn)return u(i.getBiome())?g?{pos:l.BlockPos.create(r,s,a),biome:i.getBiome()}:{pos:l.BlockPos.create(r-o+c.nextInt(o*2+1),s,a-o+c.nextInt(o*2+1)),biome:i.getBiome()}:void 0;const d=r>>2,E=a>>2,b=o>>2,_=s>>2;for(var w=void 0,A=0,N=g?0:b,v=N;v<=b;v+=f)for(var R=-v;R<=v;R+=f){const k=Math.abs(R)===v;for(var O=-v;O<=v;O+=f){if(g&&!(Math.abs(O)===v)&&!k)continue;const T=d+O,C=E+R,I=i.getBiome(T,_,C,h);if(u(I)){if((w===void 0||c.nextInt(A+1)<=.5)&&(w={pos:l.BlockPos.create(T<<2,s,C<<2),biome:I},g))return w;A++}}}return w}e.findBiomeHorizontal=n})(l.BiomeSource||(l.BiomeSource={})),l.Heightmap=void 0,(e=>{function t(n){if(typeof n=="string"&&(n==="WORLD_SURFACE_WG"||n==="WORLD_SURFACE"||n==="OCEAN_FLOOR_WG"||n==="OCEAN_FLOOR"||n==="MOTION_BLOCKING"||n==="MOTION_BLOCKING_NO_LEAVES"))return n}e.fromJson=t})(l.Heightmap||(l.Heightmap={})),l.HeightProvider=void 0,(e=>{function t(u){var f,g,d;const c=(f=l.Json.readObject(u))!=null?f:{};switch((g=l.Json.readString(c.type))==null?void 0:g.replace(/^minecraft:/,"")){case void 0:return n(l.VerticalAnchor.fromJson(u));case"constant":return n(l.VerticalAnchor.fromJson(c.value));case"uniform":return i(l.VerticalAnchor.fromJson(c.min_inclusive),l.VerticalAnchor.fromJson(c.max_inclusive));case"biased_to_bottom":return r(l.VerticalAnchor.fromJson(c.min_inclusive),l.VerticalAnchor.fromJson(c.max_inclusive),l.Json.readInt(c.inner));case"very_biased_to_bottom":return s(l.VerticalAnchor.fromJson(c.min_inclusive),l.VerticalAnchor.fromJson(c.max_inclusive),l.Json.readInt(c.inner));case"trapezoid":return a(l.VerticalAnchor.fromJson(c.min_inclusive),l.VerticalAnchor.fromJson(c.max_inclusive),l.Json.readInt(c.plateau));case"weighted_list":return o((d=l.Json.readArray(c.distribution,E=>{var _,w;const b=(_=l.Json.readObject(E))!=null?_:{};return{weight:(w=l.Json.readInt(b.weight))!=null?w:1,data:t(b.data)}}))!=null?d:[])}return()=>0}e.fromJson=t;function n(u){return(c,h)=>u(h)}e.constant=n;function i(u,c){return(h,f)=>{const g=u(f),d=c(f);return g>d?g:h.nextInt(d-g+1)+g}}e.uniform=i;function r(u,c,h=1){return(f,g)=>{const d=u(g),E=c(g);if(E-d-h+1<=0)return d;{const b=f.nextInt(E-d-h+1);return f.nextInt(b+h)+d}}}e.biased_to_bottom=r;function s(u,c,h=1){return(f,g)=>{const d=u(g),E=c(g);if(E-d-h+1<=0)return d;{const b=_i(f,d+h,E),_=_i(f,d,b-1);return _i(f,d,_-1+h)}}}e.very_biased_to_bottom=s;function a(u,c,h=0){return(f,g)=>{const d=u(g),E=c(g);if(d>E)return d;{const b=E-d;if(h>=b)return gi(f,d,E);{const _=(b-h)/2,w=b-_;return d+gi(f,0,w)+gi(f,0,_)}}}}e.trapezoid=a;function o(u){const c=u.reduce((h,f,g)=>h+f.weight,0);return(h,f)=>{let g=h.nextInt(c);for(const d of u)if(g-=d.weight,g<=0)return d.data(h,f);return 0}}e.weighted_list=o})(l.HeightProvider||(l.HeightProvider={}));class gr{constructor(t,n,i,r,s,a,o,u,c){p(this,"cellWidth");p(this,"cellHeight");p(this,"firstCellX");p(this,"firstCellZ");p(this,"firstNoiseX");p(this,"firstNoiseZ");p(this,"noiseSizeXZ");p(this,"preliminarySurfaceLevel",new Map);p(this,"aquifer");p(this,"materialRule");p(this,"initialDensity");this.cellCountXZ=t,this.cellCountY=n,this.cellNoiseMinY=i,this.minX=s,this.minZ=a,this.settings=o,this.cellWidth=l.NoiseSettings.cellWidth(o),this.cellHeight=l.NoiseSettings.cellHeight(o),this.firstCellX=Math.floor(s/this.cellWidth),this.firstCellZ=Math.floor(a/this.cellWidth),this.firstNoiseX=s>>2,this.firstNoiseZ=a>>2,this.noiseSizeXZ=t*this.cellWidth>>2,this.aquifer=l.Aquifer.createDisabled(c);const h=r.router.finalDensity;this.materialRule=l.MaterialRule.fromList([f=>this.aquifer.compute(f,h.compute(f))]),this.initialDensity=r.router.initialDensityWithoutJaggedness}getFinalState(t,n,i){return this.materialRule({x:t,y:n,z:i})}getPreliminarySurfaceLevel(t,n){return Ot(this.preliminarySurfaceLevel,l.ChunkPos.asLong(t,n),()=>{const i=t<<2,r=n<<2;for(let s=this.settings.minY+this.settings.height;s>=this.settings.minY;s-=this.cellHeight)if(this.initialDensity.compute(V.context(i,s,r))>.390625)return s;return Number.MAX_SAFE_INTEGER})}}l.MaterialRule=void 0,(e=>{function t(n){return i=>{for(const r of n){const s=r(i);if(s)return s}}}e.fromList=t})(l.MaterialRule||(l.MaterialRule={}));class fa{constructor(t,n){p(this,"noiseChunkCache");p(this,"globalFluidPicker");this.biomeSource=t,this.settings=n,this.noiseChunkCache=new Map;const i=new Fn(-54,$.LAVA),r=new Fn(n.seaLevel,n.defaultFluid);this.globalFluidPicker=(s,a,o)=>a<Math.min(-54,n.seaLevel)?i:r}getBaseHeight(t,n,i,r){var a;let s;return i==="OCEAN_FLOOR"||i==="OCEAN_FLOOR_WG"?s=o=>!o.equals($.AIR):s=o=>o.equals($.STONE),(a=this.iterateNoiseColumn(r,t,n,void 0,s,$.STONE))!=null?a:this.settings.noise.minY}iterateNoiseColumn(t,n,i,r,s,a){var b,_;const o=this.settings.noise.minY,u=l.NoiseSettings.cellHeight(this.settings.noise),c=Math.floor(o/u),h=Math.floor(this.settings.noise.height/u);if(h<=0)return;const f=l.NoiseSettings.cellWidth(this.settings.noise),g=Math.floor(n/f),d=Math.floor(i/f),E=new gr(1,h,c,t,g,d,this.settings.noise,this.settings.aquifersEnabled,this.globalFluidPicker);for(let w=h-1;w>=0;w-=1)for(let A=u-1;A>=0;A-=1){const N=(c+w)*u+A,v=(_=(b=E.getFinalState(n,N,i))!=null?b:a)!=null?_:this.settings.defaultBlock;if(r!==void 0&&(r[N+o]=v),s!==void 0&&s(v))return N+1}}fill(t,n,i=!1){var E;const r=Math.max(n.minY,this.settings.noise.minY),s=Math.min(n.maxY,this.settings.noise.minY+this.settings.noise.height),a=l.NoiseSettings.cellWidth(this.settings.noise),o=l.NoiseSettings.cellHeight(this.settings.noise),u=Math.floor(16/a),c=Math.floor(r/o),h=Math.floor((s-r)/o),f=l.ChunkPos.minBlockX(n.pos),g=l.ChunkPos.minBlockZ(n.pos),d=this.getOrCreateNoiseChunk(t,n);for(let b=0;b<u;b+=1)for(let _=0;_<(i?1:u);_+=1){let w=n.getOrCreateSection(n.sectionsCount-1);for(let A=h-1;A>=0;A-=1)for(let N=o-1;N>=0;N-=1){const v=(c+A)*o+N,R=v&15,O=n.getSectionIndex(v);n.getSectionIndex(w.minBlockY)!==O&&(w=n.getOrCreateSection(O));for(let k=0;k<a;k+=1){const T=f+b*a+k,C=T&15;for(let I=0;I<(i?1:a);I+=1){const M=g+_*a+I,x=M&15,J=(E=d.getFinalState(T,v,M))!=null?E:this.settings.defaultBlock;w.setBlockState(C,R,x,J)}}}}}buildSurface(t,n,i="minecraft:plains"){const r=this.getOrCreateNoiseChunk(t,n),s=this.settings.noise;t.surfaceSystem.buildSurface(n,r,s,()=>i)}computeBiome(t,n,i,r){return this.biomeSource.getBiome(n,i,r,t.sampler)}getOrCreateNoiseChunk(t,n){return Ot(this.noiseChunkCache,l.ChunkPos.toLong(n.pos),()=>{const i=Math.max(n.minY,this.settings.noise.minY),r=Math.min(n.maxY,this.settings.noise.minY+this.settings.noise.height),s=l.NoiseSettings.cellWidth(this.settings.noise),a=l.NoiseSettings.cellHeight(this.settings.noise),o=Math.floor(16/s),u=Math.floor(i/a),c=Math.floor((r-i)/a),h=l.ChunkPos.minBlockX(n.pos),f=l.ChunkPos.minBlockZ(n.pos);return new gr(o,c,u,t,h,f,this.settings.noise,this.settings.aquifersEnabled,this.globalFluidPicker)})}}class da{constructor(t,n){p(this,"noiseCache");p(this,"randomCache");p(this,"random");p(this,"aquiferRandom");p(this,"oreRandom");p(this,"surfaceSystem");p(this,"router");p(this,"sampler");this.seed=n,this.noiseCache=new Map,this.randomCache=new Map,this.random=(t.legacyRandomSource?new ce(n):te.create(n)).forkPositional(),this.aquiferRandom=this.random.fromHashOf(G.create("aquifer").toString()).forkPositional(),this.oreRandom=this.random.fromHashOf(G.create("ore").toString()).forkPositional(),this.surfaceSystem=new ha(t.surfaceRule,t.defaultBlock,n),this.router=l.NoiseRouter.mapAll(t.noiseRouter,this.createVisitor(t.noise,t.legacyRandomSource)),this.sampler=l.Climate.Sampler.fromRouter(this.router)}createVisitor(t,n){const i=new Map,r=a=>{const o=a.key();if(o===void 0)throw new Error("Cannot create noise without key");if(n){if(o.equals(G.create("temperature")))return new lt(new ce(this.seed+BigInt(0)),l.NoiseParameters.create(-7,[1,1]));if(o.equals(G.create("vegetation")))return new lt(new ce(this.seed+BigInt(1)),l.NoiseParameters.create(-7,[1,1]));if(o.equals(G.create("offset")))return new lt(this.random.fromHashOf("offset"),l.NoiseParameters.create(0,[0]))}return this.getOrCreateNoise(o)},s={map:a=>{if(a instanceof V.HolderHolder){const o=a.holder.key();if(o!==void 0&&i.has(o.toString()))return i.get(o.toString());{const u=a.holder.value().mapAll(s);return o!==void 0&&i.set(o.toString(),u),u}}return a instanceof V.Interpolated?a.withCellSize(l.NoiseSettings.cellWidth(t),l.NoiseSettings.cellHeight(t)):a instanceof V.ShiftedNoise?new V.ShiftedNoise(a.shiftX,a.shiftY,a.shiftZ,a.xzScale,a.yScale,a.noiseData,r(a.noiseData)):a instanceof V.Noise?new V.Noise(a.xzScale,a.yScale,a.noiseData,r(a.noiseData)):a instanceof V.ShiftNoise?a.withNewNoise(r(a.noiseData)):a instanceof V.WeirdScaledSampler?new V.WeirdScaledSampler(a.input,a.rarityValueMapper,a.noiseData,r(a.noiseData)):a instanceof V.OldBlendedNoise?new V.OldBlendedNoise(a.xzScale,a.yScale,a.xzFactor,a.yFactor,a.smearScaleMultiplier,new ta(this.random.fromHashOf(G.create("terrain").toString()),a.xzScale,a.yScale,a.xzFactor,a.yFactor,a.smearScaleMultiplier)):a instanceof V.EndIslands?new V.EndIslands(this.seed):a instanceof V.Mapped||a instanceof V.Ap2?a.withMinMax():a}};return s}getOrCreateNoise(t){const n=oe.REGISTRY.getOrThrow(G.create("worldgen/noise"));return Ot(this.noiseCache,t.toString(),i=>new lt(this.random.fromHashOf(i),n.getOrThrow(t)))}getOrCreateRandom(t){return Ot(this.randomCache,t.toString(),n=>this.random.fromHashOf(n).forkPositional())}}class Fe{static fromJson(t){var i,r,s,a;const n=(i=l.Json.readObject(t))!=null?i:{};switch((r=l.Json.readString(n.element_type))==null?void 0:r.replace(/^minecraft:/,"")){case"single_pool_element":case"legacy_single_pool_element":const o=G.parse((s=l.Json.readString(n.location))!=null?s:""),u={key:()=>o,value:()=>{var h;return(h=st.REGISTRY.get(o))!=null?h:st.EMPTY}};return new Fe.SinlgePoolElement(u);case"list_pool_element":const c=(a=l.Json.readArray("elements",Fe.fromJson))!=null?a:[];return new Fe.ListPoolElement(c);case"feature_pool_element":return new Fe.FeaturePoolElement;case"empty_pool_element":default:return new Fe.EmptyPoolElement}}}(e=>{class t extends e{getBoundingBox(o,u){throw new Error("Invalid call of EmptyPoolElement")}getShuffledJigsawBlocks(o,u){return[]}toString(){return"[Empty Pool Element]"}}e.EmptyPoolElement=t;class n extends e{constructor(){super();p(this,"defaultJigsawNBT");const u=new Map;u.set("name",new ke("minecraft:bottom")),u.set("final_state",new ke("minecraft:air")),u.set("pool",new ke("minecraft:empty")),u.set("target",new ke("minecraft:empty")),u.set("joint",new ke("rollable")),this.defaultJigsawNBT=new ue(u)}getBoundingBox(u,c){return[u,u]}getShuffledJigsawBlocks(u,c){return[{pos:[0,0,0],state:new $(G.create("jigsaw"),{orientation:"down_south"}),nbt:this.defaultJigsawNBT}]}toString(){return"[Feature Pool Element]"}}e.FeaturePoolElement=n;const s=class extends e{constructor(o){super(),this.template=o}getBoundingBox(o,u){const c=l.BlockPos.offset(this.template.value().getSize(),-1,-1,-1),h=o,f=l.BlockPos.add(st.transform(c,u,l.BlockPos.ZERO),o),g=l.BlockPos.create(Math.min(h[0],f[0]),h[1],Math.min(h[2],f[2])),d=l.BlockPos.create(Math.max(h[0],f[0]),f[1],Math.max(h[2],f[2]));return[g,d]}getShuffledJigsawBlocks(o,u){const c=this.template.value().getBlocks().filter(h=>h.state.getName().equals(s.JIGSAW_ID));return c.forEach(h=>h.pos=st.transform(h.pos,o,l.BlockPos.ZERO)),Ys(c,u),c}toString(){return`[Single Pool Element: ${this.template.key()}]`}};let i=s;p(i,"JIGSAW_ID",G.parse("jigsaw")),e.SinlgePoolElement=i;class r extends e{constructor(o){super(),this.elements=o}getBoundingBox(o,u){var c=void 0,h=void 0;for(const f of this.elements){const g=f.getBoundingBox(o,u);!c||!h?(c=g[0],h=g[1]):(c[0]=Math.min(c[0],g[0][0]),c[1]=Math.min(c[1],g[0][1]),c[2]=Math.min(c[2],g[0][2]),h[0]=Math.min(c[0],g[1][0]),h[1]=Math.min(c[1],g[1][1]),h[2]=Math.min(c[2],g[1][2]))}return[c,h]}getShuffledJigsawBlocks(o,u){return this.elements[0].getShuffledJigsawBlocks(o,u)}toString(){return`[List Pool Element: ${"; ".concat(...this.elements.map(o=>o.toString()))}]`}}e.ListPoolElement=r})(Fe||(Fe={}));const Kt=class{constructor(t,n){p(this,"totalWeight");this.rawTemplates=t,this.fallback=n,this.totalWeight=t.reduce((i,r)=>i+r.weight,0)}static fromJson(t){var s,a,o;const n=(s=l.Json.readObject(t))!=null?s:{},i=Kt.structurePoolParser((a=n.fallback)!=null?a:""),r=(o=l.Json.readArray(n.elements,u=>{var g,d;const c=(g=l.Json.readObject(u))!=null?g:{},h=Fe.fromJson(c.element),f=(d=l.Json.readInt(c.weight))!=null?d:1;return{element:h,weight:f}}))!=null?o:[];return new Kt(r,i)}getRandomTemplate(t){var n=t.nextInt(this.totalWeight);for(const i of this.rawTemplates)if(n-=i.weight,n<0)return i.element;return this.rawTemplates[this.rawTemplates.length-1].element}};let Vt=Kt;p(Vt,"REGISTRY",oe.createAndRegister("worldgen/template_pool",Kt.fromJson)),p(Vt,"structurePoolParser",l.Holder.parser(Kt.REGISTRY,Kt.fromJson));class ki{constructor(t){this.settings=t}onTopOfChunkCenter(t,n,i,r="WORLD_SURFACE_WG"){const s=(n<<4)+8,a=(i<<4)+8;return[s,t.chunkGenerator.getBaseHeight(s,a,r,t.randomState)-1,a]}getLowestY(t,n,i,r,s){return Math.min(t.chunkGenerator.getBaseHeight(n,i,"WORLD_SURFACE_WG",t.randomState)-1,t.chunkGenerator.getBaseHeight(n,i+s,"WORLD_SURFACE_WG",t.randomState)-1,t.chunkGenerator.getBaseHeight(n+r,i,"WORLD_SURFACE_WG",t.randomState)-1,t.chunkGenerator.getBaseHeight(n+r,i+s,"WORLD_SURFACE_WG",t.randomState)-1)}getLowestYIn5by5BoxOffset7Blocks(t,n,i,r){let s=5,a=5;r===l.Rotation.CLOCKWISE_90?s=-5:r===l.Rotation.CLOCKWISE_180?(s=-5,a=-5):r===l.Rotation.COUNTERCLOCKWISE_90&&(a=-5);const o=(n<<4)+7,u=(i<<4)+7;return l.BlockPos.create(o,this.getLowestY(t,o,u,s,a),u)}tryGenerate(t,n,i){const r=ce.fromLargeFeatureSeed(i.seed,t,n),s=this.findGenerationPoint(t,n,r,i);if(s===void 0)return!1;const a=i.biomeSource.getBiome(s[0]>>2,s[1],s[2]>>2,i.randomState.sampler);return[...this.settings.validBiomes.getEntries()].findIndex(o=>{var u;return(u=o.key())==null?void 0:u.equals(a)})>=0}}(e=>{e.REGISTRY=oe.createAndRegister("worldgen/structure",r);class t{constructor(k){this.validBiomes=k}}e.StructureSettings=t;class n{constructor(k,T,C){p(this,"chunkGenerator");p(this,"randomState");this.seed=k,this.biomeSource=T,this.settings=C,this.randomState=new da(C,k),this.chunkGenerator=new fa(T,C)}}e.GenerationContext=n;const i=l.Holder.parser(Vt.REGISTRY,Vt.fromJson);function r(O){var M,x,J;const k=At.parser(l.WorldgenRegistries.BIOME),T=(M=l.Json.readObject(O))!=null?M:{},C=k(T.biomes),I=new t(C.value());switch((x=l.Json.readString(T.type))==null?void 0:x.replace(/^minecraft:/,"")){case"buried_treasure":return new a(I);case"desert_pyramid":return new u(I);case"end_city":return new c(I);case"fortress":return new h(I);case"igloo":return new f(I);case"jigsaw":const F=l.HeightProvider.fromJson(T.start_height),ne=i(T.start_pool),se=l.Json.readString(T.start_jigsaw_name),le=se?G.parse(se):void 0,be=l.Heightmap.fromJson(T.project_start_to_heightmap);return new s(I,ne,F,be,le);case"jungle_temple":return new g(I);case"mineshaft":const ie=l.Json.readString(T.mineshaft_type)==="mesa"?"mesa":"normal";return new d(I,ie);case"nether_fossil":return new h(I);case"ocean_monument":return new b(I);case"ocean_ruin":return new _(I);case"ruined_portal":return new w(I);case"shipwreck":const y=(J=l.Json.readBoolean(T.is_beached))!=null?J:!1;return new A(I,y);case"stronghold":return new N(I);case"swamp_hut":return new v(I);case"woodland_mansion":return new R(I)}return new a(I)}e.fromJson=r;class s extends e{constructor(k,T,C,I,M){super(k),this.startingPoolHolder=T,this.startHeight=C,this.projectStartToHeightmap=I,this.startJigsawName=M}findGenerationPoint(k,T,C,I){var M=this.startHeight(C,I.settings.noise);const x=l.BlockPos.create(k<<4,M,T<<4),J=l.Rotation.getRandom(C),ne=this.startingPoolHolder.value().getRandomTemplate(C);if(!(ne instanceof Fe.EmptyPoolElement)){var se;if(this.startJigsawName){const D=s.getRandomNamedJigsaw(ne,this.startJigsawName,J,C);if(D===void 0)return;se=D}else se=l.BlockPos.ZERO;const le=l.BlockPos.subtract(x,se),be=ne.getBoundingBox(le,J),ie=(be[1][0]+be[0][0])/2^0,y=(be[1][2]+be[0][2])/2^0;var M;return this.projectStartToHeightmap?M=x[1]+I.chunkGenerator.getBaseHeight(ie,y,this.projectStartToHeightmap,I.randomState):M=le[1],l.BlockPos.create(ie,M+se[1],y)}}static getRandomNamedJigsaw(k,T,C,I){var x,J;const M=k.getShuffledJigsawBlocks(C,I);for(const F of M)if(G.parse((J=(x=F.nbt)==null?void 0:x.getString("name"))!=null?J:"minecraft:empty").equals(T))return F.pos}}e.JigsawStructure=s;class a extends e{findGenerationPoint(k,T,C,I){return this.onTopOfChunkCenter(I,k,T,"OCEAN_FLOOR_WG")}}e.BuriedTreasureStructure=a;class o extends e{constructor(k,T,C){super(k),this.width=T,this.depth=C}findGenerationPoint(k,T,C,I){if(!(this.getLowestY(I,k<<4,T<<4,this.width,this.depth)<I.settings.seaLevel))return this.onTopOfChunkCenter(I,k,T)}}class u extends o{constructor(k){super(k,21,21)}}e.DesertPyramidStructure=u;class c extends e{findGenerationPoint(k,T,C,I){const M=l.Rotation.getRandom(C),x=this.getLowestYIn5by5BoxOffset7Blocks(I,k,T,M);if(!(x[1]<60))return x}}e.EndCityStructure=c;class h extends e{findGenerationPoint(k,T){return l.BlockPos.create(k<<4,64,T<<4)}}e.NetherFortressStructure=h;class f extends e{findGenerationPoint(k,T,C,I){return this.onTopOfChunkCenter(I,k,T)}}e.IglooStructure=f;class g extends o{constructor(k){super(k,12,15)}}e.JungleTempleStructure=g;class d extends e{constructor(k,T){super(k),this.type=T}findGenerationPoint(k,T,C,I){throw new Error("Method not implemented.")}}e.MineshaftStructure=d;class E extends e{constructor(k,T){super(k),this.height=T}findGenerationPoint(k,T){throw new Error("Method not implemented.")}}e.NetherFossilStructure=E;class b extends e{findGenerationPoint(k,T){throw new Error("Method not implemented.")}}e.OceanMonumentStructure=b;class _ extends e{findGenerationPoint(k,T,C,I){return this.onTopOfChunkCenter(I,k,T,"OCEAN_FLOOR_WG")}}e.OceanRuinStructure=_;class w extends e{findGenerationPoint(k,T){throw new Error("Method not implemented.")}}e.RuinedPortalStructure=w;class A extends e{constructor(k,T){super(k),this.isBeached=T}findGenerationPoint(k,T,C,I){return this.onTopOfChunkCenter(I,k,T,this.isBeached?"WORLD_SURFACE_WG":"OCEAN_FLOOR_WG")}}e.ShipwreckStructure=A;class N extends e{findGenerationPoint(k,T){return l.BlockPos.create(k<<4,0,T<<4)}}e.StrongholdStructure=N;class v extends e{findGenerationPoint(k,T,C,I){return this.onTopOfChunkCenter(I,k,T)}}e.SwampHutStructure=v;class R extends e{findGenerationPoint(k,T,C,I){const M=l.Rotation.getRandom(C),x=this.getLowestYIn5by5BoxOffset7Blocks(I,k,T,M);if(!(x[1]<60))return x}}e.WoodlandMansionStructure=R})(ki||(ki={}));const Un=class{constructor(t,n){this.structures=t,this.placement=n}static fromJson(t){var s,a;const n=(s=l.Json.readObject(t))!=null?s:{},i=(a=l.Json.readArray(n.structures,Un.StructureSelectionEntry.fromJson))!=null?a:[],r=Le.fromJson(n.placement);return new Un(i,r)}getStructureInChunk(t,n,i){if(this.placement.prepare(i.biomeSource,i.randomState.sampler,i.seed),!!this.placement.isStructureChunk(i.seed,t,n)&&this.structures.length!==0)if(this.structures.length===1){if(this.structures[0].structure.value().tryGenerate(t,n,i))return this.structures[0].structure.key()}else{const r=ce.fromLargeFeatureSeed(i.seed,t,n),s=Object.assign([],this.structures);let a=s.reduce((o,u,c)=>o+u.weight,0);for(;s.length>0;){let o=r.nextInt(a),u,c;for([u,c]of s.entries())if(o-=c.weight,o<0)break;if(c.structure.value().tryGenerate(t,n,i))return c.structure.key();s.splice(u,1),a-=c.weight}}}};let Zt=Un;p(Zt,"REGISTRY",oe.createAndRegister("worldgen/structure_set",Un.fromJson)),(e=>{class t{constructor(i,r){this.structure=i,this.weight=r}static fromJson(i){var s,a,o;const r=(s=l.Json.readObject(i))!=null?s:{};return new t(l.Holder.reference(ki.REGISTRY,G.parse((a=l.Json.readString(r.structure))!=null?a:"minecraft:empty")),(o=l.Json.readInt(r.weight))!=null?o:1)}}e.StructureSelectionEntry=t})(Zt||(Zt={}));class Le{constructor(t,n,i,r,s){this.locateOffset=t,this.frequencyReductionMethod=n,this.frequency=i,this.salt=r,this.exclusionZone=s}static fromJson(t){var c,h,f,g,d,E,b,_,w,A;const n=(c=l.Json.readObject(t))!=null?c:{},i=(h=l.Json.readString(n.type))==null?void 0:h.replace(/^minecraft:/,""),r=l.BlockPos.fromJson(n.locate_offset),s=Le.FrequencyReducer.fromType((f=l.Json.readString(n.frequency_reduction_method))!=null?f:"default"),a=(g=l.Json.readNumber(n.frequency))!=null?g:1,o=(d=l.Json.readInt(n.salt))!=null?d:0,u="exclusion_zone"in n?Le.ExclusionZone.fromJson(n.exclusion_zone):void 0;switch(i){case"random_spread":const N=(E=l.Json.readInt(n.spacing))!=null?E:1,v=(b=l.Json.readInt(n.separation))!=null?b:1,R=Le.SpreadType.fromJson(n.spread_type);return new Le.RandomSpreadStructurePlacement(r,s,a,o,u,N,v,R);case"concentric_rings":const O=(_=l.Json.readInt(n.distance))!=null?_:1,k=(w=l.Json.readInt(n.spread))!=null?w:1,T=(A=l.Json.readInt(n.count))!=null?A:1,C=At.parser(l.WorldgenRegistries.BIOME)(n.preferred_biomes);return new Le.ConcentricRingsStructurePlacement(r,s,a,o,u,O,k,T,C)}return new Le.RandomSpreadStructurePlacement([0,0,0],Le.FrequencyReducer.ProbabilityReducer,1,0,void 0,1,1,"linear")}isStructureChunk(t,n,i){return this.isPlacementChunk(t,n,i)?this.frequency<1&&!this.frequencyReductionMethod(t,this.salt,n,i,this.frequency)?!1:!(this.exclusionZone&&this.exclusionZone.isPlacementForbidden(t,n,i)):!1}prepare(t,n,i){}}(e=>{(s=>{function a(f){switch(f){case"legacy_type_1":return h;case"legacy_type_2":return c;case"legacy_type_3":return u;case"default":default:return o}}s.fromType=a;function o(f,g,d,E,b){return ce.fromLargeFeatureWithSalt(f,g,d,E).nextFloat()<b}s.ProbabilityReducer=o;function u(f,g,d,E,b){return ce.fromLargeFeatureSeed(f,d,E).nextDouble()<b}s.LegacyProbabilityReducerWithDouble=u;function c(f,g,d,E,b){return ce.fromLargeFeatureWithSalt(f,d,E,10387320).nextFloat()<b}s.LegacyArbitrarySaltProbabilityReducer=c;function h(f,g,d,E,b){const _=d>>4,w=E>>4,A=new ce(BigInt(_^w<<4)^f);return A.nextInt(),A.nextInt(Math.floor(1/b))===0}s.LegacyPillagerOutpostReducer=h})(e.FrequencyReducer||(e.FrequencyReducer={}));class t{constructor(a,o){this.otherSet=a,this.chunkCount=o}static fromJson(a){var u,c,h;const o=(u=l.Json.readObject(a))!=null?u:{};return new t(l.Holder.reference(Zt.REGISTRY,G.parse((c=l.Json.readString(o.other_set))!=null?c:"")),(h=l.Json.readInt(o.chunk_count))!=null?h:1)}isPlacementForbidden(a,o,u){const c=this.otherSet.value().placement;return c.getPotentialStructureChunks(a,o-this.chunkCount,u-this.chunkCount,o+this.chunkCount,u+this.chunkCount).findIndex(h=>Math.abs(h[0]-o)<=this.chunkCount&&Math.abs(h[1]-u)<=this.chunkCount&&c.isStructureChunk(a,h[0],h[1]))>=0}}e.ExclusionZone=t,(s=>{function a(o){var c;return((c=l.Json.readString(o))!=null?c:"linear")==="triangular"?"triangular":"linear"}s.fromJson=a})(e.SpreadType||(e.SpreadType={}));class n extends e{constructor(a,o,u,c,h,f,g,d){super(a,o,u,c,h),this.spacing=f,this.separation=g,this.spreadType=d}evaluateSpread(a,o){switch(this.spreadType){case"linear":return a.nextInt(o);case"triangular":return Math.floor((a.nextInt(o)+a.nextInt(o))/2)}}getPotentialStructureChunk(a,o,u){const c=Math.floor(o/this.spacing),h=Math.floor(u/this.spacing),f=ce.fromLargeFeatureWithSalt(a,c,h,this.salt),g=this.spacing-this.separation,d=this.evaluateSpread(f,g),E=this.evaluateSpread(f,g);return[c*this.spacing+d,h*this.spacing+E]}isPlacementChunk(a,o,u){const[c,h]=this.getPotentialStructureChunk(a,o,u);return c===o&&h===u}getPotentialStructureChunks(a,o,u,c,h){const f=[];for(let g=Math.floor(o/this.spacing)*this.spacing;g<=c;g+=this.spacing)for(let d=Math.floor(u/this.spacing)*this.spacing;d<=h;d+=this.spacing)f.push(this.getPotentialStructureChunk(a,g,d));return f}}e.RandomSpreadStructurePlacement=n;const i=112;class r extends e{constructor(o,u,c,h,f,g,d,E,b){super(o,u,c,h,f);p(this,"positions");this.distance=g,this.spread=d,this.count=E,this.preferredBiomes=b}prepare(o,u,c){if(this.positions!==void 0||(this.positions=[],this.count===0))return;const h=new ce(c);var f=h.nextDouble()*Math.PI*2,g=this.spread,d=0,E=0;const b=[...this.preferredBiomes.value().getEntries()].flatMap(w=>{var A;return(A=w.key())!=null?A:[]});for(var _=0;_<this.count;_++){const w=4*this.distance+this.distance*d*6+(h.nextDouble()-.5)*this.distance*2.5,A=Math.round(Math.cos(f)*w),N=Math.round(Math.sin(f)*w),v=(A<<4)+8,R=(N<<4)+8,O=h.fork(),k=()=>{const T=l.BiomeSource.findBiomeHorizontal(o,v,0,R,i,C=>b.findIndex(I=>I.equals(C))>=0,O,u);return T?[T.pos[0]>>4,T.pos[2]>>4]:[A,N]};this.positions.push({center:[A,N],real:k}),f+=Math.PI*2/g,E++,E==g&&(d++,E=0,g+=2*g/(d+1),g=Math.min(g,this.count-_),f+=h.nextDouble()*Math.PI*2)}}isPlacementChunk(o,u,c){return this.positions===void 0?(console.warn("trying to access concentric rings placement before position calculation"),!1):this.getPotentialStructureChunks(o,u,c,u,c).findIndex(h=>h[0]===u&&h[1]===c)>=0}getPotentialStructureChunks(o,u,c,h,f){if(this.positions===void 0)return console.warn("trying to access concentric rings placement before position calculation"),[];const g=[];for(const d of this.positions)d.center[0]<u-(i>>4)||d.center[0]>h+(i>>4)||d.center[1]<c-(i>>4)||d.center[1]>f+(i>>4)||(d.real instanceof Function&&(d.real=d.real()),g.push(d.real));return g}}e.ConcentricRingsStructurePlacement=r})(Le||(Le={})),l.AttributeModifierOperation=xe,l.BlendedNoise=ta,l.BlockColors=xn,l.BlockDefinition=vi,l.BlockModel=Ut,l.BlockState=$,l.CheckerboardBiomeSource=Ni,l.Chunk=El,l.ChunkBuilder=oa,l.ChunkSection=tn,l.DensityFunction=V,l.FixedBiomeSource=sn,l.FluidStatus=Fn,l.HolderSet=At,l.Identifier=G,l.ImprovedNoise=fr,l.ItemRenderer=Sh,l.ItemStack=ve,l.LegacyPositionalRandom=Qs,l.LegacyRandom=ce,l.Line=bi,l.Matrix3=Dn,l.Matrix4=pi,l.Mesh=Ne,l.MultiNoiseBiomeSource=yi,l.NbtAbstractList=Cn,l.NbtByte=Ke,l.NbtByteArray=wt,l.NbtChunk=rt,l.NbtCompound=ue,l.NbtDouble=vt,l.NbtEnd=Mn,l.NbtFile=qe,l.NbtFloat=zt,l.NbtInt=it,l.NbtIntArray=pt,l.NbtList=De,l.NbtLong=Ht,l.NbtLongArray=St,l.NbtRegion=bt,l.NbtShort=Ft,l.NbtString=ke,l.NbtTag=j,l.NbtType=B,l.NoiseAquifer=Wt,l.NoiseChunk=gr,l.NoiseChunkGenerator=fa,l.NormalNoise=lt,l.PalettedContainer=Fs,l.PerlinNoise=Se,l.PerlinSimplexNoise=oh,l.Quad=Xe,l.RandomState=da,l.RawDataInput=wr,l.RawDataOutput=pr,l.Registry=oe,l.Renderer=Ai,l.ShaderProgram=zn,l.SimplexNoise=pe,l.SpecialRenderer=dr,l.SpecialRenderers=aa,l.StringReader=Ie,l.Structure=st,l.StructurePlacement=Le,l.StructurePoolElement=Fe,l.StructureRenderer=yh,l.StructureSet=Zt,l.StructureTemplatePool=Vt,l.SurfaceContext=ua,l.SurfaceSystem=ha,l.TextureAtlas=Hn,l.Vector=W,l.Vertex=Me,l.VoxelRenderer=Th,l.WorldgenStructure=ki,l.XoroshiroPositionalRandom=ea,l.XoroshiroRandom=te,l.binarySearch=Vs,l.clamp=Nt,l.clampedLerp=ui,l.clampedMap=rr,l.computeIfAbsent=Ot,l.getItemColor=la,l.getSeed=sr,l.intToRgb=Ee,l.inverseLerp=ir,l.isPowerOfTwo=ar,l.lazy=fn,l.lazyLerp=Pn,l.lazyLerp2=nr,l.lazyLerp3=Ws,l.lerp=ot,l.lerp2=hi,l.lerp3=Us,l.longfromBytes=di,l.map=Gn,l.mutateWithDefault=Ii,l.nextInt=_i,l.randomBetweenInclusive=gi,l.shuffle=Ys,l.smoothstep=fi,l.square=at,l.upperPowerOfTwo=Zs,Object.defineProperties(l,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
